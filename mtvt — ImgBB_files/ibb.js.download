$(function(){var e={url:PF.obj.config.json_api,cache:!1,dataType:"json",data:{auth_token:PF.obj.config.auth_token}};void 0!==PF.obj.config.session_id&&(e.data.session_id=PF.obj.config.session_id),$.ajaxSetup(e),$(window).bind("beforeunload",function(){if("continue"!=$("form",PF.obj.modal.selectors.root).data("beforeunload"))return $(PF.obj.modal.selectors.root).is(":visible")&&PF.fn.form_modal_has_changed()?PF.fn._s("All the changes that you have made will be lost if you continue."):void 0}),$(window).bind("hashchange",function(){"#edit"!=window.location.hash||$(PF.obj.modal.selectors.root).exists()||$("[data-modal=edit]").first().click()}),PF.fn.bindtipTip();var n,t,a=$(window).width();$(window).on("resize",function(){PF.fn.growl.fixPosition(),PF.fn.modal.fixScrollbars();var e=PF.fn.getDeviceName(),t=["phone","phablet"],o=["tablet","laptop","desktop"];clearTimeout(void 0),clearTimeout(n),n=setTimeout(function(){$(".follow-scroll-wrapper, .follow-scroll-placeholder").removeClass("position-fixed").attr("style",""),$("html").hasScrollBar().vertical&&(PF.obj.follow_scroll.set(!0),PF.obj.follow_scroll.process(!0))},25);var i=PF.fn.getDeviceName();(i!==e&&0<=$.inArray(e,t)&&-1==$.inArray(i,t)||0<=$.inArray(e,o)&&-1==$.inArray(i,o))&&PF.fn.close_pops(),$(".top-bar").css("top",""),$(PF.fn.topMenu.vars.menu).css("height",$(window).height()),$("body").css({position:"",height:""}),$(".antiscroll").removeClass("jsly").data("antiscroll",""),$(".antiscroll-inner").css({height:"",width:"",maxheight:""}),PF.fn.list_fluid_width(),a!==$(window).width()&&($("[data-action=top-bar-menu-full]","#top-bar").hasClass("current")&&PF.fn.topMenu.hide(0),PF.fn.listing.columnizer(!0,0),$(PF.obj.listing.selectors.list_item).show()),a=$(window).width()}),$(document).on("click","html",function(){PF.fn.close_pops()}),$("html").hasClass("no-svg")&&$("img.replace-svg").replace_svg(),$(document).on("keydown",".numeric-input",function(e){e.keydown_numeric()}),$(document).on("click","[data-scrollto]",function(e){var t=$(this).data("scrollto"),o=$(t.match(/^\#|\./)?t:"#"+t);o.exists()?PF.fn.scroll(o):console.log("PF scrollto error: target doesn't exists",o)}),$(document).on("click focus","[data-login-needed], [data-user-logged=must]",function(e){if(!PF.fn.is_user_logged())return e.preventDefault(),e.stopPropagation(),!(window.location.href="https://imgbb.com/login")}),$(document).on("click","[data-trigger]",function(e){if(e.isPropagationStopped())return!1;var t=$(this).data("trigger"),o=$(t.match(/^\#|\./)?t:"#"+t);o.exists()?(e.stopPropagation(),e.preventDefault(),o.closest(PF.obj.modal.selectors.root).length||PF.fn.modal.close(),o.click()):console.log("PF trigger error: target doesn't exists",o)}),$("form[method=post]").each(function(){$("input[name=auth_token]",this).exists()||$(this).append($("<input>",{type:"hidden",name:"auth_token",value:PF.obj.config.auth_token}))}),$(document).on("click",".clear-form",function(){$(this).closest("form")[0].reset()}),$(document).on("submit","form[data-action=validate]",function(e){$(this).data("type");var n=!1;if($(this).find("[required], [data-validate]").each(function(){function e(e){$(e).highlight(),n=!0}var t,o=$(this).attr("type"),i=$(this).attr("pattern");if($(this).is("[required]")&&""==$(this).val()&&($(this).is(":hidden")&&(t=$($($(this).data("highlight")).exists()?$(this).data("highlight"):"#"+$(this).data("highlight")),$(t).highlight()),e(this)),void 0===i&&0==/mail|url/.test(o))return!0;i&&((i=new RegExp(i)).test($(this).val())||e(this)),"email"!=o||$(this).val().isEmail()||e(this)}),n)return PF.fn.growl.expirable(PF.fn._s("Check the errors in the form to continue.")),!1}),$(document).on("change","select[data-combo]",function(){var e=$("#"+$(this).data("combo"));e.exists()&&e.children(".switch-combo").hide();var t=$("#"+$(this).closest("select").data("combo")),o=$("[data-combo-value~="+$("option:selected",this).attr("value")+"]",t);o.exists()&&o.show().find("[data-required]").each(function(){$(this).attr("required","required")}),$(".switch-combo",t).each(function(){$(this).is(":visible")||$("[required]",this).attr("data-required",!0).removeAttr("required")})}),$(document).on("keyup",function(e){$this=$(e.target),27==e.keyCode&&$(PF.obj.modal.selectors.root).is(":visible")&&!$this.is(":input")&&$("[data-action=cancel],[data-action=close-modal]",PF.obj.modal.selectors.root).first().click()}),$(document).on("change",":input",function(e){PF.fn.growl.close()}),$(document).on("keyup",":input",function(e){$(".input-warning",$(this).closest(".input-label")).html("")}),$(document).on("blur",":input",function(){var e=$.trim($(this).prop("value"));$(this).prop("value",e)}),$(document).on("click",":input[data-focus=select-all]",function(){this.select()}),$(document).on("keyup change blur",":input[type=password]",function(){var e=testPassword($(this).val()),t=$(this).closest("div");""==$(this).val()&&(e.percent=0,e.verdict=""),$("[data-content=password-meter-bar]",t).attr("data-veredict",e.verdict.replace(/ /g,"-")).width(e.percent),$("[data-text=password-meter-message]",t).removeClass("red-warning").text(""!==e.verdict?PF.fn._s(e.verdict):"")}),$(document).on("click","[rel=popup-link], .popup-link",function(e){e.preventDefault();var t=$(this)[void 0!==$(this).attr("href")?"attr":"data"]("href");if(void 0!==t)return"mailto"==t.substring(0,6)&&PF.fn.isDevice(["phone","phablet"])?(window.location=t,!1):void PF.fn.popup({href:t})}),$(window).scroll(function(){PF.obj.follow_scroll.process()}),$(document).on("click","[data-modal=simple],[data-modal=html]",function(){var e=$("[data-modal="+$(this).data("target")+"], #"+$(this).data("target")).first();PF.fn.modal.call({template:e.html(),buttons:!1})}),$(document).on("submit",PF.obj.modal.selectors.root+" form",function(e){return!$(this).data("prevented")&&(void 0!==$(this).attr("method")&&void 0)}),$(document).on("click","[data-modal=edit],[data-modal=form],[data-confirm]",function(e){e.preventDefault();var o,i=$(this);i.is("[data-confirm]")?(o=i,PF.obj.modal.type="confirm"):(0==(o=$("[data-modal="+i.data("target")+"], #"+i.data("target")).first()).length&&(o=$("[data-modal=form-modal], #form-modal").first()),0==o.length&&console.log("PF Error: Modal target doesn't exists."),PF.obj.modal.type=i.data("modal"));var n=i.data("args"),a=window[o.data("submit-fn")],t=window[o.data("cancel-fn")],s=(window[o.data("load-fn")],o.data("submit-done")),r={url:o.data("ajax-url")||(void 0!==o.data("is-xhr")?PF.obj.config.json_api:null),deferred:window[o.data("ajax-deferred")]};if("function"!=typeof a&&o.data("submit-fn")){var l=o.data("submit-fn").split(".");a=window;for(var d=0;d<l.length;d++)a=a[l[d]]}if("function"!=typeof t&&o.data("cancel-fn")){var c=o.data("cancel-fn").split(".");t=window;for(d=0;d<c.length;d++)t=t[c[d]]}if("function"!=typeof load_function&&o.data("load-fn")){var u=o.data("load-fn").split(".");load_function=window;for(d=0;d<u.length;d++)load_function=load_function[u[d]]}if("object"!=typeof r.deferred&&o.data("ajax-deferred")){var f=o.data("ajax-deferred").split(".");r.deferred=window;for(d=0;d<f.length;d++)r.deferred=r.deferred[f[d]]}if("function"!=typeof(p=window[o.data("before-fn")])&&o.data("before-fn"))for(var h=o.data("before-fn").split("."),p=window,d=0;d<h.length;d++)p=p[h[d]];"function"==typeof p&&p(e);var m,g=$(this).data("options")||{};i.is("[data-confirm]")?(m={message:i.data("confirm"),confirm:"function"==typeof a?a(n):"",cancel:"function"==typeof t?t(n):"",ajax:r},i.attr("href")&&""==m.confirm&&(m.confirm=function(){return window.location.replace(i.attr("href"))}),PF.fn.modal.confirm($.extend(m,g))):(o.find('textarea[placeholder][name="urls"]').each(function(e,t){$(t).text()!==$(t).val()&&$(t).html("")}),m={template:o.html(),button_submit:$(this).is("[data-modal=edit]")?PF.fn._s("Save changes"):PF.fn._s("Submit"),confirm:function(){var e=PF.fn.form_modal_has_changed(),t=$("form",PF.obj.modal.selectors.root);if(void 0!==t.attr("action"))return t.data("prevented",!e),void PF.fn.modal.close();if($(":input[name]",t).each(function(){var e;$(this).is(":visible")?"required"==$(this).attr("data-required")&&$(this).prop("required",!0):void 0!==(e=$(this).attr("required"))&&!1!==e&&$(this).prop("required",!1).attr("data-required","required")}),!t[0].checkValidity())return!1;if(e||g.forced){if("function"==typeof a&&(submit_fn=a(n)),"undefined"!=typeof submit_fn&&0==submit_fn)return!1;if($(":input",PF.obj.modal.selectors.root).each(function(){$(this).val($.trim($(this).val()))}),i.is("[data-modal=edit]")&&o.html($(PF.obj.modal.selectors.body,$(PF.obj.modal.selectors.root).bindFormData()).html().replace(/rel=[\'"]tooltip[\'"]/g,'rel="template-tooltip"')),void 0!==r.url)return!0;PF.fn.modal.close(function(){void 0!==s&&PF.fn.growl.expirable(""!==s?s:PF.fn._s("Changes saved successfully."))})}else PF.fn.modal.close()},cancel:function(){if("function"==typeof cancel_fn&&(cancel_fn=cancel_fn()),"undefined"!=typeof cancel_fn&&0==cancel_fn)return!1;if("skip"!=o.data("prompt")&&PF.fn.form_modal_has_changed()){if($(PF.obj.modal.selectors.changes_confirm).exists())return;$(PF.obj.modal.selectors.box,PF.obj.modal.selectors.root).css({transition:"none"}).hide(),$(PF.obj.modal.selectors.root).append('<div id="'+PF.obj.modal.selectors.changes_confirm.replace("#","")+'"><div class="content-width"><h2>'+PF.fn._s("All the changes that you have made will be lost if you continue.")+'</h2><div class="'+PF.obj.modal.selectors.btn_container.replace(".","")+' margin-bottom-0"><button class="btn btn-input default" data-action="cancel">'+PF.fn._s("Go back to form")+'</button> <span class="btn-alt">'+PF.fn._s("or")+' <a data-action="submit">'+PF.fn._s("continue anyway")+"</a></span></div></div>"),$(PF.obj.modal.selectors.changes_confirm).css("margin-top",-$(PF.obj.modal.selectors.changes_confirm).outerHeight(!0)/2).hide().fadeIn("fast")}else PF.fn.modal.close(),"#edit"==window.location.hash&&(window.location.hash="")},load:function(){"function"==typeof load_function&&load_function()},callback:function(){},ajax:r},PF.fn.modal.call($.extend(m,g)))}),PF.fn.is_user_logged()||$("[data-login-needed]:input, [data-user-logged=must]:input").each(function(){$(this).attr("readonly",!0)}),$(document).on("keydown",PF.obj.modal.selectors.root+" input",function(e){var t=$(e.target),o=e.charCode||e.keyCode;13===o?13==o&&$("[data-action=submit]",PF.obj.modal.selectors.root).exists()&&!t.is(".prevent-submit")&&$("[data-action=submit]",PF.obj.modal.selectors.root).click():PF.fn.growl.close()}),window.location.hash&&"#edit"==window.location.hash&&$("[data-modal=edit]").first().click(),$(document).on("click","[data-action=top-bar-menu-full]",function(){var e=$("[data-action=top-bar-menu-full]","#top-bar").hasClass("current");PF.fn.topMenu[e?"hide":"show"]()}),$(document).on("click","[data-action=top-bar-search]",function(){$("[data-action=top-bar-search-input]",".top-bar").removeClass("hidden").show(),$("[data-action=top-bar-search-input]:visible input").first().focus(),is_ios()&&!$(this).closest(PF.fn.topMenu.vars.menu).exists()&&$(".top-bar").css("position","absolute"),$("[data-action=top-bar-search]",".top-bar").hide()}),$(document).on("click",".input-search .icon-search",function(e){$("input",e.currentTarget.offsetParent).focus()}),$(document).on("click",".input-search .icon-close, .input-search [data-action=clear-search]",function(e){var t=$("input",e.currentTarget.offsetParent);""==t.val()?$(this).closest("[data-action=top-bar-search-input]").exists()&&($("[data-action=top-bar-search-input]",".top-bar").hide(),$("[data-action=top-bar-search]",".top-bar").removeClass("opened").show(),is_ios()&&"fixed"!==$(this).closest("#top-bar").css("position")&&$(".top-bar").css("position","fixed")):($(this).closest("[data-action=top-bar-search-input]").exists()||$(this).hide(),t.val("").change())}),$(document).on("keyup change","input.search",function(e){var t,o=$(this),i=$(this).closest(".input-search");$(this).closest("[data-action=top-bar-search-input]").exists()||(t=""==o.val()?"hide":"show",$(".icon-close, [data-action=clear-search]",i)[t]())}),$(document).on("click mouseenter",".pop-btn",function(e){var t,o,i,s,n,r,a,l,d;PF.fn.isDevice(["phone","phablet"])&&("mouseenter"==e.type||$(this).hasClass("pop-btn-desktop"))||(t=$(e.target),s=$.makeArray(["phone","phablet"]),r=$(this),"mouseenter"==e.type&&!$(this).hasClass("pop-btn-auto")||$(this).hasClass("disabled")||t.closest(".current").exists()&&!PF.fn.isDevice("phone")&&!t.closest(".pop-btn-show").exists()||(PF.fn.growl.close(),e.stopPropagation(),o=$(this),i=$(".pop-box",o),o.addClass("opened"),$(".pop-box-inner",i).css("max-height",""),PF.fn.isDevice(s)?(void 0!==(n=$(".btn-text,.text,.pop-btn-text",o).first().text())&&""!=n||(n=PF.fn._s("Select")),$(".pop-box-header",i).exists()||i.prepend($("<div/>",{class:"pop-box-header",html:n+'<span class="btn-icon icon-close"></span></span>'}))):($(".pop-box-header",i).remove(),i.css({bottom:""})),i.hasClass("anchor-center")&&void 0===i.data("guidstr")&&(PF.fn.isDevice(s)?i.css("margin-left",""):i.css("margin-left",-i.width()/2)),t.is("[data-change]")&&($("li",i).removeClass("current"),t.closest("li").addClass("current"),$("[data-text-change]",o).text($("li.current a",i).text()),e.preventDefault()),i.exists()&&(r=e.istriggered?$(e.target):$(this),i.is(":visible")&&$(e.target).closest(".pop-box-inner").exists()&&r.hasClass("pop-keep-click")||($(".pop-box:visible").not(i).hide().closest(".pop-btn").removeClass("opened"),a=function(e){var t,o,i,n,a;e.is(":visible")?PF.fn.isDevice(s)?$(".antiscroll-inner",e).height("100%"):(void 0!==(t=e.css("marginLeft"))&&(t=parseFloat(t),e.css("marginLeft","")),(o=e.getWindowCutoff())&&(o.left||o.right)&&o.right<t?(a="guid-"+PF.fn.guid(),e.css("marginLeft",o.right+"px").addClass(a).attr("data-guidstr",a),i=r.outerWidth()/2+r.offset().left-e.offset().left,n=[],$.each(["top","bottom"],function(e,o){$.each(["after","before"],function(e,t){n.push("."+a+".arrow-box-"+o+":"+t)})}),$('<style id="'+a+'">'+n.join()+" { left: "+i+"px; }</style>").appendTo("head")):e.css("marginLeft",t+"px"),$(".antiscroll-wrap:not(.jsly):visible",e).addClass("jsly").antiscroll()):(a=e.attr("data-guidstr"),e.css("marginLeft","").removeClass(a).removeAttr("data-guidstr").closest(".pop-btn").removeClass("opened"),void 0!==a&&$("style#"+a).remove())},PF.fn.isDevice(s)?($(this).is("[data-action=top-bar-notifications]")&&i.css({height:$(window).height()}),l=i.height()+"px",d=parseInt($(".top-bar").outerHeight())+parseInt($(".top-bar").css("top"))+parseInt($(".top-bar").css("margin-top"))+parseInt($(".top-bar").css("margin-bottom"))+"px",i.is(":visible")?($("#pop-box-mask").css({opacity:0}),i.css({transform:"none"}),r.closest(PF.fn.topMenu.vars.menu).exists()&&($(".top-bar").css({transform:"none"}),$(PF.fn.topMenu.vars.menu).css({height:$(window).height()+parseInt(d)})),setTimeout(function(){i.hide().attr("style",""),$("#pop-box-mask").remove(),a(i),r.closest(PF.fn.topMenu.vars.menu).exists()&&($(PF.fn.topMenu.vars.menu).css({height:""}),$(PF.fn.topMenu.vars.menu).animate({scrollTop:PF.fn.topMenu.vars.scrollTop},PF.obj.config.animation.normal/2))},PF.obj.config.animation.normal),$("body").data("hasOverflowHidden")||$("body").removeClass("overflow-hidden")):($("#pop-box-mask").remove(),i.parent().prepend($("<div/>",{id:"pop-box-mask",class:"fullscreen soft-black"}).css({zIndex:400,display:"block"})),PF.fn.topMenu.vars.scrollTop=$(PF.fn.topMenu.vars.menu).scrollTop(),setTimeout(function(){$("#pop-box-mask").css({opacity:1}),setTimeout(function(){i.show().css({bottom:"-"+l,maxHeight:$(window).height(),zIndex:1e3,transform:"translate(0,0)"}),setTimeout(function(){i.css({transform:"translate(0,-"+l+")"})},1),setTimeout(function(){a(i)},PF.obj.config.animation.normal),$("body").hasClass("overflow-hidden")?$("body").data("hasOverflowHidden",1):$("body").addClass("overflow-hidden"),r.closest(PF.fn.topMenu.vars.menu).exists()&&($(".top-bar").css({transform:"translate(0, -"+d+")"}),$(PF.fn.topMenu.vars.menu).css({height:$(window).height()+parseInt(d)})),$(".pop-box-inner",i).css("height",i.height()-$(".pop-box-header",i).outerHeight(!0))},1)},1))):i[i.is(":visible")?"hide":"show"](0,function(){a(i)})))))}).on("mouseleave",".pop-btn",function(){var e,t;PF.fn.isDevice(["laptop","desktop"])&&(e=$(this),t=$(".pop-box",e),!e.hasClass("pop-btn-auto")||PF.fn.isDevice(["phone","phablet"])&&e.hasClass("pop-btn-auto")||(!PF.fn.isDevice(["phone","phablet","tablet"])&&$(this).hasClass("pop-btn-delayed")&&$(this).removeClass("pop-btn-auto"),t.hide().closest(".pop-btn").removeClass("opened")))}),$(".pop-btn-delayed").delayedAction({delayedAction:function(e){PF.fn.isDevice(["phone","phablet","tablet"])||$(".pop-box-inner",e).is(":hidden")&&e.addClass("pop-btn-auto").click()},hoverTime:2e3}),window.location.hash,$(".content-tabs").exists()&&(t=$("a",".content-tabs .current"),History.replaceState({href:t.attr("href"),"data-tab":t.data("tab"),pushed:"tabs",statenum:0},null,null)),void 0===History.getState().data&&History.replaceState({scrollTop:0},document.title,window.location.href),History.Adapter.bind(window,"popstate",function(){var e=History.getState();e.data&&void 0!==e.data.scrollTop&&$(window).scrollTop()!==e.data.scrollTop&&$(window).scrollTop(e.data.scrollTop)}),$("a",".content-tabs").click(function(e){var t,o,i;1==$(this).data("link")&&$(this).data("tab",!1),$(this).closest(".current,.disabled").exists()?e.preventDefault():void 0!==$(this).data("tab")&&(t={},$.each(this.attributes,function(){t[this.name]=this.value}),t.pushed="tabs","classic"!=$("#"+t["data-tab"]).data("load")&&(window.location.hash&&(o=(o=window.location.href).replace(window.location.hash,"")),History.pushState(t,document.title,void 0!==o?o:$(this).attr("href")),e.preventDefault()),(i=$("[data-action=tab-menu]",$(this).closest(".header"))).find("[data-content=current-tab-label]").text($(this).text()),$(this).is(":visible")&&i.is(":visible")&&i.click())}),$(document).on("click","[data-action=tab-menu]",function(){var e=$(this).closest(".header").find(".content-tabs"),t=e.is(":visible"),o=$(this);if(2==e.find("li a").length){var i=e.find("li:not(.current) a");if(1==i.length)return void i.click()}t||(e.data("classes",e.attr("class")),e.removeClass(function(e,t){return(t.match(/\b\w+-hide/g)||[]).join(" ")}),e.hide()),t||o.removeClass("current"),e[t?"hide":"show"](),t&&(e.css("display","").addClass(e.data("classes")),o.addClass("current"))}),$(window).bind("statechange",function(e){var t;PF.fn.growl.close(),(t=History.getState().data)&&"tabs"==t.pushed&&PF.fn.show_tab(t["data-tab"])}),$(document).on("click",".list-item a",function(e){""!=$(this).attr("src")&&History.replaceState({scrollTop:$(window).scrollTop()},document.title,window.location.href)}),$(document).on("click","[data-action=load-more]",function(e){$(this).closest(".content-listing-more").hide(),!PF.fn.is_listing()||$(this).closest(PF.obj.listing.selectors.content_listing).is(":hidden")||$(this).closest("#content-listing-template").exists()||PF.obj.listing.calling||(PF.fn.listing.queryString.stock_new(),PF.obj.listing.query_string.seek=$(this).attr("data-seek"),PF.obj.listing.query_string.page=$(PF.obj.listing.selectors.content_listing_visible).data("page"),PF.obj.listing.query_string.page++,PF.fn.listing.ajax(),e.preventDefault())}),0<$(PF.obj.listing.selectors.list_item).length&&(PF.fn.listing.show(),$(window).scroll(function(){var e=$(PF.obj.listing.selectors.content_listing_load_more,PF.obj.listing.selectors.content_listing_visible).find("button[data-action=load-more]");0<e.length&&$(window).scrollTop()+$(window).innerHeight()>$(document).height()-300&&0==PF.obj.listing.calling&&e.click()})),$(document).on("click",PF.obj.modal.selectors.root+" [data-switch]",function(){var e=$(this).closest(PF.obj.modal.selectors.root);$("[data-view=switchable]",e).hide(),$("#"+$(this).attr("data-switch"),e).show()}),$(document).on("click","[data-toggle]",function(){var e=$("[data-content="+$(this).data("toggle")+"]"),t=!e.is(":visible");$(this).html($(this).data("html-"+(t?"on":"off"))),e.toggle()}),Clipboard=new Clipboard("[data-action=copy]",{text:function(e){var t=$(e.getAttribute("data-action-target"));return(t.is(":input")?t.val():t.text()).trim()}}),Clipboard.on("success",function(e){$(e.trigger.getAttribute("data-action-target")).highlight(),e.clearSelection()})});var PF={fn:{},str:{},obj:{}};PF.obj.config={base_url:"",json_api:"/json/",listing:{items_per_page:24},animation:{easingFn:"ease",normal:400,fast:250}},PF.obj.l10n={},PF.fn._s=function(e,t){return void 0===e||(void 0!==PF.obj.l10n&&void 0!==PF.obj.l10n[e]&&void 0!==(e=PF.obj.l10n[e][0])||(e=e),e=e.toString(),void 0!==t&&(e=sprintf(e,t))),e},PF.fn._n=function(e,t,o){var i=void 0!==PF.obj.l10n&&void 0!==PF.obj.l10n[e]?PF.obj.l10n[e][1==o?0:1]:1==o?e:t;return i=void 0===i?e:i.toString(),void 0!==o&&(i=sprintf(i,o)),i},PF.fn.extend_lang=function(o){$.each(PF.obj.lang_strings,function(e,t){void 0!==o[e]&&$.extend(PF.obj.lang_strings[e],o[e])})},PF.fn.get_url_vars=function(){function e(e){return decodeURIComponent(escape(e.replace(o," ")))}for(var t,o=/\+/g,i=/([^&=]+)=?([^&]*)/g,n=window.location.search.substring(1),a={};t=i.exec(n);)a[e(t[1])]=e(t[2]);return a},PF.fn.get_url_var=function(e){return PF.fn.get_url_vars()[e]},PF.fn.is_user_logged=function(){return $("#top-bar-user").exists()},PF.fn.generate_random_string=function(e){void 0===e&&(e=5);for(var t="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<e;i++)t+=o.charAt(Math.floor(Math.random()*o.length));return t},PF.fn.getDateTime=function(){var e=new Date,t=e.getFullYear(),o=e.getMonth()+1,i=e.getDate(),n=e.getHours(),a=e.getMinutes(),s=e.getSeconds();return 1==o.toString().length&&(o="0"+o),1==i.toString().length&&(i="0"+i),1==n.toString().length&&(n="0"+n),1==a.toString().length&&(a="0"+a),1==s.toString().length&&(s="0"+s),t+"-"+o+"-"+i+" "+n+":"+a+":"+s},PF.fn.htmlEncode=function(e){return $("<div/>").text($.trim(e)).html()},PF.fn.htmlDecode=function(e){return $("<div/>").html($.trim(e)).text()},PF.fn.nl2br=function(e){return(e+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br>$2")},PF.fn.baseName=function(e){var t=new String(e).substring(e.lastIndexOf("/")+1);return-1!=t.lastIndexOf(".")&&(t=t.substring(0,t.lastIndexOf("."))),t},PF.fn.ext=function(e){var t=new String(e).substring(e.lastIndexOf("/")+1);return-1!=t.lastIndexOf(".")&&(t=t.substring(t.lastIndexOf(".")+1)),t.toLowerCase()},PF.fn.guid=function(){var o=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(o+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(o+16*Math.random())%16|0;return o=Math.floor(o/16),("x"===e?t:3&t|8).toString(16)})},PF.fn.md5=function(e){for(var t=0,o=0,i=e.length;o<i;)t=(t<<5)-t+e.charCodeAt(o++)<<0;return t},PF.fn.dataURItoBlob=function(e){for(var t=(0<=e.split(",")[0].indexOf("base64")?atob:unescape)(e.split(",")[1]),o=e.split(",")[0].split(":")[1].split(";")[0],i=new Uint8Array(t.length),n=0;n<t.length;n++)i[n]=t.charCodeAt(n);return new Blob([i],{type:o})},PF.fn.clean_facebook_hash=function(){"#_=_"==window.location.hash&&(window.location.hash="")},PF.fn.clean_facebook_hash(),Object.size=function(e){var t,o=0;for(t in e)e.hasOwnProperty(t)&&o++;return o},Object.flatten=function(e,o){void 0===o&&(o="");var i={};return $.each(e,function(e,t){t&&("object"==typeof t?i=$.extend({},i,Object.flatten(t,o+e+"_")):i[o+e]=t)}),i},String.prototype.isNumeric=function(){return!isNaN(parseFloat(this))&&isFinite(this)},String.prototype.repeat=function(e){return new Array(e+1).join(this)},String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.isEmail=function(){return/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(this)},String.prototype.match_image_urls=function(){return this.match(/\b(?:(http[s]?|ftp[s]):\/\/)?([^:\/\s]+)(:[0-9]+)?((?:\/\w+)*\/)([\w\-\.]+[^#?\s]+)([^#\s]*)?(#[\w\-]+)?\.(?:jpe?g|gif|png|bmp|webp|heic|heif|pdf|tif?f)\b/gim)},String.prototype.match_urls=function(){return this.match(/\b(?:(http[s]?|ftp[s]):\/\/)?([^:\/\s]+)(:[0-9]+)?((?:\/\w+)*\/)([\w\-\.]+[^#?\s]+)([^#\s\b]*)?(#[\w\-]+)?/gim)},"indexOf"in Array.prototype||(Array.prototype.indexOf=function(e,t){void 0===t&&(t=0),t<0&&(t+=this.length),t<0&&(t=0);for(var o=this.length;t<o;t++)if(t in this&&this[t]===e)return t;return-1}),Array.prototype.array_unique=function(){var o=[];return $.each(this,function(e,t){-1==$.inArray(t,o)&&o.push(t)}),o},PF.fn.deparam=function(e){if(void 0!==e&&e){for(var t={},o=(e=e.substring(e.indexOf("?")+1)).replace(/^[\?|&]*/,"").replace(/[&|\?]*$/,"").split("&"),i=0;i<o.length;i++){var n=o[i].split("="),a=decodeURIComponent(n[0]),s=n[1]?decodeURIComponent(n[1]):null;t.hasOwnProperty(a)&&!s||(t[a]=s)}return t}},String.prototype.removeURLParameter=function(e){var t=PF.fn.deparam(this);return void 0!==t[e]&&delete t[e],decodeURIComponent($.param(t))},String.prototype.changeURLParameterValue=function(e,t){var o=this.substring(0,this.indexOf("?")),i=PF.fn.deparam(this);return void 0!==i[e]&&(i[e]=t),o+"?"+decodeURIComponent($.param(i))},String.prototype.truncate_middle=function(e){var t=(e=void 0!==e?e:40)/2,o=this.replace(/https?:\/\//g,"");if(o.length<=e)return o;function i(e,t,o){for(var i=[" ","/","&"],n=.8*t,e=(o=void 0!==o&&o)?e.split("").reverse().join(""):e,a="",s=0;s<t-1&&(a+=e[s],!(n<=s&&0<=i.indexOf(e[s])));s++);return o?a.split("").reverse().join(""):a}return i(o,t,!1)+"..."+i(o,t,!0)},jQuery.fn.exists=function(){return 0<this.length},jQuery.fn.replace_svg=function(){this.attr("src")&&$(this).each(function(){$(this).attr("src",$(this).attr("src").replace(".svg",".png"))})},jQuery.fn.is_fluid=function(){return!0},jQuery.fn.bindFormData=function(){return $(":input",this).each(function(){var e,t,o=PF.fn.htmlEncode($(this).val());$(this).is("input")&&(this.setAttribute("value",this.value),this.checked?this.setAttribute("checked","checked"):this.removeAttribute("checked")),$(this).is("textarea")&&$(this).html(o),$(this).is("select")&&(e=this.selectedIndex,t=0,$(this).children("option").each(function(){t++!=e?this.removeAttribute("selected"):this.setAttribute("selected","selected")}))}),this},jQuery.fn.formValues=function(e){var t=$(":input",this);return"object"!=typeof e?(e={},$.each(t,function(){this.name&&!this.disabled&&(this.checked||/select|textarea/i.test(this.nodeName)||/color|date|datetime|datetime-local|email|month|range|search|tel|time|url|week|text|number|hidden|password/i.test(this.type))&&(this.name.match(/^.*\[\]$/)&&this.checked?(void 0===e[this.name]&&(e[this.name]=[]),e[this.name].push($(this).val())):e[this.name]=$(this).val())}),e):($.each(t,function(){this.name.match(/^.*\[\]$/)&&"object"==typeof e[this.name]?$(this).prop("checked",-1!==e[this.name].indexOf($(this).val())):this.name&&e[this.name]?/checkbox|radio/i.test(this.type)?$(this).prop("checked",e[this.name]==$(this).val()):$(this).val(e[this.name]):/checkbox|radio/i.test(this.type)&&$(this).removeProp("checked")}),$(this))},jQuery.Event.prototype.keydown_numeric=function(){var e=this;if(e.shiftKey)return e.preventDefault(),!1;var t=e.charCode||e.keyCode,o=e.target;""==$(o).val()||parseInt($(o).val());return 13==t||(46==t||8==t||9==t||27==t||65==t&&!0===e.ctrlKey||35<=t&&t<=40||void((t<48||57<t)&&(t<96||105<t)&&e.preventDefault()))},PF.fn.getScrollBarWidth=function(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),document.body.appendChild(t);var o=e.offsetWidth;t.style.overflow="scroll";var i=e.offsetWidth;return o==i&&(i=t.clientWidth),document.body.removeChild(t),o-i},PF.str.ScrollBarWidth=PF.fn.getScrollBarWidth(),PF.fn.top_notifications_viewed=function(){var e=$("[data-action=top-bar-notifications]"),t=($(".top-bar-notifications-list",e),$(".top-btn-number",e));$(".persistent",e).exists()?t.text($(".persistent",e).length).addClass("on"):t.removeClass("on")},PF.fn.bindtipTip=function(e,t){void 0===e&&(e=$("body")),e instanceof jQuery==0&&(e=$(e));var o={delay:0,content:!1,fadeIn:0};void 0!==t&&(void 0!==t.delay&&(o.delay=t.delay),void 0!==t.content&&(o.content=t.content),void 0!==t.content&&(o.fadeIn=t.fadeIn)),"tooltip"!==e.attr("rel")&&(e=$("[rel=tooltip]",e)),e.each(function(){if((void 0!==$(this).attr("href")||void 0!==$(this).data("href"))&&PF.fn.isDevice(["phone","phablet","tablet"]))return!0;var e=void 0===$(this).data("tiptip")?"bottom":$(this).data("tiptip");PF.fn.isDevice(["phone","phablet"])&&(e="top"),$(this).tipTip({delay:o.delay,defaultPosition:e,content:o.content,fadeIn:o.fadeIn,fadeOut:0})})},PF.fn.form_modal_has_changed=function(){if(!$(PF.obj.modal.selectors.root).is(":hidden")&&void 0!==$("html").data("modal-form-values")){var e=$("html").data("modal-form-values"),t=PF.fn.deparam($(":input:visible",PF.obj.modal.selectors.root).serialize()),o=!1,i=$.extend({},e,t);for(var n in i)if(e[n]!==t[n]){o=!0;break}return o}},PF.fn.is_listing=function(){return $(PF.obj.listing.selectors.content_listing).exists()},PF.fn.is_tabs=function(){return $(".content-tabs").exists()},jQuery.fn.shake=function(e){return this.each(function(e){var t=$(this),o=t.css("position");o.match("relative|absolute|fixed")||t.css({position:"relative"});var i=parseInt(t.css("left"));if(i.toString().isNumeric()||(i=0),!t.is(":animated")){for(var n=1;n<=2;n++)t.animate({left:i-10},0).animate({left:i},30).animate({left:i+10},30).animate({left:i},30);"static"!==o&&t.css({position:o})}}),"function"==typeof e&&e(),this},jQuery.fn.highlight=function(e){if(this.is(":animated")||!this.exists())return this;void 0===e&&(e="yellow");var t=e;switch(e){case"yellow":t="#FFFBA2";break;case"red":t="#FF7F7F";break;default:t=e}var o=$(this).css("background-color");$(this).css("background");return $(this).css({background:"",backgroundColor:t}).animate({backgroundColor:o},800,function(){$(this).css("background","")}),this},jQuery.fn.pf_slideDown=function(i,n){var a,s,r,l=$(this).length;return"function"==typeof i&&(n=i,i="normal"),void 0===i&&(i="normal"),$(this).each(function(e){var t=parseInt($(this).css("top")),o=0<t?t:0;r=0==i?(a={display:"block",opacity:0},s={opacity:1},jQuery.speed("fast").duration):(a={top:-$(this).outerHeight(!0),opacity:1,display:"block"},s={top:o},jQuery.speed(i).duration),$(this).data("originalTop",$(this).css("top")),$(this).css(a).animate(s,r,function(){e==l-1&&"function"==typeof n&&n()})}),this},jQuery.fn.is_in_viewport=function(){var e=$(this)[0].getBoundingClientRect();return 0<=e.top&&0<=e.left&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)},jQuery.fn.getWindowCutoff=function(){var e={top:$(this).offset().top,left:$(this).offset().left,width:$(this).outerWidth(),height:$(this).outerHeight()};e.right=e.left+e.width,e.bottom=e.top+e.height;var t=!1,o={top:0<e.top?0:e.top,right:document.body.clientWidth-e.right,bottom:document.body.clientHeight-e.bottom,left:0<e.left?0:e.left};for(var i in o)o[i]<0?t=!0:o[i]=0;return t?o:null},PF.fn.scroll=function(e,t){"function"==typeof e&&(t=e,e="");var o=parseInt($("body").css("margin-top"));0==o&&$(".top-bar-placeholder").exists()&&(o=$(".top-bar-placeholder").height()),$(e).exists()||(e="html"),$("body,html").animate({scrollTop:$(e).offset().top-o},"normal",function(){"function"==typeof t&&t()})},PF.fn.close_pops=function(e){$(".pop-box:visible").each(function(){$(this).closest(".pop-btn").click()})},PF.fn.growl={selectors:{root:"#growl"},str:{timeout:null,timeoutcall:!1},call:function(e){if(void 0!==e&&("string"==typeof e&&(e={message:e}),void 0!==e.message)){var t,o,i,n={message:e.message,insertTo:"body",where:"before",color:"default",css:{},classes:"",expires:0,callback:function(){}};for(key in n)void 0===e[key]||key.match("/^(callback)$/")&&"function"!=typeof e[key]||(n[key]=e[key]);if($(n.insertTo).exists()||(n.insertTo="body"),$(PF.fn.growl.selectors.root).exists()){if($(PF.fn.growl.selectors.root).text()==n.message)return void $(PF.fn.growl.selectors.root).shake();$(PF.fn.growl.selectors.root).remove()}switch(t=$('<div id="'+PF.fn.growl.selectors.root.replace("#","")+'" class="growl">'+n.message+'<span class="icon icon-close" data-action="close"></span></div>').css(n.css).addClass(n.classes),o="body"!==n.insertTo?"static":"",n.color){case"dark":i="dark";break;default:i=""}t.addClass(o+" "+i),"before"==n.where?$(n.insertTo).prepend(t.hide()):$(n.insertTo).append(t.hide()),$(".fullscreen").is(":visible")&&t.css({"z-index":parseInt($(".fullscreen").css("z-index"))+1}),$(PF.obj.modal.selectors.root).is(":visible")&&($(PF.obj.modal.selectors.box,PF.obj.modal.selectors.root),t.show(),t.css("top",($("#top-bar").outerHeight(!0)-t.outerHeight(!0))/2),PF.fn.growl.fixPosition(),t.hide()),t.pf_slideDown("static"==o?0:200,function(){"function"==typeof n.callback&&n.callback()}),$(document).on("click",".growl",function(e){(PF.fn.isDevice(["phone","phablet"])||$(e.target).is("[data-action=close]"))&&PF.fn.growl.close(!0)}),0<n.expires&&("number"==typeof this.str.timeout&&clearTimeout(this.str.timeout),this.str.timeout=setTimeout(function(){PF.fn.growl.str.timeoutcall=!0,PF.fn.growl.close()},n.expires))}},expirable:function(e,t){void 0!==e&&(void 0===t&&(t=5e3),PF.fn.growl.call({message:e,expires:t}))},close:function(e,t){var o=$(PF.fn.growl.selectors.root);e&&(this.str.timeout=null,this.str.timeoutcall=!1,clearTimeout(this.str.timeout)),o.exists()&&("number"!=typeof this.str.timeout||this.str.timeoutcall)&&o.fadeOut("fast",function(){$(this).remove(),"function"==typeof t&&t()})},fixPosition:function(){var e,t,o=$(PF.fn.growl.selectors.root);o.exists()&&$(PF.obj.modal.selectors.root).exists()&&("scrollbar"==o.data("fixedPosition")&&$(PF.obj.modal.selectors.root).hasScrollBar().vertical||(t=(e=$(PF.obj.modal.selectors.box).offset().left-o.offset().left)<0?"-="+Math.abs(e):"-"+parseInt(o.css("width"))/2,PF.fn.isDevice(["phone","phablet"])||o.css("marginLeft",t+"px"),o.data("fixedPosition",$(PF.obj.modal.selectors.root).hasScrollBar().vertical?"scrollbar":"no-scrollbar")))}},PF.obj.modal={type:"",selectors:{root:"#fullscreen-modal",box:"#fullscreen-modal-box",body:"#fullscreen-modal-body",login:"[data-modal=login]",changes_confirm:"#fullscreen-changes-confirm",btn_container:".btn-container",close_buttons:".close-modal,.cancel-modal,[data-action=cancel],[data-action-close]",submit_button:"[data-action=submit]",growl_placeholder:"#fullscreen-growl-placeholder"},ajax:{url:"",deferred:{}},locked:!1,form_data:{},XHR:{},prevented:!1},PF.obj.modal.$close_buttons=$(PF.obj.modal.selectors.close_buttons,PF.obj.modal.selectors.root),PF.obj.modal.$submit_button=$(PF.obj.modal.selectors.submit_button,PF.obj.modal.selectors.root),PF.fn.modal={str:{transition:"all "+PF.obj.config.animation.fast+"ms ease"},call:function(a){var s,e;if(void 0!==a&&(void 0!==a.template&&void 0===a.type&&(a.type="html"),void 0!==a.title&&void 0!==a.message||"login"===a.type||"html"===a.type)){for(key in PF.fn.growl.close(),s={forced:!1,type:"confirm",title:a.title,message:a.message,html:!1,template:a.template,buttons:!0,button_submit:PF.fn._s("Submit"),txt_or:PF.fn._s("or"),button_cancel:PF.fn._s("cancel"),ajax:{url:null,data:null,deferred:{}},confirm:function(){},cancel:function(){PF.fn.modal.close()},load:function(){},callback:function(){}})void 0===a[key]||/^cancel|confirm|callback$/.test(key)&&"function"!=typeof a[key]||(s[key]=a[key]);void 0!==a.ajax&&!a.ajax.url&&a.ajax.deferred&&(s.ajax.url=PF.obj.config.json_api),"login"==s.type&&(s.buttons=!1),"confirm"==s.type&&(s.button_submit=PF.fn._s("Confirm"));var t,o,i=['<div id="',PF.obj.modal.selectors.root.replace("#",""),'"class="fullscreen soft-black"><div id="',PF.obj.modal.selectors.box.replace("#",""),'"class="clickable"><div id="',PF.obj.modal.selectors.body.replace("#",""),'">%MODAL_BODY%</div>%MODAL_BUTTONS%<span class="close-modal icon-close" data-action="close-modal"></span></div></div>'].join(""),n=s.buttons?['<div class="',PF.obj.modal.selectors.btn_container.replace(".",""),'"><button class="btn btn-input default" data-action="submit" type="submit">',s.button_submit,'</button> <span class="btn-alt">',s.txt_or,'<a class="cancel" data-action="cancel">',s.button_cancel,"</a></span></div>"].join(""):"";switch("login"==s.type&&(s.template=void 0===s.template?$(PF.obj.modal.selectors.login).html():s.template),s.type){case"html":case"login":t=s.template;break;case"confirm":default:e=s.message,s.html||(e="<p>"+e+"</p>"),t="<h1>"+s.title+"</h1>"+e}void 0!==t?(i=i.replace("%MODAL_BODY%",t).replace("%MODAL_BUTTONS%",n).replace(/template-tooltip/g,"tooltip"),$(PF.obj.modal.selectors.root).remove(),$("body").data("overflow-hidden",$("body").hasClass("overflow-hidden")),$("body").prepend(i).addClass("overflow-hidden"),this.fixScrollbars(),$("[rel=tooltip]",PF.obj.modal.selectors.root).each(function(){PF.fn.bindtipTip(this,{content:$(this).data("title")})}),0<$(":button, input[type=submit], input[type=reset]",PF.obj.modal.selectors.root).length&&((o=$("form",PF.obj.modal.selectors.root)).exists()?(o.append($($(PF.obj.modal.selectors.btn_container,PF.obj.modal.selectors.root).html()).wrapInner(PF.obj.modal.selectors.btn_container.replace(".",""))),$(PF.obj.modal.selectors.btn_container,PF.obj.modal.selectors.root).each(function(){$(this).closest("form").exists()||$(this).remove()})):$(PF.obj.modal.selectors.box,PF.obj.modal.selectors.root).wrapInner("<form />")),s.callback(),$(PF.obj.modal.selectors.box).css({transform:"scale(0.7)",opacity:0,transition:PF.fn.modal.str.transition}),$(PF.obj.modal.selectors.root).css({display:"block"}),setTimeout(function(){$(PF.obj.modal.selectors.root).css({opacity:1}),$(PF.obj.modal.selectors.box).css({transform:"scale(1)",opacity:1}),"undefined"!=typeof PFrecaptchaCallback&&PFrecaptchaCallback(),setTimeout(function(){$("html").data("modal-form-values",PF.fn.deparam($(":input:visible",PF.obj.modal.selectors.root).serialize())),"function"==typeof s.load&&s.load()},PF.obj.config.animation.fast)},1),$(PF.obj.modal.selectors.root).click(function(e){var t=$(e.target);if(!PF.obj.modal.locked)if(t.closest(PF.obj.modal.selectors.changes_confirm).exists()&&(t.is(PF.obj.modal.selectors.close_buttons)||t.is(PF.obj.modal.selectors.submit_button)))$(PF.obj.modal.selectors.changes_confirm).remove(),t.is(PF.obj.modal.selectors.close_buttons)?$(PF.obj.modal.selectors.box,this).fadeIn("fast",function(){$(this).css("transition",PF.fn.modal.str.transition)}):PF.fn.modal.close();else if(t.closest(".clickable").exists()&&!t.is(PF.obj.modal.selectors.close_buttons)||(PF.fn.growl.close(),s.cancel()),t.is(PF.obj.modal.selectors.submit_button)){if(!1===s.confirm())return;var o=!0;if(0<$("input, textarea, select",PF.obj.modal.selectors.root).not(":input[type=button], :input[type=submit], :input[type=reset]").length&&!PF.fn.form_modal_has_changed()&&!s.forced&&(o=!1),o)if(s.ajax.url){var i,n=$(PF.obj.modal.selectors.btn_container,PF.obj.modal.selectors.root);switch(PF.obj.modal.locked=!0,n.first().clone().height(n.height()).html("").addClass("loading").appendTo(PF.obj.modal.selectors.root+" form"),n.hide(),PF.obj.modal.$close_buttons.hide(),PF.obj.modal.type){case"edit":i=PF.fn._s("Saving");break;case"confirm":case"form":default:i=PF.fn._s("Sending")}PF.fn.loading.inline($(PF.obj.modal.selectors.btn_container+".loading",PF.obj.modal.selectors.root),{size:"small",message:i,valign:"center"}),$(PF.obj.modal.selectors.root).disableForm(),$.isEmptyObject(PF.obj.modal.form_data)&&(void 0===a.ajax||void 0!==a.ajax.data)||(s.ajax.data=PF.obj.modal.form_data),PF.obj.modal.XHR=$.ajax({url:s.ajax.url,type:"POST",data:s.ajax.data}).complete(function(e){var t,o;PF.obj.modal.locked=!1,200==e.status?"function"==typeof(t=void 0!==s.ajax.deferred&&void 0!==s.ajax.deferred.success?s.ajax.deferred.success:null)?PF.fn.modal.close(function(){"function"==typeof t&&t(e)}):"object"==typeof t&&("function"==typeof t.before&&t.before(e),"function"==typeof t.done&&t.done(e)):($(PF.obj.modal.selectors.root).enableForm(),$(PF.obj.modal.selectors.btn_container+".loading",PF.obj.modal.selectors.root).remove(),n.css("display",""),void 0!==s.ajax.deferred&&"function"==typeof s.ajax.deferred.error?s.ajax.deferred.error(e):(o=PF.fn._s("An error occurred. Please try again later."),PF.fn.growl.call(o)))})}else PF.fn.modal.close(s.callback())}})):console.log("PF Error: Modal content is empty")}},confirm:function(e){e.type="confirm",void 0===e.title&&(e.title=PF.fn._s("Confirm action")),PF.fn.modal.call(e)},simple:function(e){"string"==typeof e&&(e={message:e}),void 0===e.buttons&&(e.buttons=!1),void 0===e.title&&(e.title=PF.fn._s("information")),PF.fn.modal.call(e)},fixScrollbars:function(){var e,t;$(PF.obj.modal.selectors.root).exists()&&(e={padding:$(".top-bar, .fixed, .position-fixed"),margin:$("html")},t={},0<PF.str.ScrollBarWidth&&$("html").hasScrollBar().vertical&&!$("body").data("overflow-hidden")?(t.padding=PF.str.ScrollBarWidth+"px",t.margin=PF.str.ScrollBarWidth+"px"):(t.padding="",t.margin=""),e.padding.css({paddingRight:t.padding}),e.margin.css({marginRight:t.margin}))},close:function(e){$(PF.obj.modal.selectors.root).exists()&&(PF.fn.growl.close(!0),$("[rel=tooltip]",PF.obj.modal.selectors.root).tipTip("hide"),$(PF.obj.modal.selectors.box).css({transform:"scale(0.5)",opacity:0}),$(PF.obj.modal.selectors.root).css({opacity:0}),setTimeout(function(){0<PF.str.ScrollBarWidth&&$("html").hasScrollBar().vertical&&$(".top-bar, .fixed, .position-fixed").css({paddingRight:""}),$("html").css({marginRight:""}),$("body").data("overflow-hidden")||$("body").removeClass("overflow-hidden"),$("body").removeData("overflow-hidden"),$(PF.obj.modal.selectors.root).remove(),"function"==typeof e&&e()},PF.obj.config.animation.normal))}},PF.fn.popup=function(e){var t={height:e.height||500,width:e.width||650,scrollTo:0,resizable:0,scrollbars:0,location:0};t.top=screen.height/2-t.height/2,t.left=screen.width/2-t.width/2;var o="";for(var i in t)o+=i+"="+t[i]+",";o=o.slice(0,-1),window.open(e.href,"Popup",o)},PF.fn.list_fluid_width=function(){var e,t,o,i,n;$("body").is_fluid()&&(e=$(PF.obj.listing.selectors.content_listing_visible),t=$(PF.obj.listing.selectors.pad_content,e),i=(o=$(PF.obj.listing.selectors.list_item,e)).outerWidth(!0),n=o.outerWidth(!0)-o.width(),PF.obj.listing.content_listing_ratio=parseInt((e.width()+n)/i),o.length<PF.obj.listing.content_listing_ratio?t.css("width","100%"):(PF.fn.isDevice(["tablet","laptop","desktop"]),PF.obj.follow_scroll.$node.hasClass("position-fixed")&&PF.obj.follow_scroll.$node.width($(".content-width").first().width())))},PF.obj.tabs={hashdata:{}},PF.fn.show_tab=function(e){var t,o,i,n;void 0!==e&&(t=$("a[data-tab="+e+"]",".content-tabs"),$("li",t.closest("ul")).removeClass("current"),t.closest("li").addClass("current"),o=$("#tabbed-content-group"),$target=$("#"+t.data("tab")),$(".tabbed-content",o).removeClass("visible").hide(),$($target,o).addClass("visible").show(),$("[data-content=list-selection]").removeClass("visible").addClass("hidden"),$("[data-content=list-selection][data-tab="+t.data("tab")+"]").removeClass("hidden").addClass("visible"),o.exists()&&(i=$(PF.obj.listing.selectors.list_item+":not(.jsly)",$target),n=!$target.hasClass("jsly"),"ajax"!=$target.data("load")||"true"===$target.data("empty")||$(PF.obj.listing.selectors.list_item,$target).exists()?(PF.fn.listing.queryString.stock_current(),PF.fn.listing.columnizer(!1,0,!1),i[n?"fadeIn":"show"]()):(PF.fn.listing.queryString.stock_load(),$target.html(PF.obj.listing.template.fill),PF.fn.loading.inline($(PF.obj.listing.selectors.content_listing_loading,$target)),PF.fn.listing.queryString.stock_new(),PF.fn.listing.ajax())),PF.fn.listing.columnizerQueue(),1==$(PF.obj.listing.selectors.content_listing_visible).data("queued")&&PF.fn.listing.columnizer(!0,0))},PF.obj.listing={columns:"",columns_number:1,current_column:"",XHR:{},query_string:PF.fn.get_url_vars(),calling:!1,content_listing_ratio:1,selectors:{sort:".sort-listing .current [data-sort]",content_listing:".content-listing",content_listing_visible:".content-listing:visible",content_listing_loading:".content-listing-loading",content_listing_load_more:".content-listing-more",content_listing_pagination:".content-listing-pagination",empty_icon:".icon icon-drawer",pad_content:".pad-content-listing",list_item:".list-item"},template:{fill:$("[data-template=content-listing]").html(),empty:$("[data-template=content-listing-empty]").html(),loading:$("[data-template=content-listing-loading]").html()}},PF.fn.listing={},PF.fn.listing.show=function(s,r){$content_listing=$("#content-listing-tabs").exists()?$(PF.obj.listing.selectors.content_listing_visible,"#content-listing-tabs"):$(PF.obj.listing.selectors.content_listing),PF.fn.loading.inline(PF.obj.listing.selectors.content_listing_loading),$(PF.obj.listing.selectors.list_item+":not(.jsly)",$content_listing).each(function(){$(this).imagesLoaded(function(e){var t=PF.obj.listing.selectors.list_item,i=$(t+":visible",PF.obj.listing.selectors.content_listing_visible),o=$(e.elements);(void 0!==s&&$(s.html).length<PF.obj.config.listing.items_per_page||$(PF.obj.listing.selectors.list_item,$content_listing).length<PF.obj.config.listing.items_per_page)&&PF.fn.listing.removeLoader($content_listing),!$(PF.obj.listing.selectors.content_listing_pagination,$content_listing).is("[data-type=classic]")&&$("[data-action=load-more]",$content_listing).exists()||$(PF.obj.listing.selectors.content_listing_loading,$content_listing).remove(),0==i.length&&(o.show(),PF.fn.listing.columnizer(!1,0),PF.obj.listing.recolumnize=!0);PF.fn.listing.columnizer(PF.obj.listing.recolumnize,0,0==i.length),o.hide(),PF.obj.listing.recolumnize=!1,PF.fn.isDevice(["laptop","desktop"])?o.each(function(){$(this).show().find(".image-container").hide();var t=$.now(),e=$(this),o=$(".image-container",e);$(".image-container",this).imagesLoaded(function(){var e=$.now()-t;0!=i.length||e>PF.obj.config.animation.normal?o.fadeIn(PF.obj.config.animation.normal):o.show()})}):o.show(),PF.obj.listing.calling=!1;var n=$(PF.obj.listing.selectors.content_listing_loading,$content_listing).exists()&&$(PF.obj.listing.selectors.content_listing_loading,$content_listing).is_in_viewport();void 0===PF.obj.listing.show_load_more&&(PF.obj.listing.show_load_more=n),$(PF.obj.listing.selectors.content_listing_loading,$content_listing)[(n?"add":"remove")+"Class"]("visibility-hidden"),$(PF.obj.listing.selectors.content_listing_load_more,$content_listing)[PF.obj.listing.show_load_more?"show":"hide"]();var a=History.getState();a.data&&void 0!==a.data.scrollTop&&($(window).scrollTop(),a.data.scrollTop),"function"==typeof r&&r()})})},PF.fn.listing.removeLoader=function(o){var e=[PF.obj.listing.selectors.content_listing_load_more,PF.obj.listing.selectors.content_listing_loading];$(PF.obj.listing.selectors.content_listing_pagination,$content_listing).is("[data-type=endless]")&&e.push(PF.obj.listing.selectors.content_listing_pagination),$.each(e,function(e,t){$(t,o).remove()})},PF.fn.listing.queryString={stock_load:function(){var e=$(PF.obj.listing.selectors.content_listing_visible),t=PF.fn.deparam(e.data("params"));for(var o in PF.obj.listing.params_hidden=void 0!==e.data("params-hidden")?PF.fn.deparam(e.data("params-hidden")):null,void 0===PF.obj.listing.query_string.action&&(PF.obj.listing.query_string.action=e.data("action")||"list"),void 0===PF.obj.listing.query_string.list&&(PF.obj.listing.query_string.list=e.data("list")),void 0===PF.obj.listing.query_string.sort&&(void 0!==t&&void 0!==t.sort?PF.obj.listing.query_string.sort=t.sort:PF.obj.listing.query_string.sort=$(":visible"+PF.obj.listing.selectors.sort).data("sort")),void 0===PF.obj.listing.query_string.page&&(PF.obj.listing.query_string.page=1),e.data("page",PF.obj.listing.query_string.page),$(PF.obj.listing.selectors.content_listing+"[data-load=ajax]").each(function(){var e=$("[data-tab="+$(this).attr("id")+"]"+PF.obj.listing.selectors.sort),t=PF.fn.deparam($(this).data("params")),o=PF.fn.deparam($(this).data("params-hidden")),i={q:t&&t.q?t.q:null,list:$(this).data("list"),sort:e.exists()?e.data("sort"):t&&t.sort?t.sort:null,page:t&&t.page?t.page:1};for(var n in o&&o.list&&delete i.list,i)i[n]||delete i[n]}),t)0==/action|list|sort|page/.test(o)&&(PF.obj.listing.query_string[o]=t[o]);if(void 0!==PF.obj.listing.params_hidden){for(var o in PF.obj.listing.params_hidden)0==/action|list|sort|page/.test(o)&&(PF.obj.listing.query_string[o]=PF.obj.listing.params_hidden[o]);PF.obj.listing.query_string.params_hidden=PF.obj.listing.params_hidden}},stock_new:function(){var e=$(PF.obj.listing.selectors.content_listing_visible),t=PF.fn.deparam(e.data("params"));e.data("offset")?PF.obj.listing.query_string.offset=e.data("offset"):delete PF.obj.listing.query_string.offset,PF.obj.listing.query_string.action=e.data("action")||"list",PF.obj.listing.query_string.list=e.data("list"),void 0!==t&&void 0!==t.sort?PF.obj.listing.query_string.sort=t.sort:PF.obj.listing.query_string.sort=$(":visible"+PF.obj.listing.selectors.sort).data("sort"),PF.obj.listing.query_string.page=1},stock_current:function(){this.stock_new(),PF.obj.listing.query_string.page=$(PF.obj.listing.selectors.content_listing_visible).data("page")}},PF.fn.listing.queryString.stock_load(),PF.fn.listing.ajax=function(){var l,d,c;1!=PF.obj.listing.calling&&(PF.obj.listing.calling=!0,l=$(PF.obj.listing.selectors.content_listing_visible),d=$(PF.obj.listing.selectors.pad_content,l),(c=$(PF.obj.listing.selectors.content_listing_load_more,l)).hide(),$(PF.obj.listing.selectors.content_listing_loading,l).removeClass("visibility-hidden").show(),PF.obj.listing.XHR=$.ajax({type:"POST",data:$.param($.extend({},PF.obj.listing.query_string,$.ajaxSettings.data))}).complete(function(e){function t(){$(PF.obj.listing.selectors.content_listing_loading+","+PF.obj.listing.selectors.content_listing_pagination+":not([data-visibility=visible])",l).remove()}function o(){l.data("empty","true").html(PF.obj.listing.template.empty),$("[data-content=list-selection][data-tab="+l.attr("id")+"]").addClass("disabled")}var i,n=e.responseJSON;if(4==e.readyState&&void 0!==n){if($("[data-content=list-selection][data-tab="+l.attr("id")+"]").removeClass("disabled"),200!==e.status&&(i=void 0!==n.error&&void 0!==n.error.message?n.error.message:"Bad request",PF.fn.growl.call("Error: "+i),l.data("load","")),void 0!==n.html&&""!=n.html||0!=$(PF.obj.listing.selectors.list_item,l).length||o(),void 0===n.html||""==n.html)return t(),PF.obj.listing.calling=!1,void("function"==typeof PF.fn.listing_end&&PF.fn.listing_end());l.data({load:"",page:PF.obj.listing.query_string.page});var a,s=$.extend({},PF.obj.listing.query_string);for(var r in PF.obj.listing.params_hidden)void 0!==s[r]&&delete s[r];for(var r in delete s.action,s)s[r]||delete s[r];-1==document.URL.indexOf("?"+$.param(s))&&(a=(a=window.location.href).split("?")[0].replace(/\/$/,"")+"?"+$.param(s),window.location.hash&&(a=a.replace(window.location.hash,"")),History.pushState({pushed:"pagination",scrollTop:$(window).scrollTop()},document.title,a)),$("a[data-tab="+l.attr("id")+"]").attr("href",document.URL),d.append(n.html),$("[data-action=load-more]",c).attr("data-seek",n.seekEnd),PF.fn.listing.show(n,function(){$(PF.obj.listing.selectors.content_listing_loading,l).addClass("visibility-hidden")})}else PF.obj.listing.calling=!1,l.data("load",""),t(),0==$(PF.obj.listing.selectors.list_item,l).length&&o(),0!==e.readyState&&PF.fn.growl.call(PF.fn._s("An error occurred. Please try again later."));"function"==typeof PF.fn.listing.ajax.callback&&PF.fn.listing.ajax.callback(e)}))},PF.fn.listing.columnizerQueue=function(){$(PF.obj.listing.selectors.content_listing+":hidden").data("queued",!0)},PF.fn.listing.refresh=function(e){PF.fn.listing.columnizer(!0,e,!1),$(PF.obj.listing.selectors.list_item).show()};var width=$(window).width();function sprintf(){function $(e,t,o,i){o=o||" ";var n=e.length>=t?"":new Array(1+t-e.length>>>0).join(o);return i?e+n:n+e}function w(e,t,o,i,n,a){var s=i-e.length;return 0<s&&(e=o||!n?$(e,i,a,o):e.slice(0,t.length)+$("",s,"0",!0)+e.slice(t.length)),e}function y(e,t,o,i,n,a,s){var r=e>>>0;return e=(o=o&&r&&{2:"0b",8:"0",16:"0x"}[t]||"")+$(r.toString(t),a||0,"0",!1),w(e,o,i,n,s)}function _(e,t,o,i,n,a){return null!=i&&(e=e.slice(0,i)),w(e,"",t,o,n,a)}var P=arguments,F=0,e=P[F++];return e.replace(/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,function(e,t,o,i,n,a,s){var r,l,d,c,u;if("%%"===e)return"%";for(var f=!1,h="",p=!1,m=!1,g=" ",b=o.length,v=0;o&&v<b;v++)switch(o.charAt(v)){case" ":h=" ";break;case"+":h="+";break;case"-":f=!0;break;case"'":g=o.charAt(v+1);break;case"0":p=!0,g="0";break;case"#":m=!0}if((i=i?"*"===i?+P[F++]:"*"==i.charAt(0)?+P[i.slice(1,-1)]:+i:0)<0&&(i=-i,f=!0),!isFinite(i))throw new Error("sprintf: (minimum-)width must be finite");switch(a=a?"*"===a?+P[F++]:"*"==a.charAt(0)?+P[a.slice(1,-1)]:+a:-1<"fFeE".indexOf(s)?6:"d"===s?0:void 0,u=t?P[t.slice(0,-1)]:P[F++],s){case"s":return _(String(u),f,i,a,p,g);case"c":return _(String.fromCharCode(+u),f,i,a,p);case"b":return y(u,2,m,f,i,a,p);case"o":return y(u,8,m,f,i,a,p);case"x":return y(u,16,m,f,i,a,p);case"X":return y(u,16,m,f,i,a,p).toUpperCase();case"u":return y(u,10,m,f,i,a,p);case"i":case"d":return r=+u||0,u=(l=(r=Math.round(r-r%1))<0?"-":h)+$(String(Math.abs(r)),a,"0",!1),w(u,l,f,i,p);case"e":case"E":case"f":case"F":case"g":case"G":return l=(r=+u)<0?"-":h,d=["toExponential","toFixed","toPrecision"]["efg".indexOf(s.toLowerCase())],c=["toString","toUpperCase"]["eEfFgG".indexOf(s)%2],u=l+Math.abs(r)[d](a),w(u,l,f,i,p)[c]();default:return e}})}function testPassword(e){var t,o=0,i="weak",n="";return e.length<5?(o+=3,n=n+"3 points for length ("+e.length+")\n"):4<e.length&&e.length<8?(o+=6,n=n+"6 points for length ("+e.length+")\n"):7<e.length&&e.length<16?(o+=12,n=n+"12 points for length ("+e.length+")\n"):15<e.length&&(o+=18,n=n+"18 point for length ("+e.length+")\n"),e.match(/[a-z]/)&&(o+=1,n+="1 point for at least one lower case char\n"),e.match(/[A-Z]/)&&(o+=5,n+="5 points for at least one upper case char\n"),e.match(/\d+/)&&(o+=5,n+="5 points for at least one number\n"),e.match(/(.*[0-9].*[0-9].*[0-9])/)&&(o+=5,n+="5 points for at least three numbers\n"),e.match(/.[!,@,#,$,%,^,&,*,?,_,~]/)&&(o+=5,n+="5 points for at least one special char\n"),e.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)&&(o+=5,n+="5 points for at least two special chars\n"),e.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(o+=2,n+="2 combo points for upper and lower letters\n"),e.match(/([a-zA-Z])/)&&e.match(/([0-9])/)&&(o+=2,n+="2 combo points for letters and numbers\n"),e.match(/([a-zA-Z0-9].*[!,@,#,$,%,^,&,*,?,_,~])|([!,@,#,$,%,^,&,*,?,_,~].*[a-zA-Z0-9])/)&&(o+=2,n+="2 combo points for letters, numbers and special chars\n"),0==e.length&&(o=0),i=o<16?"very weak":15<o&&o<25?"weak":24<o&&o<35?"average":34<o&&o<45?"strong":"stronger",{score:o,ratio:t=Math.round(Math.min(100,100*o/45))/100,percent:100*t+"%",verdict:i,log:n}}function changeEmbed(e){setCookie("USER_SELECTED_EMBED",e,2592e3)}function changeLanguage(e){setCookie("USER_SELECTED_LANG",e,2592e3)}function setCookie(e,t,o){var i=new Date;i.setTime(i.getTime()+1e3*o),document.cookie=e+"="+t+"; expires="+i.toGMTString()+"; path=/; domain=imgbb.com"}function getCookie(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}PF.fn.listing.columnizer=function(e,x,j){var t,o={phone:1,phablet:3,tablet:4,laptop:5,desktop:6,largescreen:6};"boolean"!=typeof e&&(e=!1),void 0===PF.obj.listing.mode&&(e=!0),t="boolean"!=typeof j&&!(j=!1),!j&&t&&(width===$(window).width()&&!e||(j=!0)),void 0===x&&(x=PF.obj.config.animation.normal);var C=$("#content-listing-tabs").exists()?$(PF.obj.listing.selectors.content_listing_visible,"#content-listing-tabs"):$(PF.obj.listing.selectors.content_listing),n=$(PF.obj.listing.selectors.pad_content,C),S=$(e||j?PF.obj.listing.selectors.list_item:PF.obj.listing.selectors.list_item+":not(.jsly)",C);if(C.addClass("jsly"),C.data("device-columns")&&(o=$.extend({},o,C.data("device-columns"))),PF.obj.listing.mode="responsive",PF.obj.listing.device=PF.fn.getDeviceName(),S.exists()){if(void 0===C.data("columns")||e||j){for(S.first().css("width",""),PF.obj.listing.columns=new Array,PF.obj.listing.columns_number=o[PF.fn.getDeviceName()],i=0;i<PF.obj.listing.columns_number;i++)PF.obj.listing.columns[i+1]=0;PF.obj.listing.current_column=1}else PF.obj.listing.columns=C.data("columns"),PF.obj.listing.columns_number=C.data("columns").length-1,PF.obj.listing.current_column=C.data("current_column");var a=1==PF.obj.listing.columns_number?"-10px":"";$("#tabbed-content-group").css({marginLeft:a,marginRight:a}),C.removeClass("small-cols").addClass(6<PF.obj.listing.columns_number?"small-cols":""),n.css("width","100%");var H=0;S.each(function(e){$(this).addClass("jsly");var t=$(".list-item-image",this),o=$(".list-item-image img",this),i=$(".list-item-thumbs",this),n=o.hasClass("jsly-loaded");o.show(),j&&($(this).css({top:"",left:"",height:"",position:""}),t.css({maxHeight:"",height:""}),o.removeClass("jsly").css({width:"",height:""}).parent().css({marginLeft:"",marginTop:""}),$("li",i).css({width:"",height:""}));var a,s=1==PF.obj.listing.columns_number?"100%":parseInt(1/PF.obj.listing.columns_number*(C.width()-10*(PF.obj.listing.columns_number-1))+"px");$(this).css("width",s),PF.obj.listing.current_column>PF.obj.listing.columns_number&&(PF.obj.listing.current_column=1),$(this).attr("data-col",PF.obj.listing.current_column),o.exists()||(a=!0,o=$(".image-container .empty",this));var r=$(this).is(":visible");S.show();var l,d,c,u,f,h,p,m,g,b,v=t.hasClass("fixed-size"),w={w:parseInt(o.attr("width")),h:parseInt(o.attr("height"))};if(w.ratio=w.w/w.h,j&&1<PF.obj.listing.columns_number?(o.css({width:"auto",height:"auto"}),$(".image-container:not(.list-item-avatar-cover)",this).css({width:"",height:"auto"})):w.w>C.width()&&($(".image-container:not(.list-item-avatar-cover)",this).css(w.ratio<1?{maxWidth:"100%",height:"auto"}:{height:"100%",width:"auto"}),o.css(w.ratio<1?{maxWidth:"100%",height:"auto"}:{height:"100%",width:"auto"})),(a||t.css("min-height")&&!o.hasClass("jsly"))&&(parseInt(t.css("height")),l={w:$(this).width(),h:v?$(this).width():null},d=Math.min(w.w,w.w<l.w?w.w:l.w),v?(t.css({height:l.w}),w.ratio<=3&&(1<w.ratio||1==w.ratio)?(w.h=Math.min(w.h,w.w<l.w?w.w:l.w),w.w=w.h*w.ratio):(w.w=d,w.h=w.w/w.ratio),parseInt(t.css("min-height")),t.css("min-height",0)):(w.w=d,3<=w.ratio||w.ratio<1||1==w.ratio?w.h=w.w/w.ratio:(w.h=Math.min(w.h,w.w),w.w=w.h*w.ratio),a&&(w.h=l.w),t.css({height:w.h})),o.css({width:w.w,height:w.h}),0==o.width()&&o.css({width:d,height:d/w.ratio}),$(".image-container",this).is(".list-item-avatar-cover")&&o.css(v?{width:"auto",height:"100%"}:{width:"100%",height:"auto"}),0!==o.height()&&(t.height()>o.height()||v)&&o.parent().css({marginTop:(t.outerHeight()-o.height())/2}),t.width()<o.width()&&o.parent().css({marginLeft:-(o.outerWidth()-t.width())/2+"px"}),c=Math.max(2*o.position().left,0),u=Math.max(2*o.position().top,0),6<PF.obj.listing.columns_number&&(0<c||0<u)&&(f=c/t.width(),h=u/t.height(),p={},f<=.25&&h<=.25&&(h<f?(p.width=c+t.width(),p.height=p.width/w.ratio):(p.height=u+o.height(),p.width=p.height*w.ratio),o.css(p),o.parent().css({marginLeft:-(o.width()-t.width())/2,marginTop:0}))),i.exists()&&$("li",i).css({width:100/$("li",i).length+"%"}).css({height:$("li",i).width()}),r||S.hide()),!o.hasClass("jsly")&&$(this).is(":hidden")&&$(this).css("top","100%"),PF.obj.listing.columns[PF.obj.listing.current_column]+=$(this).outerHeight(!0),1==PF.obj.listing.columns_number?$(this).removeClass("position-absolute"):($(this).is(":animated")&&(x=0),$(this).addClass("position-absolute"),m=$(this).outerWidth(!0)*(PF.obj.listing.current_column-1),(g=parseInt($(this).css("left"))!=m)&&(animate_grid=!0,$(this).animate({left:m},x)),b=PF.obj.listing.columns[PF.obj.listing.current_column]-$(this).outerHeight(!0),parseInt($(this).css("top"))!=b&&(animate_grid=!0,$(this).animate({top:b},x),g&&(H=1))),r&&S.show(),n||o.addClass("jsly").hide().imagesLoaded(function(e){$(e.elements).show().addClass("jsly-loaded")}),v)PF.obj.listing.current_column++;else{for(var y,_,P,F=1;F<=PF.obj.listing.columns_number;F++){if(P=PF.obj.listing.columns[F],void 0===_&&(_=P,y=F),0==PF.obj.listing.columns[F]){y=F;break}P<_&&(_=PF.obj.listing.columns[F],y=F)}PF.obj.listing.current_column=y}}),C.data({columns:PF.obj.listing.columns,current_column:PF.obj.listing.current_column});var s,r=0;$.each(PF.obj.listing.columns,function(e,t){r<t&&(r=t)}),10<r&&(r-=10),PF.obj.listing.width=C.width(),void 0!==PF.obj.listing.height&&(s=PF.obj.listing.height),PF.obj.listing.height=r;var l=void 0!==s&&s!==PF.obj.listing.height;l||(n.height(r),PF.fn.list_fluid_width()),l&&(n.height(s),setTimeout(function(){n.animate({height:r},x,function(){PF.fn.list_fluid_width()})},x*H)),C.data("list-mode",PF.obj.listing.mode),$(PF.obj.listing.selectors.content_listing_visible).data("queued",!1)}},PF.fn.loading={spin:{small:{lines:11,length:0,width:3,radius:7,speed:1,trail:45,blocksize:20},normal:{lines:11,length:0,width:5,radius:10,speed:1,trail:45,blocksize:30},big:{lines:11,length:0,width:7,radius:13,speed:1,trail:45,blocksize:40},huge:{lines:11,length:0,width:9,radius:16,speed:1,trail:45,blocksize:50}},inline:function(e,t){if(void 0!==e){e instanceof jQuery==0&&(e=$(e));var o={size:"normal",color:$("body").css("color"),center:!1,position:"absolute",shadow:!1,valign:"top"};if(void 0===t)t=o;else for(var i in o)void 0===t[i]&&(t[i]=o[i]);PF.fn.loading.spin[t.size];PF.fn.loading.spin[t.size].color=t.color,PF.fn.loading.spin[t.size].shadow=t.shadow,e.html('<span class="loading-indicator"></span>'+(void 0!==t.message?'<span class="loading-text">'+t.message+"</span>":"")).css({"line-height":PF.fn.loading.spin[t.size].blocksize+"px"}),$(".loading-indicator",e).css({width:PF.fn.loading.spin[t.size].blocksize,height:PF.fn.loading.spin[t.size].blocksize}).spin(PF.fn.loading.spin[t.size]),t.center&&$(".loading-indicator",e.css("textAlign","center")).css({position:t.position,top:"50%",left:"50%",marginTop:-PF.fn.loading.spin[t.size].blocksize/2,marginLeft:-PF.fn.loading.spin[t.size].blocksize/2}),"center"==t.valign&&$(".loading-indicator,.loading-text",e).css("marginTop",(e.height()-PF.fn.loading.spin[t.size].blocksize)/2+"px"),$(".spinner",e).css({top:PF.fn.loading.spin[t.size].blocksize/2+"px",left:PF.fn.loading.spin[t.size].blocksize/2+"px"})}},fullscreen:function(){$("body").append('<div class="fullscreen" id="pf-fullscreen-loader"><div class="fullscreen-loader black-bkg"><span class="loading-txt">'+PF.fn._s("loading")+"</span></div></div>"),$(".fullscreen-loader","#pf-fullscreen-loader").spin(PF.fn.loading.spin.huge),$(".spinner","#pf-fullscreen-loader").css({top:"50%",left:"50%"}),$("#pf-fullscreen-loader").css("opacity",1)},destroy:function(e){var t=$("#pf-fullscreen-loader"),o=$("#pf-onscreen-loader");"fullscreen"==e&&(e=t),"onscreen"==e&&(e=o),void 0!==e?e.remove():(t.remove(),o.remove())}},jQuery.fn.disableForm=function(){return $(this).data("disabled",!0),$(":input",this).each(function(){$(this).attr("disabled",!0)}),this},jQuery.fn.enableForm=function(){return $(this).data("disabled",!1),$(":input",this).removeAttr("disabled"),this},PF.obj.follow_scroll={Y:0,y:0,$node:$(".follow-scroll"),node_h:0,base_h:$(".follow-scroll").outerHeight(),set:function(e){e&&(PF.obj.follow_scroll.base_h=$(".follow-scroll").outerHeight());var t=PF.obj.follow_scroll.$node.closest(".follow-scroll-wrapper").exists();t&&PF.obj.follow_scroll.$node.closest(".follow-scroll-wrapper").css("position","static"),PF.obj.follow_scroll.y=PF.obj.follow_scroll.$node.exists()?PF.obj.follow_scroll.$node.offset().top:null,PF.obj.follow_scroll.node_h=PF.obj.follow_scroll.$node.outerHeight(),t&&PF.obj.follow_scroll.$node.closest(".follow-scroll-wrapper").css("position","")},checkDocumentHeight:function(){var t,o=document.body.clientHeight;!function e(){t=document.body.clientHeight,o!=t&&PF.obj.follow_scroll.set(),o=t,setTimeout(e,200)}()}},PF.obj.follow_scroll.set(),PF.obj.follow_scroll.process=function(e){var t,o,i,n;e&&(PF.obj.follow_scroll.node_h=PF.obj.follow_scroll.base_h),PF.obj.follow_scroll.$node.exists()&&(PF.obj.follow_scroll.$node.closest("[data-content=follow-scroll-parent]").exists()||PF.obj.follow_scroll.$node.closest(".content-width"),t=PF.obj.follow_scroll.$node.closest(".follow-scroll-wrapper"),o=PF.obj.follow_scroll.node_h,i=$(window).scrollTop()>PF.obj.follow_scroll.y-o,"fixed"!==$("#top-bar").css("position")&&(PF.obj.follow_scroll.Y-=$(window).scrollTop(),PF.obj.follow_scroll.Y<0&&(PF.obj.follow_scroll.Y=0),i=i&&$(window).scrollTop()>PF.obj.follow_scroll.y),i&&t.hasClass("position-fixed")||!i&&!t.hasClass("position-fixed")||(t.exists()||(PF.obj.follow_scroll.$node.wrapAll('<div class="follow-scroll-wrapper" />'),t=PF.obj.follow_scroll.$node.closest(".follow-scroll-wrapper")),t.css("min-height",PF.obj.follow_scroll.node_h),PF.obj.follow_scroll.Y=$("#top-bar").outerHeight(!0)+parseFloat($("#top-bar").css("top"))-.5,i?(n=PF.obj.follow_scroll.node_h,t.addClass("position-fixed").css({top:PF.obj.follow_scroll.Y}),t.next().is(".follow-scroll-placeholder")?t.parent().find(".follow-scroll-placeholder").css("min-height",n).show():t.after($('<div class="follow-scroll-placeholder" />').css("min-height",n))):(t.removeClass("position-fixed").css({top:"",width:"",minHeight:""}),t.parent().find(".follow-scroll-placeholder").hide()),$("[data-show-on=follow-scroll]")[(i?"remove":"add")+"Class"]("hidden soft-hidden"),$("html").data("top-bar-box-shadow-prevent")||$("html")[(i?"add":"remove")+"Class"]("top-bar-box-shadow-none"),PF.obj.follow_scroll.$node[(i?"add":"remove")+"Class"]("content-width")))},PF.fn.isDevice=function(e){return e="object"==typeof e?"."+e.join(",."):"."+e,$("html").is(e)},PF.fn.getDeviceName=function(){var o;return $.each(PF.obj.devices,function(e,t){if(PF.fn.isDevice(t))return o=t,!0}),o},PF.fn.topMenu={vars:{$button:$("[data-action=top-bar-menu-full]","#top-bar"),menu:"#menu-fullscreen",speed:PF.obj.config.animation.fast,menu_top:parseInt($("#top-bar").outerHeight())+parseInt($("#top-bar").css("top"))+parseInt($("#top-bar").css("margin-top"))+parseInt($("#top-bar").css("margin-bottom"))-parseInt($("#top-bar").css("border-bottom-width"))+"px"},show:function(e){var t;$("body").is(":animated")||(void 0===e&&(e=this.vars.speed),this.vars.$button.addClass("current"),$("#top-bar").css("position","fixed").append($("<div/>",{id:"menu-fullscreen",class:"touch-scroll",html:$("<ul/>",{html:$(".top-bar-left").html()+$(".top-bar-right").html()})}).css({borderTopWidth:this.vars.menu_top,left:"-100%"})),t=$(this.vars.menu),$("li.phone-hide, li > .top-btn-text, li > .top-btn-text > span, li > a > .top-btn-text > span",t).each(function(){$(this).removeClass("phone-hide")}),$("[data-action=top-bar-menu-full]",t).remove(),$(".btn.black, .btn.default, .btn.blue, .btn.green, .btn.orange, .btn.red, .btn.transparent",t).removeClass("btn black default blue green orange red transparent"),setTimeout(function(){t.css({transform:"translate(100%, 0)"})},1),setTimeout(function(){$("html").css({backgroundColor:""})},this.vars.speed))},hide:function(e){var t;$("body").is(":animated")||$(this.vars.menu).is(":visible")&&(void 0===e&&(e=this.vars.speed),$("#top-bar").css("position",""),this.vars.$button.removeClass("current"),$("html").removeClass("menu-fullscreen-visible"),(t=$(this.vars.menu)).css({transform:"none"}),setTimeout(function(){t.remove()},e))}},function(e,t){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",t):"object"==typeof module&&module.exports?module.exports=t():e.EvEmitter=t()}("undefined"!=typeof window?window:this,function(){function e(){}var t=e.prototype;return t.on=function(e,t){if(e&&t){var o=this._events=this._events||{},i=o[e]=o[e]||[];return-1==i.indexOf(t)&&i.push(t),this}},t.once=function(e,t){if(e&&t){this.on(e,t);var o=this._onceEvents=this._onceEvents||{};return(o[e]=o[e]||{})[t]=!0,this}},t.off=function(e,t){var o=this._events&&this._events[e];if(o&&o.length){var i=o.indexOf(t);return-1!=i&&o.splice(i,1),this}},t.emitEvent=function(e,t){var o=this._events&&this._events[e];if(o&&o.length){var i=0,n=o[i];t=t||[];for(var a=this._onceEvents&&this._onceEvents[e];n;){var s=a&&a[n];s&&(this.off(e,n),delete a[n]),n.apply(this,t),n=o[i+=s?0:1]}return this}},t.allOff=t.removeAllListeners=function(){delete this._events,delete this._onceEvents},e}),function(t,o){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(e){return o(t,e)}):"object"==typeof module&&module.exports?module.exports=o(t,require("ev-emitter")):t.imagesLoaded=o(t,t.EvEmitter)}("undefined"!=typeof window?window:this,function(t,e){function i(e,t){for(var o in t)e[o]=t[o];return e}function n(e,t,o){return this instanceof n?("string"==typeof e&&(e=document.querySelectorAll(e)),this.elements=function(e){var t=[];if(Array.isArray(e))t=e;else if("number"==typeof e.length)for(var o=0;o<e.length;o++)t.push(e[o]);else t.push(e);return t}(e),this.options=i({},this.options),"function"==typeof t?o=t:i(this.options,t),o&&this.on("always",o),this.getImages(),s&&(this.jqDeferred=new s.Deferred),void setTimeout(function(){this.check()}.bind(this))):new n(e,t,o)}function o(e){this.img=e}function a(e,t){this.url=e,this.element=t,this.img=new Image}var s=t.jQuery,r=t.console;(n.prototype=Object.create(e.prototype)).options={},n.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},n.prototype.addElementImages=function(e){"IMG"==e.nodeName&&this.addImage(e),!0===this.options.background&&this.addElementBackgroundImages(e);var t=e.nodeType;if(t&&l[t]){for(var o=e.querySelectorAll("img"),i=0;i<o.length;i++){var n=o[i];this.addImage(n)}if("string"==typeof this.options.background)for(var a=e.querySelectorAll(this.options.background),i=0;i<a.length;i++){var s=a[i];this.addElementBackgroundImages(s)}}};var l={1:!0,9:!0,11:!0};return n.prototype.addElementBackgroundImages=function(e){var t=getComputedStyle(e);if(t)for(var o=/url\((['"])?(.*?)\1\)/gi,i=o.exec(t.backgroundImage);null!==i;){var n=i&&i[2];n&&this.addBackground(n,e),i=o.exec(t.backgroundImage)}},n.prototype.addImage=function(e){var t=new o(e);this.images.push(t)},n.prototype.addBackground=function(e,t){var o=new a(e,t);this.images.push(o)},n.prototype.check=function(){function t(e,t,o){setTimeout(function(){i.progress(e,t,o)})}var i=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(e){e.once("progress",t),e.check()}):void this.complete()},n.prototype.progress=function(e,t,o){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded,this.emitEvent("progress",[this,e,t]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,e),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&r&&r.log("progress: "+o,e,t)},n.prototype.complete=function(){var e,t=this.hasAnyBroken?"fail":"done";this.isComplete=!0,this.emitEvent(t,[this]),this.emitEvent("always",[this]),this.jqDeferred&&(e=this.hasAnyBroken?"reject":"resolve",this.jqDeferred[e](this))},(o.prototype=Object.create(e.prototype)).check=function(){return this.getIsImageComplete()?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},o.prototype.getIsImageComplete=function(){return this.img.complete&&void 0!==this.img.naturalWidth},o.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.img,t])},o.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},o.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},o.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},o.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},(a.prototype=Object.create(o.prototype)).check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url,this.getIsImageComplete()&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},a.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},a.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.element,t])},(n.makeJQueryPlugin=function(e){(e=e||t.jQuery)&&((s=e).fn.imagesLoaded=function(e,t){return new n(this,e,t).jqDeferred.promise(s(this))})})(),n}),function(x){x.fn.tipTip=function(i){var _,P,F,n={activation:"hover",keepAlive:!1,maxWidth:"200px",edgeOffset:6,defaultPosition:"bottom",delay:400,fadeIn:200,fadeOut:200,attribute:"title",content:!1,enter:function(){},afterEnter:function(){},exit:function(){},afterExit:function(){},cssClass:""};return x("#tiptip_holder").length<=0?(_=x('<div id="tiptip_holder"></div>'),P=x('<div id="tiptip_content"></div>'),F=x('<div id="tiptip_arrow"></div>'),x("body").append(_.html(P).prepend(F.html('<div id="tiptip_arrow_inner"></div>')))):(_=x("#tiptip_holder"),P=x("#tiptip_content"),F=x("#tiptip_arrow")),this.each(function(){var v=x(this),e=v.data("tipTip"),$=e&&e.options||x.extend(n,i),w={holder:_,content:P,arrow:F,options:$};if(e)switch(i){case"show":t();break;case"hide":o();break;case"destroy":v.unbind(".tipTip").removeData("tipTip")}else{var y=!1;v.data("tipTip",{options:$}),"hover"==$.activation?v.bind("mouseenter.tipTip",function(){t()}).bind("mouseleave.tipTip",function(){$.keepAlive?_.one("mouseleave.tipTip",function(){o()}):o()}):"focus"==$.activation?v.bind("focus.tipTip",function(){t()}).bind("blur.tipTip",function(){o()}):"click"==$.activation?v.bind("click.tipTip",function(e){return e.preventDefault(),t(),!1}).bind("mouseleave.tipTip",function(){$.keepAlive?_.one("mouseleave.tipTip",function(){o()}):o()}):$.activation}function t(){var e,t,o,i,n,a,s,r,l,d,c,u,f,h,p,m,g,b;!1!==$.enter.call(v,w)&&($.content?e=x.isFunction($.content)?$.content.call(v,w):$.content:(e=$.content=v.attr($.attribute),v.removeAttr($.attribute)),e&&(P.html(e),_.hide().removeAttr("class").css({margin:"0px","max-width":$.maxWidth}),$.cssClass&&_.addClass($.cssClass),F.removeAttr("style"),t=parseInt(v.offset().top),o=parseInt(v.offset().left),i=parseInt(v.outerWidth()),n=parseInt(v.outerHeight()),a=_.outerWidth(),s=_.outerHeight(),r=Math.round((i-a)/2),l=Math.round((n-s)/2),d=Math.round(o+r),c=Math.round(t+n+$.edgeOffset),f=u="",h=Math.round(a-12)/2,"bottom"==$.defaultPosition?u="_bottom":"top"==$.defaultPosition?u="_top":"left"==$.defaultPosition?u="_left":"right"==$.defaultPosition&&(u="_right"),p=r+o<parseInt(x(window).scrollLeft()),m=a+o>parseInt(x(window).width()),p&&r<0||"_right"==u&&!m||"_left"==u&&o<a+$.edgeOffset+5?(u="_right",f=Math.round(s-13)/2,h=-12,d=Math.round(o+i+$.edgeOffset),c=Math.round(t+l)):(m&&r<0||"_left"==u&&!p)&&(u="_left",f=Math.round(s-13)/2,h=Math.round(a),d=Math.round(o-(a+$.edgeOffset+5)),c=Math.round(t+l)),g=t+n+$.edgeOffset+s+8>parseInt(x(window).height()+x(window).scrollTop()),b=t+n-($.edgeOffset+s+8)<0,g||"_bottom"==u&&g||"_top"==u&&!b?("_top"==u||"_bottom"==u?u="_top":u+="_top",f=s,c=Math.round(t-(s+5+$.edgeOffset))):(b|("_top"==u&&b)||"_bottom"==u&&!g)&&("_top"==u||"_bottom"==u?u="_bottom":u+="_bottom",f=-12,c=Math.round(t+n+$.edgeOffset)),"_right_top"==u||"_left_top"==u?c+=5:"_right_bottom"!=u&&"_left_bottom"!=u||(c-=5),"_left_top"!=u&&"_left_bottom"!=u||(d+=5),F.css({"margin-left":h+"px","margin-top":f+"px"}),_.css({"margin-left":d+"px","margin-top":c+"px"}).addClass("tip"+u),y&&clearTimeout(y),y=setTimeout(function(){_.stop(!0,!0).fadeIn($.fadeIn)},$.delay),$.afterEnter.call(v,w)))}function o(){!1!==$.exit.call(v,w)&&(y&&clearTimeout(y),_.fadeOut($.fadeOut),$.afterExit.call(v,w))}})}}(jQuery),function(e){"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],e):e(jQuery)}(function(ne){var ae="left",se="right",re="up",le="down",de="in",ce="out",ue="none",fe="auto",he="swipe",pe="pinch",me="tap",ge="doubletap",be="longtap",ve="horizontal",$e="vertical",we="all",ye=10,_e="start",Pe="move",Fe="end",xe="cancel",je="ontouchstart"in window,Ce="TouchSwipe";function i(e,b){var t=je||!b.fallbackToMouseEvents,o=t?"touchstart":"mousedown",i=t?"touchmove":"mousemove",n=t?"touchend":"mouseup",a=t?null:"mouseleave",s="touchcancel",v=0,$=null,w=0,y=0,_=0,P=1,F=0,x=0,j=null,r=ne(e),C="start",S=0,H=null,l=0,k=0,d=0,c=0,u=0,f=null;try{r.bind(o,h),r.bind(s,g)}catch(e){ne.error("events not supported "+o+","+s+" on jQuery.swipe")}function h(e){if(!0!==r.data(Ce+"_intouch")&&!(0<ne(e.target).closest(b.excludedElements,r).length)){var t,o,i=e.originalEvent?e.originalEvent:e,n=je?i.touches[0]:i;return(C=_e,je?S=i.touches.length:e.preventDefault(),x=$=null,P=1,F=_=y=w=v=0,H=function(){for(var e=[],t=0;t<=5;t++)e.push({start:{x:0,y:0},end:{x:0,y:0},identifier:0});return e}(),(o={})[ae]=ee(ae),o[se]=ee(se),o[re]=ee(re),o[le]=ee(le),j=o,G(),!je||S===b.fingers||b.fingers===we||M()?(Y(0,n),l=ie(),2==S&&(Y(1,i.touches[1]),y=_=oe(H[0].start,H[1].start)),(b.swipeStatus||b.pinchStatus)&&(t=E(i,C))):t=!1,!1===t)?(E(i,C=xe),t):(X(!0),null)}}function p(e){var t,o,i,n,a,s,r,l,d,c,u,f,h,p,m,g=e.originalEvent?e.originalEvent:e;C===Fe||C===xe||J()||(o=Z(je?g.touches[0]:g),k=ie(),je&&(S=g.touches.length),C=Pe,2==S&&(0==y?(Y(1,g.touches[1]),y=_=oe(H[0].start,H[1].start)):(Z(g.touches[1]),_=oe(H[0].end,H[1].end),H[0].end,H[1].end,x=P<1?ce:de),P=(_/y*1).toFixed(2),F=Math.abs(y-_)),S===b.fingers||b.fingers===we||!je||M()?(h=o.start,p=o.end,m=function(e,t){var o=e.x-t.x,i=t.y-e.y,n=Math.atan2(i,o),a=Math.round(180*n/Math.PI);a<0&&(a=360-Math.abs(a));return a}(h,p),function(e,t){if(b.allowPageScroll===ue||M())e.preventDefault();else{var o=b.allowPageScroll===fe;switch(t){case ae:(b.swipeLeft&&o||!o&&b.allowPageScroll!=ve)&&e.preventDefault();break;case se:(b.swipeRight&&o||!o&&b.allowPageScroll!=ve)&&e.preventDefault();break;case re:(b.swipeUp&&o||!o&&b.allowPageScroll!=$e)&&e.preventDefault();break;case le:(b.swipeDown&&o||!o&&b.allowPageScroll!=$e)&&e.preventDefault()}}}(e,$=m<=45&&0<=m||m<=360&&315<=m?ae:135<=m&&m<=225?se:45<m&&m<135?le:re),u=o.start,f=o.end,v=Math.round(Math.sqrt(Math.pow(f.x-u.x,2)+Math.pow(f.y-u.y,2))),w=te(),d=$,c=v,c=Math.max(c,K(d)),j[d].distance=c,(b.swipeStatus||b.pinchStatus)&&(t=E(g,C)),b.triggerOnTouchEnd&&!b.triggerOnTouchLeave||(i=!0,b.triggerOnTouchLeave&&(n={left:(l=(r=ne(r=this)).offset()).left,right:l.left+r.outerWidth(),top:l.top,bottom:l.top+r.outerHeight()},a=o.end,s=n,i=a.x>s.left&&a.x<s.right&&a.y>s.top&&a.y<s.bottom),!b.triggerOnTouchEnd&&i?C=I(Pe):b.triggerOnTouchLeave&&!i&&(C=I(Fe)),C!=xe&&C!=Fe||E(g,C))):E(g,C=xe),!1===t&&E(g,C=xe))}function m(e){var t=e.originalEvent;return je&&0<t.touches.length?(d=ie(),c=event.touches.length+1,!0):(J()&&(S=c),e.preventDefault(),k=ie(),w=te(),A()?E(t,C=xe):b.triggerOnTouchEnd||0==b.triggerOnTouchEnd&&C===Pe?E(t,C=Fe):!b.triggerOnTouchEnd&&B()?O(t,C=Fe,me):C===Pe&&E(t,C=xe),X(!1),null)}function g(){_=y=l=k=S=0,G(),X(!(P=1))}function T(e){var t=e.originalEvent;b.triggerOnTouchLeave&&E(t,C=I(Fe))}function V(){r.unbind(o,h),r.unbind(s,g),r.unbind(i,p),r.unbind(n,m),a&&r.unbind(a,T),X(!1)}function I(e){var t=e,o=D(),i=L(),n=A();return!o||n?t=xe:!i||e!=Pe||b.triggerOnTouchEnd&&!b.triggerOnTouchLeave?!i&&e==Fe&&b.triggerOnTouchLeave&&(t=xe):t=Fe,t}function E(e,t){var o=void 0;return z()&&R()||R()?o=O(e,t,he):(q()&&M()||M())&&!1!==o&&(o=O(e,t,pe)),Q()&&W()&&!1!==o?o=O(e,t,ge):w>b.longTapThreshold&&v<ye&&b.longTap&&!1!==o?o=O(e,t,be):1!==S&&je||!isNaN(v)&&0!==v||!B()||!1===o||(o=O(e,t,me)),t===xe&&g(),t!==Fe||je&&0!=e.touches.length||g(),o}function O(e,t,o){var i=void 0;if(o==he){if(r.trigger("swipeStatus",[t,$||null,v||0,w||0,S]),b.swipeStatus&&!1===(i=b.swipeStatus.call(r,e,t,$||null,v||0,w||0,S)))return!1;if(t==Fe&&z()){if(r.trigger("swipe",[$,v,w,S]),b.swipe&&!1===(i=b.swipe.call(r,e,$,v,w,S)))return!1;switch($){case ae:r.trigger("swipeLeft",[$,v,w,S]),b.swipeLeft&&(i=b.swipeLeft.call(r,e,$,v,w,S));break;case se:r.trigger("swipeRight",[$,v,w,S]),b.swipeRight&&(i=b.swipeRight.call(r,e,$,v,w,S));break;case re:r.trigger("swipeUp",[$,v,w,S]),b.swipeUp&&(i=b.swipeUp.call(r,e,$,v,w,S));break;case le:r.trigger("swipeDown",[$,v,w,S]),b.swipeDown&&(i=b.swipeDown.call(r,e,$,v,w,S))}}}if(o==pe){if(r.trigger("pinchStatus",[t,x||null,F||0,w||0,S,P]),b.pinchStatus&&!1===(i=b.pinchStatus.call(r,e,t,x||null,F||0,w||0,S,P)))return!1;if(t==Fe&&q())switch(x){case de:r.trigger("pinchIn",[x||null,F||0,w||0,S,P]),b.pinchIn&&(i=b.pinchIn.call(r,e,x||null,F||0,w||0,S,P));break;case ce:r.trigger("pinchOut",[x||null,F||0,w||0,S,P]),b.pinchOut&&(i=b.pinchOut.call(r,e,x||null,F||0,w||0,S,P))}}return o==me?t!==xe&&t!==Fe||(clearTimeout(f),W()&&!Q()?(u=ie(),f=setTimeout(ne.proxy(function(){u=null,r.trigger("tap",[e.target]),b.tap&&(i=b.tap.call(r,e,e.target))},this),b.doubleTapThreshold)):(u=null,r.trigger("tap",[e.target]),b.tap&&(i=b.tap.call(r,e,e.target)))):o==ge?t!==xe&&t!==Fe||(clearTimeout(f),u=null,r.trigger("doubletap",[e.target]),b.doubleTap&&(i=b.doubleTap.call(r,e,e.target))):o==be&&(t!==xe&&t!==Fe||(clearTimeout(f),u=null,r.trigger("longtap",[e.target]),b.longTap&&(i=b.longTap.call(r,e,e.target)))),i}function L(){var e=!0;return null!==b.threshold&&(e=v>=b.threshold),e}function A(){var e=!1;return null!==b.cancelThreshold&&null!==$&&(e=K($)-v>=b.cancelThreshold),e}function D(){var e=!b.maxTimeThreshold||!(w>=b.maxTimeThreshold);return e}function q(){var e=U(),t=N(),o=null===b.pinchThreshold||F>=b.pinchThreshold;return e&&t&&o}function M(){return b.pinchStatus||b.pinchIn||b.pinchOut}function z(){var e=D(),t=L(),o=U(),i=N();return!A()&&i&&o&&t&&e}function R(){return b.swipe||b.swipeStatus||b.swipeLeft||b.swipeRight||b.swipeUp||b.swipeDown}function U(){return S===b.fingers||b.fingers===we||!je}function N(){return 0!==H[0].end.x}function B(){return b.tap}function W(){return!!b.doubleTap}function Q(){if(null==u)return!1;var e=ie();return W()&&e-u<=b.doubleTapThreshold}function G(){c=d=0}function J(){var e=!1;return d&&ie()-d<=b.fingerReleaseThreshold&&(e=!0),e}function X(e){!0===e?(r.bind(i,p),r.bind(n,m),a&&r.bind(a,T)):(r.unbind(i,p,!1),r.unbind(n,m,!1),a&&r.unbind(a,T,!1)),r.data(Ce+"_intouch",!0===e)}function Y(e,t){var o=void 0!==t.identifier?t.identifier:0;return H[e].identifier=o,H[e].start.x=H[e].end.x=t.pageX||t.clientX,H[e].start.y=H[e].end.y=t.pageY||t.clientY,H[e]}function Z(e){var t=function(e){for(var t=0;t<H.length;t++)if(H[t].identifier==e)return H[t]}(void 0!==e.identifier?e.identifier:0);return t.end.x=e.pageX||e.clientX,t.end.y=e.pageY||e.clientY,t}function K(e){if(j[e])return j[e].distance}function ee(e){return{direction:e,distance:0}}function te(){return k-l}function oe(e,t){var o=Math.abs(e.x-t.x),i=Math.abs(e.y-t.y);return Math.round(Math.sqrt(o*o+i*i))}function ie(){return(new Date).getTime()}this.enable=function(){return r.bind(o,h),r.bind(s,g),r},this.disable=function(){return V(),r},this.destroy=function(){return V(),r.data(Ce,null),r},this.option=function(e,t){if(void 0!==b[e]){if(void 0===t)return b[e];b[e]=t}else ne.error("Option "+e+" does not exist on jQuery.swipe.options");return null}}ne.fn.swipe=function(e){var t=ne(this),o=t.data(Ce);if(o&&"string"==typeof e){if(o[e])return o[e].apply(this,Array.prototype.slice.call(arguments,1));ne.error("Method "+e+" does not exist on jQuery.swipe")}else if(!(o||"object"!=typeof e&&e))return function(o){!o||void 0!==o.allowPageScroll||void 0===o.swipe&&void 0===o.swipeStatus||(o.allowPageScroll=ue);void 0!==o.click&&void 0===o.tap&&(o.tap=o.click);o=o||{};return o=ne.extend({},ne.fn.swipe.defaults,o),this.each(function(){var e=ne(this),t=e.data(Ce);t||(t=new i(this,o),e.data(Ce,t))})}.apply(this,arguments);return t},ne.fn.swipe.defaults={fingers:1,threshold:75,cancelThreshold:null,pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,triggerOnTouchEnd:!0,triggerOnTouchLeave:!1,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:"label, button, input, select, textarea, a, .noSwipe"},ne.fn.swipe.phases={PHASE_START:_e,PHASE_MOVE:Pe,PHASE_END:Fe,PHASE_CANCEL:xe},ne.fn.swipe.directions={LEFT:ae,RIGHT:se,UP:re,DOWN:le,IN:de,OUT:ce},ne.fn.swipe.pageScroll={NONE:ue,HORIZONTAL:ve,VERTICAL:$e,AUTO:fe},ne.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:we}}),function(e){"use strict";function s(t,o,i){var n,a=document.createElement("img");return a.onerror=function(e){return s.onerror(a,e,t,o,i)},a.onload=function(e){return s.onload(a,e,t,o,i)},"string"==typeof t?(s.fetchBlob(t,function(e){e?(t=e,n=s.createObjectURL(t)):(n=t,i&&i.crossOrigin&&(a.crossOrigin=i.crossOrigin)),a.src=n},i),a):s.isInstanceOf("Blob",t)||s.isInstanceOf("File",t)?(n=a._objectURL=s.createObjectURL(t))?(a.src=n,a):s.readFile(t,function(e){var t=e.target;t&&t.result?a.src=t.result:o&&o(e)}):void 0}function a(e,t){!e._objectURL||t&&t.noRevoke||(s.revokeObjectURL(e._objectURL),delete e._objectURL)}var t=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;s.fetchBlob=function(e,t,o){t()},s.isInstanceOf=function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},s.transform=function(e,t,o,i,n){o(e,n)},s.onerror=function(e,t,o,i,n){a(e,n),i&&i.call(e,t)},s.onload=function(e,t,o,i,n){a(e,n),i&&s.transform(e,n,i,o,{})},s.createObjectURL=function(e){return!!t&&t.createObjectURL(e)},s.revokeObjectURL=function(e){return!!t&&t.revokeObjectURL(e)},s.readFile=function(e,t,o){if(window.FileReader){var i=new FileReader;if(i.onload=i.onerror=t,i[o=o||"readAsDataURL"])return i[o](e),i}return!1},"function"==typeof define&&define.amd?define(function(){return s}):"object"==typeof module&&module.exports?module.exports=s:e.loadImage=s}(window),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],e):e("object"==typeof module&&module.exports?require("./load-image"):window.loadImage)}(function(_){"use strict";var a=_.transform;_.transform=function(e,t,o,i,n){a.call(_,_.scale(e,t,n),t,o,i,n)},_.transformCoordinates=function(){},_.getTransformedOptions=function(e,t){var o,i,n,a,s=t.aspectRatio;if(!s)return t;for(i in o={},t)t.hasOwnProperty(i)&&(o[i]=t[i]);return o.crop=!0,s<(n=e.naturalWidth||e.width)/(a=e.naturalHeight||e.height)?(o.maxWidth=a*s,o.maxHeight=a):(o.maxWidth=n,o.maxHeight=n/s),o},_.renderImageToCanvas=function(e,t,o,i,n,a,s,r,l,d){return e.getContext("2d").drawImage(t,o,i,n,a,s,r,l,d),e},_.hasCanvasOption=function(e){return e.canvas||e.crop||!!e.aspectRatio},_.scale=function(e,t,o){function i(){var e=Math.max((r||w)/w,(l||y)/y);1<e&&(w*=e,y*=e)}function n(){var e=Math.min((a||w)/w,(s||y)/y);e<1&&(w*=e,y*=e)}t=t||{};var a,s,r,l,d,c,u,f,h,p,m,g=document.createElement("canvas"),b=e.getContext||_.hasCanvasOption(t)&&g.getContext,v=e.naturalWidth||e.width,$=e.naturalHeight||e.height,w=v,y=$;if(g.originalWidth=v,g.originalHeight=$,b&&(u=(t=_.getTransformedOptions(e,t,o)).left||0,f=t.top||0,t.sourceWidth?(d=t.sourceWidth,void 0!==t.right&&void 0===t.left&&(u=v-d-t.right)):d=v-u-(t.right||0),t.sourceHeight?(c=t.sourceHeight,void 0!==t.bottom&&void 0===t.top&&(f=$-c-t.bottom)):c=$-f-(t.bottom||0),w=d,y=c),a=t.maxWidth,s=t.maxHeight,r=t.minWidth,l=t.minHeight,b&&a&&s&&t.crop?(m=d/c-(w=a)/(y=s))<0?(c=s*d/a,void 0===t.top&&void 0===t.bottom&&(f=($-c)/2)):0<m&&(d=a*c/s,void 0===t.left&&void 0===t.right&&(u=(v-d)/2)):((t.contain||t.cover)&&(r=a=a||r,l=s=s||l),t.cover?(n(),i()):(i(),n())),b){if(1<(h=t.pixelRatio)&&(g.style.width=w+"px",g.style.height=y+"px",w*=h,y*=h,g.getContext("2d").scale(h,h)),0<(p=t.downsamplingRatio)&&p<1&&w<d&&y<c)for(;w<d*p;)g.width=d*p,g.height=c*p,_.renderImageToCanvas(g,e,u,f,d,c,0,0,g.width,g.height),f=u=0,d=g.width,c=g.height,(e=document.createElement("canvas")).width=d,e.height=c,_.renderImageToCanvas(e,g,0,0,d,c,0,0,d,c);return g.width=w,g.height=y,_.transformCoordinates(g,t),_.renderImageToCanvas(g,e,u,f,d,c,0,0,w,y)}return e.width=w,e.height=y,e}}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],e):e("object"==typeof module&&module.exports?require("./load-image"):window.loadImage)}(function(p){"use strict";var e=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);p.blobSlice=e&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},p.metaDataParsers={jpeg:{65505:[]}},p.parseMetaData=function(e,c,u,f){f=f||{};var h=this,t=(u=u||{}).maxMetaDataSize||262144;!!(window.DataView&&e&&12<=e.size&&"image/jpeg"===e.type&&p.blobSlice)&&p.readFile(p.blobSlice.call(e,0,t),function(e){if(e.target.error)return console.log(e.target.error),void c(f);var t,o,i,n,a=e.target.result,s=new DataView(a),r=2,l=s.byteLength-4,d=r;if(65496===s.getUint16(0)){for(;r<l&&(65504<=(t=s.getUint16(r))&&t<=65519||65534===t);){if(r+(o=s.getUint16(r+2)+2)>s.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(i=p.metaDataParsers.jpeg[t])for(n=0;n<i.length;n+=1)i[n].call(h,s,r,o,f,u);d=r+=o}!u.disableImageHead&&6<d&&(a.slice?f.imageHead=a.slice(0,d):f.imageHead=new Uint8Array(a).subarray(0,d))}else console.log("Invalid JPEG file: Missing JPEG marker.");c(f)},"readAsArrayBuffer")||c(f)},p.hasMetaOption=function(e){return e&&e.meta};var a=p.transform;p.transform=function(t,o,i,n,e){p.hasMetaOption(o)?p.parseMetaData(n,function(e){a.call(p,t,o,i,n,e)},o,e):a.apply(p,arguments)}}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-meta")):e(window.loadImage)}(function(i){"use strict";"fetch"in window&&"Request"in window&&(i.fetchBlob=function(e,t,o){return i.hasMetaOption(o)?fetch(new Request(e,o)).then(function(e){return e.blob()}).then(t).catch(function(e){console.log(e),t()}):void t()})}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-meta")):e(window.loadImage)}(function(h){"use strict";h.ExifMap=function(){return this},h.ExifMap.prototype.map={Orientation:274},h.ExifMap.prototype.get=function(e){return this[e]||this[this.map[e]]},h.getExifThumbnail=function(e,t,o){var i,n,a;if(o&&!(t+o>e.byteLength)){for(i=[],n=0;n<o;n+=1)a=e.getUint8(t+n),i.push((a<16?"0":"")+a.toString(16));return"data:image/jpeg,%"+i.join("%")}console.log("Invalid Exif data: Invalid thumbnail data.")},h.exifTagTypes={1:{getValue:function(e,t){return e.getUint8(t)},size:1},2:{getValue:function(e,t){return String.fromCharCode(e.getUint8(t))},size:1,ascii:!0},3:{getValue:function(e,t,o){return e.getUint16(t,o)},size:2},4:{getValue:function(e,t,o){return e.getUint32(t,o)},size:4},5:{getValue:function(e,t,o){return e.getUint32(t,o)/e.getUint32(t+4,o)},size:8},9:{getValue:function(e,t,o){return e.getInt32(t,o)},size:4},10:{getValue:function(e,t,o){return e.getInt32(t,o)/e.getInt32(t+4,o)},size:8}},h.exifTagTypes[7]=h.exifTagTypes[1],h.getExifValue=function(e,t,o,i,n,a){var s,r,l,d,c,u,f=h.exifTagTypes[i];if(f){if(!((r=4<(s=f.size*n)?t+e.getUint32(o+8,a):o+8)+s>e.byteLength)){if(1===n)return f.getValue(e,r,a);for(l=[],d=0;d<n;d+=1)l[d]=f.getValue(e,r+d*f.size,a);if(f.ascii){for(c="",d=0;d<l.length&&"\0"!==(u=l[d]);d+=1)c+=u;return c}return l}console.log("Invalid Exif data: Invalid data offset.")}else console.log("Invalid Exif data: Invalid tag type.")},h.parseExifTag=function(e,t,o,i,n){var a=e.getUint16(o,i);n.exif[a]=h.getExifValue(e,t,o,e.getUint16(o+2,i),e.getUint32(o+4,i),i)},h.parseExifTags=function(e,t,o,i,n){var a,s,r;if(o+6>e.byteLength)console.log("Invalid Exif data: Invalid directory offset.");else{if(!((s=o+2+12*(a=e.getUint16(o,i)))+4>e.byteLength)){for(r=0;r<a;r+=1)this.parseExifTag(e,t,o+2+12*r,i,n);return e.getUint32(s,i)}console.log("Invalid Exif data: Invalid directory size.")}},h.parseExifData=function(e,t,o,i,n){if(!n.disableExif){var a,s,r,l=t+10;if(1165519206===e.getUint32(t+4)){if(l+8>e.byteLength)return void console.log("Invalid Exif data: Invalid segment size.");if(0!==e.getUint16(t+8))return void console.log("Invalid Exif data: Missing byte alignment offset.");switch(e.getUint16(l)){case 18761:a=!0;break;case 19789:a=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==e.getUint16(l+2,a))return void console.log("Invalid Exif data: Missing TIFF marker.");s=e.getUint32(l+4,a),i.exif=new h.ExifMap,(s=h.parseExifTags(e,l,l+s,a,i))&&!n.disableExifThumbnail&&(r={exif:{}},s=h.parseExifTags(e,l,l+s,a,r),r.exif[513]&&(i.exif.Thumbnail=h.getExifThumbnail(e,l+r.exif[513],r.exif[514]))),i.exif[34665]&&!n.disableExifSub&&h.parseExifTags(e,l,l+i.exif[34665],a,i),i.exif[34853]&&!n.disableExifGps&&h.parseExifTags(e,l,l+i.exif[34853],a,i)}}},h.metaDataParsers.jpeg[65505].push(h.parseExifData)}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-exif"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-exif")):e(window.loadImage)}(function(e){"use strict";e.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},e.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}},e.ExifMap.prototype.getText=function(e){var t=this.get(e);switch(e){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[e][t];case"ExifVersion":case"FlashpixVersion":if(!t)return;return String.fromCharCode(t[0],t[1],t[2],t[3]);case"ComponentsConfiguration":if(!t)return;return this.stringValues[e][t[0]]+this.stringValues[e][t[1]]+this.stringValues[e][t[2]]+this.stringValues[e][t[3]];case"GPSVersionID":if(!t)return;return t[0]+"."+t[1]+"."+t[2]+"."+t[3]}return String(t)},function(e){var t,o=e.tags,i=e.map;for(t in o)o.hasOwnProperty(t)&&(i[o[t]]=t)}(e.ExifMap.prototype),e.ExifMap.prototype.getAll=function(){var e,t,o={};for(e in this)this.hasOwnProperty(e)&&((t=this.tags[e])&&(o[t]=this.getText(t)));return o}}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-scale","./load-image-meta"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-scale"),require("./load-image-meta")):e(window.loadImage)}(function(l){"use strict";var t=l.hasCanvasOption,o=l.hasMetaOption,d=l.transformCoordinates,r=l.getTransformedOptions;l.hasCanvasOption=function(e){return!!e.orientation||t.call(l,e)},l.hasMetaOption=function(e){return e&&!0===e.orientation||o.call(l,e)},l.transformCoordinates=function(e,t){d.call(l,e,t);var o=e.getContext("2d"),i=e.width,n=e.height,a=e.style.width,s=e.style.height,r=t.orientation;if(r&&!(8<r))switch(4<r&&(e.width=n,e.height=i,e.style.width=s,e.style.height=a),r){case 2:o.translate(i,0),o.scale(-1,1);break;case 3:o.translate(i,n),o.rotate(Math.PI);break;case 4:o.translate(0,n),o.scale(1,-1);break;case 5:o.rotate(.5*Math.PI),o.scale(1,-1);break;case 6:o.rotate(.5*Math.PI),o.translate(0,-n);break;case 7:o.rotate(.5*Math.PI),o.translate(i,-n),o.scale(-1,1);break;case 8:o.rotate(-.5*Math.PI),o.translate(-i,0)}},l.getTransformedOptions=function(e,t,o){var i,n,a=r.call(l,e,t),s=a.orientation;if(!0===s&&o&&o.exif&&(s=o.exif.get("Orientation")),!s||8<s||1===s)return a;for(n in i={},a)a.hasOwnProperty(n)&&(i[n]=a[n]);switch(i.orientation=s){case 2:i.left=a.right,i.right=a.left;break;case 3:i.left=a.right,i.top=a.bottom,i.right=a.left,i.bottom=a.top;break;case 4:i.top=a.bottom,i.bottom=a.top;break;case 5:i.left=a.top,i.top=a.left,i.right=a.bottom,i.bottom=a.right;break;case 6:i.left=a.top,i.top=a.right,i.right=a.bottom,i.bottom=a.left;break;case 7:i.left=a.bottom,i.top=a.right,i.right=a.top,i.bottom=a.left;break;case 8:i.left=a.bottom,i.top=a.left,i.right=a.top,i.bottom=a.right}return 4<i.orientation&&(i.maxWidth=a.maxHeight,i.maxHeight=a.maxWidth,i.minWidth=a.minHeight,i.minHeight=a.minWidth,i.sourceWidth=a.sourceHeight,i.sourceHeight=a.sourceWidth),i}}),"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var o,i,n,a,s,r=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(l)){for(a=l.length,o=0;o<a;o+=1)s[o]=str(o,l)||"null";return n=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+r+"]":"["+s.join(",")+"]",gap=r,n}if(rep&&"object"==typeof rep)for(a=rep.length,o=0;o<a;o+=1)"string"==typeof rep[o]&&((n=str(i=rep[o],l))&&s.push(quote(i)+(gap?": ":":")+n));else for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&((n=str(i,l))&&s.push(quote(i)+(gap?": ":":")+n));return n=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+r+"}":"{"+s.join(",")+"}",gap=r,n}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,o){var i;if(indent=gap="","number"==typeof o)for(i=0;i<o;i+=1)indent+=" ";else"string"==typeof o&&(indent=o);if(!(rep=t)||"function"==typeof t||"object"==typeof t&&"number"==typeof t.length)return str("",{"":e});throw new Error("JSON.stringify")}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var o,i,n=e[t];if(n&&"object"==typeof n)for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(void 0!==(i=walk(n,o))?n[o]=i:delete n[o]);return reviver.call(e,t,n)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(e){"use strict";var t=e.History=e.History||{},i=e.jQuery;if(void 0!==t.Adapter)throw new Error("History.js Adapter has already been loaded...");t.Adapter={bind:function(e,t,o){i(e).bind(t,o)},trigger:function(e,t,o){i(e).trigger(t,o)},extractEventData:function(e,t,o){return t&&t.originalEvent&&t.originalEvent[e]||o&&o[e]||void 0},onDomLoad:function(e){i(e)}},void 0!==t.init&&t.init()}(window),function(c){"use strict";var e=c.document,t=c.setTimeout||t,o=c.clearTimeout||o,r=c.setInterval||r,u=c.History=c.History||{};if(void 0!==u.initHtml4)throw new Error("History.js HTML4 Support has already been loaded...");u.initHtml4=function(){if(void 0!==u.initHtml4.initialized)return!1;u.initHtml4.initialized=!0,u.enabled=!0,u.savedHashes=[],u.isLastHash=function(e){return e===u.getHashByIndex()},u.isHashEqual=function(e,t){return(e=encodeURIComponent(e).replace(/%25/g,"%"))===(t=encodeURIComponent(t).replace(/%25/g,"%"))},u.saveHash=function(e){return!u.isLastHash(e)&&(u.savedHashes.push(e),!0)},u.getHashByIndex=function(e){return void 0===e?u.savedHashes[u.savedHashes.length-1]:e<0?u.savedHashes[u.savedHashes.length+e]:u.savedHashes[e]},u.discardedHashes={},u.discardedStates={},u.discardState=function(e,t,o){var i=u.getHashByState(e),n={discardedState:e,backState:o,forwardState:t};return u.discardedStates[i]=n,!0},u.discardHash=function(e,t,o){var i={discardedHash:e,backState:o,forwardState:t};return u.discardedHashes[e]=i,!0},u.discardedState=function(e){var t=u.getHashByState(e);return u.discardedStates[t]||!1},u.discardedHash=function(e){return u.discardedHashes[e]||!1},u.recycleState=function(e){var t=u.getHashByState(e);return u.discardedState(e)&&delete u.discardedStates[t],!0},u.emulated.hashChange&&(u.hashChangeInit=function(){u.checkerFunction=null;var o,i,n,a="",s=Boolean(u.getHash());return u.isInternetExplorer()?((o=e.createElement("iframe")).setAttribute("id","historyjs-iframe"),o.setAttribute("src","#"),o.style.display="none",e.body.appendChild(o),o.contentWindow.document.open(),o.contentWindow.document.close(),i="",n=!1,u.checkerFunction=function(){if(n)return!1;n=!0;var e=u.getHash(),t=u.getHash(o.contentWindow.document);return e!==a?(t!==(a=e)&&(i=t=e,o.contentWindow.document.open(),o.contentWindow.document.close(),o.contentWindow.document.location.hash=u.escapeHash(e)),u.Adapter.trigger(c,"hashchange")):t!==i&&(i=t,s&&""===t?u.back():u.setHash(t,!1)),!(n=!1)}):u.checkerFunction=function(){var e=u.getHash()||"";return e!==a&&(a=e,u.Adapter.trigger(c,"hashchange")),!0},u.intervalList.push(r(u.checkerFunction,u.options.hashChangeInterval)),!0},u.Adapter.onDomLoad(u.hashChangeInit)),u.emulated.pushState&&(u.onHashChange=function(e){var t,o=e&&e.newURL||u.getLocationHref(),i=u.getHashByUrl(o),n=null;return u.isLastHash(i)?(u.busy(!1),!1):(u.doubleCheckComplete(),u.saveHash(i),i&&u.isTraditionalAnchor(i)?(u.Adapter.trigger(c,"anchorchange"),u.busy(!1),!1):(n=u.extractState(u.getFullUrl(i||u.getLocationHref()),!0),u.isLastSavedState(n)?(u.busy(!1),!1):(u.getHashByState(n),(t=u.discardedState(n))?(u.getHashByIndex(-2)===u.getHashByState(t.forwardState)?u.back(!1):u.forward(!1),!1):(u.pushState(n.data,n.title,encodeURI(n.url),!1),!0))))},u.Adapter.bind(c,"hashchange",u.onHashChange),u.pushState=function(e,t,o,i){if(o=encodeURI(o).replace(/%25/g,"%"),u.getHashByUrl(o))throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).");if(!1!==i&&u.busy())return u.pushQueue({scope:u,callback:u.pushState,args:arguments,queue:i}),!1;u.busy(!0);var n=u.createStateObject(e,t,o),a=u.getHashByState(n),s=u.getState(!1),r=u.getHashByState(s),l=u.getHash(),d=u.expectedStateId==n.id;return u.storeState(n),u.expectedStateId=n.id,u.recycleState(n),u.setTitle(n),a===r?(u.busy(!1),!1):(u.saveState(n),d||u.Adapter.trigger(c,"statechange"),u.isHashEqual(a,l)||u.isHashEqual(a,u.getShortUrl(u.getLocationHref()))||u.setHash(a,!1),u.busy(!1),!0)},u.replaceState=function(e,t,o,i){if(o=encodeURI(o).replace(/%25/g,"%"),u.getHashByUrl(o))throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).");if(!1!==i&&u.busy())return u.pushQueue({scope:u,callback:u.replaceState,args:arguments,queue:i}),!1;u.busy(!0);var n=u.createStateObject(e,t,o),a=u.getHashByState(n),s=u.getState(!1),r=u.getHashByState(s),l=u.getStateByIndex(-2);return u.discardState(s,n,l),a===r?(u.storeState(n),u.expectedStateId=n.id,u.recycleState(n),u.setTitle(n),u.saveState(n),u.Adapter.trigger(c,"statechange"),u.busy(!1)):u.pushState(n.data,n.title,n.url,!1),!0}),u.emulated.pushState&&u.getHash()&&!u.emulated.hashChange&&u.Adapter.onDomLoad(function(){u.Adapter.trigger(c,"hashchange")})},void 0!==u.init&&u.init()}(window),function(s,o){"use strict";var r=s.console||o,l=s.document,i=s.navigator,n=!1,a=s.setTimeout,d=s.clearTimeout,c=s.setInterval,u=s.clearInterval,f=s.JSON,h=s.alert,p=s.History=s.History||{},m=s.history;try{(n=s.sessionStorage).setItem("TEST","1"),n.removeItem("TEST")}catch(e){n=!1}if(f.stringify=f.stringify||f.encode,f.parse=f.parse||f.decode,void 0!==p.init)throw new Error("History.js Core has already been loaded...");p.init=function(e){return void 0!==p.Adapter&&(void 0!==p.initCore&&p.initCore(),void 0!==p.initHtml4&&p.initHtml4(),!0)},p.initCore=function(e){if(void 0!==p.initCore.initialized)return!1;var t;if(p.initCore.initialized=!0,p.options=p.options||{},p.options.hashChangeInterval=p.options.hashChangeInterval||100,p.options.safariPollInterval=p.options.safariPollInterval||500,p.options.doubleCheckInterval=p.options.doubleCheckInterval||500,p.options.disableSuid=p.options.disableSuid||!1,p.options.storeInterval=p.options.storeInterval||1e3,p.options.busyDelay=p.options.busyDelay||250,p.options.debug=p.options.debug||!1,p.options.initialTitle=p.options.initialTitle||l.title,p.options.html4Mode=p.options.html4Mode||!1,p.options.delayInit=p.options.delayInit||!1,p.intervalList=[],p.clearAllIntervals=function(){var e,t=p.intervalList;if(null!=t){for(e=0;e<t.length;e++)u(t[e]);p.intervalList=null}},p.debug=function(){p.options.debug&&p.log.apply(p,arguments)},p.log=function(){var e,t,o,i,n,a=void 0!==r&&void 0!==r.log&&void 0!==r.log.apply,s=l.getElementById("log");for(a?(e=(i=Array.prototype.slice.call(arguments)).shift(),void 0!==r.debug?r.debug.apply(r,[e,i]):r.log.apply(r,[e,i])):e="\n"+arguments[0]+"\n",t=1,o=arguments.length;t<o;++t){if("object"==typeof(n=arguments[t])&&void 0!==f)try{n=f.stringify(n)}catch(e){}e+="\n"+n+"\n"}return s?(s.value+=e+"\n-----\n",s.scrollTop=s.scrollHeight-s.clientHeight):a||h(e),!0},p.getInternetExplorerMajorVersion=function(){return p.getInternetExplorerMajorVersion.cached=void 0!==p.getInternetExplorerMajorVersion.cached?p.getInternetExplorerMajorVersion.cached:function(){for(var e=3,t=l.createElement("div"),o=t.getElementsByTagName("i");(t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e")&&o[0];);return 4<e&&e}()},p.isInternetExplorer=function(){return p.isInternetExplorer.cached=void 0!==p.isInternetExplorer.cached?p.isInternetExplorer.cached:Boolean(p.getInternetExplorerMajorVersion())},p.options.html4Mode?p.emulated={pushState:!0,hashChange:!0}:p.emulated={pushState:!Boolean(s.history&&s.history.pushState&&s.history.replaceState&&!/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(i.userAgent)&&!/AppleWebKit\/5([0-2]|3[0-2])/i.test(i.userAgent)),hashChange:Boolean(!("onhashchange"in s||"onhashchange"in l)||p.isInternetExplorer()&&p.getInternetExplorerMajorVersion()<8)},p.enabled=!p.emulated.pushState,p.bugs={setHash:Boolean(!p.emulated.pushState&&"Apple Computer, Inc."===i.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(i.userAgent)),safariPoll:Boolean(!p.emulated.pushState&&"Apple Computer, Inc."===i.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(i.userAgent)),ieDoubleCheck:Boolean(p.isInternetExplorer()&&p.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(p.isInternetExplorer()&&p.getInternetExplorerMajorVersion()<7)},p.isEmptyObject=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},p.cloneObject=function(e){var t,o=e?(t=f.stringify(e),f.parse(t)):{};return o},p.getRootUrl=function(){var e=l.location.protocol+"//"+(l.location.hostname||l.location.host);return l.location.port&&(e+=":"+l.location.port),e+="/"},p.getBaseHref=function(){var e=l.getElementsByTagName("base"),t="";return 1===e.length&&(t=e[0].href.replace(/[^\/]+$/,"")),(t=t.replace(/\/+$/,""))&&(t+="/"),t},p.getBaseUrl=function(){return p.getBaseHref()||p.getBasePageUrl()||p.getRootUrl()},p.getPageUrl=function(){return((p.getState(!1,!1)||{}).url||p.getLocationHref()).replace(/\/+$/,"").replace(/[^\/]+$/,function(e,t,o){return/\./.test(e)?e:e+"/"})},p.getBasePageUrl=function(){return p.getLocationHref().replace(/[#\?].*/,"").replace(/[^\/]+$/,function(e,t,o){return/[^\/]$/.test(e)?"":e}).replace(/\/+$/,"")+"/"},p.getFullUrl=function(e,t){var o=e,i=e.substring(0,1);return t=void 0===t||t,/[a-z]+\:\/\//.test(e)||(o="/"===i?p.getRootUrl()+e.replace(/^\/+/,""):"#"===i?p.getPageUrl().replace(/#.*/,"")+e:"?"===i?p.getPageUrl().replace(/[\?#].*/,"")+e:t?p.getBaseUrl()+e.replace(/^(\.\/)+/,""):p.getBasePageUrl()+e.replace(/^(\.\/)+/,"")),o.replace(/\#$/,"")},p.getShortUrl=function(e){var t=e,o=p.getBaseUrl(),i=p.getRootUrl();return p.emulated.pushState&&(t=t.replace(o,"")),t=t.replace(i,"/"),p.isTraditionalAnchor(t)&&(t="./"+t),t=t.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},p.getLocationHref=function(e){return(e=e||l).URL===e.location.href?e.location.href:e.location.href===decodeURIComponent(e.URL)?e.URL:(!e.location.hash||decodeURIComponent(e.location.href.replace(/^[^#]+/,""))!==e.location.hash)&&(-1!=e.URL.indexOf("#")||-1==e.location.href.indexOf("#"))&&e.URL||e.location.href},p.store={},p.idToState=p.idToState||{},p.stateToId=p.stateToId||{},p.urlToId=p.urlToId||{},p.storedStates=p.storedStates||[],p.savedStates=p.savedStates||[],p.normalizeStore=function(){p.store.idToState=p.store.idToState||{},p.store.urlToId=p.store.urlToId||{},p.store.stateToId=p.store.stateToId||{}},p.getState=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0);var o=p.getLastSavedState();return!o&&t&&(o=p.createStateObject()),e&&((o=p.cloneObject(o)).url=o.cleanUrl||o.url),o},p.getIdByState=function(e){var t,o=p.extractId(e.url);if(!o)if(t=p.getStateString(e),void 0!==p.stateToId[t])o=p.stateToId[t];else if(void 0!==p.store.stateToId[t])o=p.store.stateToId[t];else{for(;o=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),void 0!==p.idToState[o]||void 0!==p.store.idToState[o];);p.stateToId[t]=o,p.idToState[o]=e}return o},p.normalizeState=function(e){var t,o;return e&&"object"==typeof e||(e={}),void 0!==e.normalized?e:(e.data&&"object"==typeof e.data||(e.data={}),(t={normalized:!0}).title=e.title||"",t.url=p.getFullUrl(e.url?e.url:p.getLocationHref()),t.hash=p.getShortUrl(t.url),t.data=p.cloneObject(e.data),t.id=p.getIdByState(t),t.cleanUrl=t.url.replace(/\??\&_suid.*/,""),t.url=t.cleanUrl,o=!p.isEmptyObject(t.data),(t.title||o)&&!0!==p.options.disableSuid&&(t.hash=p.getShortUrl(t.url).replace(/\??\&_suid.*/,""),/\?/.test(t.hash)||(t.hash+="?"),t.hash+="&_suid="+t.id),t.hashedUrl=p.getFullUrl(t.hash),(p.emulated.pushState||p.bugs.safariPoll)&&p.hasUrlDuplicate(t)&&(t.url=t.hashedUrl),t)},p.createStateObject=function(e,t,o){var i={data:e,title:t,url:o};return i=p.normalizeState(i)},p.getStateById=function(e){return e=String(e),p.idToState[e]||p.store.idToState[e]||o},p.getStateString=function(e){var t={data:p.normalizeState(e).data,title:e.title,url:e.url};return f.stringify(t)},p.getStateId=function(e){return p.normalizeState(e).id},p.getHashByState=function(e){return p.normalizeState(e).hash},p.extractId=function(e){var t=-1!=e.indexOf("#")?e.split("#")[0]:e,o=/(.*)\&_suid=([0-9]+)$/.exec(t);o&&o[1];return(o?String(o[2]||""):"")||!1},p.isTraditionalAnchor=function(e){return!/[\/\?\.]/.test(e)},p.extractState=function(e,t){var o,i,n=null;return t=t||!1,(o=p.extractId(e))&&(n=p.getStateById(o)),n||(i=p.getFullUrl(e),(o=p.getIdByUrl(i)||!1)&&(n=p.getStateById(o)),n||!t||p.isTraditionalAnchor(e)||(n=p.createStateObject(null,null,i))),n},p.getIdByUrl=function(e){return p.urlToId[e]||p.store.urlToId[e]||o},p.getLastSavedState=function(){return p.savedStates[p.savedStates.length-1]||o},p.getLastStoredState=function(){return p.storedStates[p.storedStates.length-1]||o},p.hasUrlDuplicate=function(e){var t=p.extractState(e.url);return t&&t.id!==e.id},p.storeState=function(e){return p.urlToId[e.url]=e.id,p.storedStates.push(p.cloneObject(e)),e},p.isLastSavedState=function(e){var t=!1;return p.savedStates.length&&(t=e.id===p.getLastSavedState().id),t},p.saveState=function(e){return!p.isLastSavedState(e)&&(p.savedStates.push(p.cloneObject(e)),!0)},p.getStateByIndex=function(e){return void 0===e?p.savedStates[p.savedStates.length-1]:e<0?p.savedStates[p.savedStates.length+e]:p.savedStates[e]},p.getCurrentIndex=function(){return p.savedStates.length<1?0:p.savedStates.length-1},p.getHash=function(e){var t=p.getLocationHref(e);return p.getHashByUrl(t)},p.unescapeHash=function(e){var t=p.normalizeHash(e);return t=decodeURIComponent(t)},p.normalizeHash=function(e){return e.replace(/[^#]*#/,"").replace(/#.*/,"")},p.setHash=function(e,t){var o,i;return!1!==t&&p.busy()?(p.pushQueue({scope:p,callback:p.setHash,args:arguments,queue:t}),!1):(p.busy(!0),(o=p.extractState(e,!0))&&!p.emulated.pushState?p.pushState(o.data,o.title,o.url,!1):p.getHash()!==e&&(p.bugs.setHash?(i=p.getPageUrl(),p.pushState(null,null,i+"#"+e,!1)):l.location.hash=e),p)},p.escapeHash=function(e){var t=p.normalizeHash(e),t=s.encodeURIComponent(t);return p.bugs.hashEscape||(t=t.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),t},p.getHashByUrl=function(e){var t=String(e).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return t=p.unescapeHash(t)},p.setTitle=function(e){var t,o=e.title;o||(t=p.getStateByIndex(0))&&t.url===e.url&&(o=t.title||p.options.initialTitle);try{l.getElementsByTagName("title")[0].innerHTML=o.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(e){}return l.title=o,p},p.queues=[],p.busy=function(e){var i;return void 0!==e?p.busy.flag=e:void 0===p.busy.flag&&(p.busy.flag=!1),p.busy.flag||(d(p.busy.timeout),i=function(){var e,t,o;if(!p.busy.flag)for(e=p.queues.length-1;0<=e;--e)0!==(t=p.queues[e]).length&&(o=t.shift(),p.fireQueueItem(o),p.busy.timeout=a(i,p.options.busyDelay))},p.busy.timeout=a(i,p.options.busyDelay)),p.busy.flag},p.busy.flag=!1,p.fireQueueItem=function(e){return e.callback.apply(e.scope||p,e.args||[])},p.pushQueue=function(e){return p.queues[e.queue||0]=p.queues[e.queue||0]||[],p.queues[e.queue||0].push(e),p},p.queue=function(e,t){return"function"==typeof e&&(e={callback:e}),void 0!==t&&(e.queue=t),p.busy()?p.pushQueue(e):p.fireQueueItem(e),p},p.clearQueue=function(){return p.busy.flag=!1,p.queues=[],p},p.stateChanged=!1,p.doubleChecker=!1,p.doubleCheckComplete=function(){return p.stateChanged=!0,p.doubleCheckClear(),p},p.doubleCheckClear=function(){return p.doubleChecker&&(d(p.doubleChecker),p.doubleChecker=!1),p},p.doubleCheck=function(e){return p.stateChanged=!1,p.doubleCheckClear(),p.bugs.ieDoubleCheck&&(p.doubleChecker=a(function(){return p.doubleCheckClear(),p.stateChanged||e(),!0},p.options.doubleCheckInterval)),p},p.safariStatePoll=function(){var e=p.extractState(p.getLocationHref());if(!p.isLastSavedState(e))return e||p.createStateObject(),p.Adapter.trigger(s,"popstate"),p},p.back=function(e){return!1!==e&&p.busy()?(p.pushQueue({scope:p,callback:p.back,args:arguments,queue:e}),!1):(p.busy(!0),p.doubleCheck(function(){p.back(!1)}),m.go(-1),!0)},p.forward=function(e){return!1!==e&&p.busy()?(p.pushQueue({scope:p,callback:p.forward,args:arguments,queue:e}),!1):(p.busy(!0),p.doubleCheck(function(){p.forward(!1)}),m.go(1),!0)},p.go=function(e,t){var o;if(0<e)for(o=1;o<=e;++o)p.forward(t);else{if(!(e<0))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(o=-1;e<=o;--o)p.back(t)}return p},p.emulated.pushState?(t=function(){},p.pushState=p.pushState||t,p.replaceState=p.replaceState||t):(p.onPopState=function(e,t){var o,i,n=!1,a=!1;return p.doubleCheckComplete(),(o=p.getHash())?((i=p.extractState(o||p.getLocationHref(),!0))?p.replaceState(i.data,i.title,i.url,!1):(p.Adapter.trigger(s,"anchorchange"),p.busy(!1)),p.expectedStateId=!1):(a=(a=(n=p.Adapter.extractEventData("state",e,t)||!1)?p.getStateById(n):p.expectedStateId?p.getStateById(p.expectedStateId):p.extractState(p.getLocationHref()))||p.createStateObject(null,null,p.getLocationHref()),p.expectedStateId=!1,p.isLastSavedState(a)?(p.busy(!1),!1):(p.storeState(a),p.saveState(a),p.setTitle(a),p.Adapter.trigger(s,"statechange"),p.busy(!1),!0))},p.Adapter.bind(s,"popstate",p.onPopState),p.pushState=function(e,t,o,i){if(p.getHashByUrl(o)&&p.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(!1!==i&&p.busy())return p.pushQueue({scope:p,callback:p.pushState,args:arguments,queue:i}),!1;p.busy(!0);var n=p.createStateObject(e,t,o);return p.isLastSavedState(n)?p.busy(!1):(p.storeState(n),p.expectedStateId=n.id,m.pushState(n.id,n.title,n.url),p.Adapter.trigger(s,"popstate")),!0},p.replaceState=function(e,t,o,i){if(p.getHashByUrl(o)&&p.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(!1!==i&&p.busy())return p.pushQueue({scope:p,callback:p.replaceState,args:arguments,queue:i}),!1;p.busy(!0);var n=p.createStateObject(e,t,o);return p.isLastSavedState(n)?p.busy(!1):(p.storeState(n),p.expectedStateId=n.id,m.replaceState(n.id,n.title,n.url),p.Adapter.trigger(s,"popstate")),!0}),n){try{p.store=f.parse(n.getItem("History.store"))||{}}catch(e){p.store={}}p.normalizeStore()}else p.store={},p.normalizeStore();p.Adapter.bind(s,"unload",p.clearAllIntervals),p.saveState(p.storeState(p.extractState(p.getLocationHref(),!0))),n&&(p.onUnload=function(){var t,e,o;try{t=f.parse(n.getItem("History.store"))||{}}catch(e){t={}}for(e in t.idToState=t.idToState||{},t.urlToId=t.urlToId||{},t.stateToId=t.stateToId||{},p.idToState)p.idToState.hasOwnProperty(e)&&(t.idToState[e]=p.idToState[e]);for(e in p.urlToId)p.urlToId.hasOwnProperty(e)&&(t.urlToId[e]=p.urlToId[e]);for(e in p.stateToId)p.stateToId.hasOwnProperty(e)&&(t.stateToId[e]=p.stateToId[e]);p.store=t,p.normalizeStore(),o=f.stringify(t);try{n.setItem("History.store",o)}catch(e){if(e.code!==DOMException.QUOTA_EXCEEDED_ERR)throw e;n.length&&(n.removeItem("History.store"),n.setItem("History.store",o))}},p.intervalList.push(c(p.onUnload,p.options.storeInterval)),p.Adapter.bind(s,"beforeunload",p.onUnload),p.Adapter.bind(s,"unload",p.onUnload)),p.emulated.pushState||(p.bugs.safariPoll&&p.intervalList.push(c(p.safariStatePoll,p.options.safariPollInterval)),"Apple Computer, Inc."!==i.vendor&&"Mozilla"!==(i.appCodeName||"")||(p.Adapter.bind(s,"hashchange",function(){p.Adapter.trigger(s,"popstate")}),p.getHash()&&p.Adapter.onDomLoad(function(){p.Adapter.trigger(s,"hashchange")})))},p.options&&p.options.delayInit||p.init()}(window),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery)}(function(r){var i=0;r.ajaxTransport("iframe",function(n){var a,s,t;if(n.async)return{send:function(e,o){(a=r('<form style="display:none;"></form>')).attr("accept-charset",n.formAcceptCharset),t=/\?/.test(n.url)?"&":"?","DELETE"===n.type?(n.url=n.url+t+"_method=DELETE",n.type="POST"):"PUT"===n.type?(n.url=n.url+t+"_method=PUT",n.type="POST"):"PATCH"===n.type&&(n.url=n.url+t+"_method=PATCH",n.type="POST"),s=r('<iframe src="javascript:false;" name="iframe-transport-'+(i+=1)+'"></iframe>').bind("load",function(){var i,t=r.isArray(n.paramName)?n.paramName:[n.paramName];s.unbind("load").bind("load",function(){var t;try{if(!(t=s.contents()).length||!t[0].firstChild)throw new Error}catch(e){t=void 0}o(200,"success",{iframe:t}),r('<iframe src="javascript:false;"></iframe>').appendTo(a),window.setTimeout(function(){a.remove()},0)}),a.prop("target",s.prop("name")).prop("action",n.url).prop("method",n.type),n.formData&&r.each(n.formData,function(e,t){r('<input type="hidden"/>').prop("name",t.name).val(t.value).appendTo(a)}),n.fileInput&&n.fileInput.length&&"POST"===n.type&&(i=n.fileInput.clone(),n.fileInput.after(function(e){return i[e]}),n.paramName&&n.fileInput.each(function(e){r(this).prop("name",t[e]||n.paramName)}),a.append(n.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data")),a.submit(),i&&i.length&&n.fileInput.each(function(e,t){var o=r(i[e]);r(t).prop("name",o.prop("name")),o.replaceWith(t)})}),a.append(s).appendTo(document.body)},abort:function(){s&&s.unbind("load").prop("src","javascript".concat(":false;")),a&&a.remove()}}}),r.ajaxSetup({converters:{"iframe text":function(e){return e&&r(e[0].body).text()},"iframe json":function(e){return e&&r.parseJSON(r(e[0].body).text())},"iframe html":function(e){return e&&r(e[0].body).html()},"iframe xml":function(e){var t=e&&e[0];return t&&r.isXMLDoc(t)?t:r.parseXML(t.XMLDocument&&t.XMLDocument.xml||r(t.body).html())},"iframe script":function(e){return e&&r.globalEval(r(e[0].body).text())}}})}),function(e,t){"object"==typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Spinner=t()}(this,function(){"use strict";function m(e,t){var o,i=document.createElement(e||"div");for(o in t)i[o]=t[o];return i}function g(e){for(var t=1,o=arguments.length;t<o;t++)e.appendChild(arguments[t]);return e}function i(e,t){var o,i,n=e.style;if(void 0!==n[t=t.charAt(0).toUpperCase()+t.slice(1)])return t;for(i=0;i<a.length;i++)if(void 0!==n[o=a[i]+t])return o}function b(e,t){for(var o in t)e.style[i(e,o)||o]=t[o];return e}function t(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)void 0===e[i]&&(e[i]=o[i])}return e}function v(e,t){return"string"==typeof e?e:e[t%e.length]}function o(e){this.opts=t(e||{},o.defaults,s)}var $,w,e,n,a=["webkit","Moz","ms","O"],y={},s={lines:12,length:7,width:5,radius:10,scale:1,corners:1,color:"#000",opacity:.25,rotate:0,direction:1,speed:1,trail:100,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",shadow:!1,hwaccel:!1,position:"relative"};function d(e,t){return m("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',t)}return o.defaults={},t(o.prototype,{spin:function(e){this.stop();var o,i,n,a,s,r,l,d=this,c=d.opts,u=d.el=m(null,{className:c.className});return b(u,{position:c.position,width:0,zIndex:c.zIndex,left:c.left,top:c.top}),e&&e.insertBefore(u,e.firstChild||null),u.setAttribute("role","progressbar"),d.lines(u,d.opts),$||(i=0,n=(c.lines-1)*(1-c.direction)/2,a=c.fps,s=a/c.speed,r=(1-c.opacity)/(s*c.trail/100),l=s/c.lines,function e(){i++;for(var t=0;t<c.lines;t++)o=Math.max(1-(i+(c.lines-t)*l)%s*r,c.opacity),d.opacity(u,t*c.direction+n,o,c);d.timeout=d.el&&setTimeout(e,~~(1e3/a))}()),d},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=void 0),this},lines:function(e,o){function t(e,t){return b(m(),{position:"absolute",width:o.scale*(o.length+o.width)+"px",height:o.scale*o.width+"px",background:e,boxShadow:t,transformOrigin:"left",transform:"rotate("+~~(360/o.lines*h+o.rotate)+"deg) translate("+o.scale*o.radius+"px,0)",borderRadius:(o.corners*o.scale*o.width>>1)+"px"})}for(var i,n,a,s,r,l,d,c,u,f,h=0,p=(o.lines-1)*(1-o.direction)/2;h<o.lines;h++)i=b(m(),{position:"absolute",top:1+~(o.scale*o.width/2)+"px",transform:o.hwaccel?"translate3d(0,0,0)":"",opacity:o.opacity,animation:$&&(n=o.opacity,a=o.trail,s=p+h*o.direction,r=o.lines,0,l=["opacity",a,~~(100*n),s,r].join("-"),d=.01+s/r*100,c=Math.max(1-(1-n)/a*(100-d),n),u=$.substring(0,$.indexOf("Animation")).toLowerCase(),f=u&&"-"+u+"-"||"",y[l]||(w.insertRule("@"+f+"keyframes "+l+"{0%{opacity:"+c+"}"+d+"%{opacity:"+n+"}"+(.01+d)+"%{opacity:1}"+(d+a)%100+"%{opacity:"+n+"}100%{opacity:"+c+"}}",w.cssRules.length),y[l]=1),l+" "+1/o.speed+"s linear infinite")}),o.shadow&&g(i,b(t("#000","0 0 4px #000"),{top:"2px"})),g(e,g(i,t(v(o.color,h),"0 0 1px rgba(0,0,0,.1)")));return e},opacity:function(e,t,o){t<e.childNodes.length&&(e.childNodes[t].style.opacity=o)}}),"undefined"!=typeof document&&(n=m("style",{type:"text/css"}),g(document.getElementsByTagName("head")[0],n),w=n.sheet||n.styleSheet,!i(e=b(m("group"),{behavior:"url(#default#VML)"}),"transform")&&e.adj?(w.addRule(".spin-vml","behavior:url(#default#VML)"),o.prototype.lines=function(e,i){function n(){return b(d("group",{coordsize:s+" "+s,coordorigin:-a+" "+-a}),{width:s,height:s})}function t(e,t,o){g(l,g(b(n(),{rotation:360/i.lines*e+"deg",left:~~t}),g(b(d("roundrect",{arcsize:i.corners}),{width:a,height:i.scale*i.width,left:i.scale*i.radius,top:-i.scale*i.width>>1,filter:o}),d("fill",{color:v(i.color,e),opacity:i.opacity}),d("stroke",{opacity:0}))))}var o,a=i.scale*(i.length+i.width),s=2*i.scale*a,r=-(i.width+i.length)*i.scale*2+"px",l=b(n(),{position:"absolute",top:r,left:r});if(i.shadow)for(o=1;o<=i.lines;o++)t(o,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(o=1;o<=i.lines;o++)t(o);return g(e,l)},o.prototype.opacity=function(e,t,o,i){var n=e.firstChild;i=i.shadow&&i.lines||0,n&&t+i<n.childNodes.length&&((n=(n=(n=n.childNodes[t+i])&&n.firstChild)&&n.firstChild)&&(n.opacity=o))}):$=i(e,"animation")),o}),function(e){if("object"==typeof exports)e(require("jquery"),require("spin"));else if("function"==typeof define&&define.amd)define(["jquery","spin"],e);else{if(!window.Spinner)throw new Error("Spin.js not present");e(window.jQuery,window.Spinner)}}(function(n,a){n.fn.spin=function(o,i){return this.each(function(){var e=n(this),t=e.data();t.spinner&&(t.spinner.stop(),delete t.spinner),!1!==o&&(o=n.extend({color:i||e.css("color")},n.fn.spin.presets[o]||o),t.spinner=new a(o).spin(this))})},n.fn.spin.presets={tiny:{lines:8,length:2,width:2,radius:3},small:{lines:8,length:4,width:3,radius:5},large:{lines:10,length:8,width:4,radius:8}}}),jQuery.fn.hasScrollBar=function(){var e={},t=this.get(0);return e.vertical=t.scrollHeight>t.clientHeight,e.horizontal=t.scrollWidth>t.clientWidth,e},function(i){function e(e,t){this.el=i(e),this.options=t||{},this.x=!1!==this.options.x||this.options.forceHorizontal,this.y=!1!==this.options.y||this.options.forceVertical,this.autoHide=!1!==this.options.autoHide,this.padding=null==this.options.padding?2:this.options.padding,this.inner=this.el.find(".antiscroll-inner"),this.inner.css({width:"+="+(this.y?a():0),height:"+="+(this.x?a():0)}),this.refresh()}function o(e){this.pane=e,this.pane.el.append(this.el),this.innerEl=this.pane.inner.get(0),this.dragging=!1,this.enter=!1,this.shown=!1,this.pane.el.mouseenter(i.proxy(this,"mouseenter")),this.pane.el.mouseleave(i.proxy(this,"mouseleave")),this.el.mousedown(i.proxy(this,"mousedown")),this.innerPaneScrollListener=i.proxy(this,"scroll"),this.pane.inner.scroll(this.innerPaneScrollListener),this.innerPaneMouseWheelListener=i.proxy(this,"mousewheel"),this.pane.inner.bind("mousewheel",this.innerPaneMouseWheelListener);var t=this.pane.options.initialDisplay;!1!==t&&(this.show(),this.pane.autoHide&&(this.hiding=setTimeout(i.proxy(this,"hide"),parseInt(t,10)||3e3)))}function t(e,t){function o(){}o.prototype=t.prototype,e.prototype=new o}var n;function a(){var e,t,o;return void 0===n&&(e=i('<div class="antiscroll-inner" style="width:50px;height:50px;overflow-y:scroll;position:absolute;top:-200px;left:-200px;"><div style="height:100px;width:100%"></div>'),i("body").append(e),t=i(e).innerWidth(),o=i("div",e).innerWidth(),i(e).remove(),n=t-o),n}i.fn.antiscroll=function(e){return this.each(function(){i(this).data("antiscroll")&&i(this).data("antiscroll").destroy(),i(this).data("antiscroll",new i.Antiscroll(this,e))})},(i.Antiscroll=e).prototype.refresh=function(){var e=this.inner.get(0).scrollWidth>this.el.width()+(this.y?a():0),t=this.inner.get(0).scrollHeight>this.el.height()+(this.x?a():0);this.x&&(!this.horizontal&&e?this.horizontal=new o.Horizontal(this):this.horizontal&&!e?(this.horizontal.destroy(),this.horizontal=null):this.horizontal&&this.horizontal.update()),this.y&&(!this.vertical&&t?this.vertical=new o.Vertical(this):this.vertical&&!t?(this.vertical.destroy(),this.vertical=null):this.vertical&&this.vertical.update())},e.prototype.destroy=function(){return this.horizontal&&(this.horizontal.destroy(),this.horizontal=null),this.vertical&&(this.vertical.destroy(),this.vertical=null),this},e.prototype.rebuild=function(){return this.destroy(),this.inner.attr("style",""),e.call(this,this.el,this.options),this},o.prototype.destroy=function(){return this.el.remove(),this.pane.inner.unbind("scroll",this.innerPaneScrollListener),this.pane.inner.unbind("mousewheel",this.innerPaneMouseWheelListener),this},o.prototype.mouseenter=function(){this.enter=!0,this.show()},o.prototype.mouseleave=function(){this.enter=!1,this.dragging||this.pane.autoHide&&this.hide()},o.prototype.scroll=function(){this.shown||(this.show(),this.enter||this.dragging||this.pane.autoHide&&(this.hiding=setTimeout(i.proxy(this,"hide"),1500))),this.update()},o.prototype.mousedown=function(e){e.preventDefault(),this.dragging=!0,this.startPageY=e.pageY-parseInt(this.el.css("top"),10),this.startPageX=e.pageX-parseInt(this.el.css("left"),10),this.el[0].ownerDocument.onselectstart=function(){return!1};this.pane;var t=i.proxy(this,"mousemove"),o=this;i(this.el[0].ownerDocument).mousemove(t).mouseup(function(){o.dragging=!1,this.onselectstart=null,i(this).unbind("mousemove",t),o.enter||o.hide()})},o.prototype.show=function(e){!this.shown&&this.update()&&(this.el.addClass("antiscroll-scrollbar-shown"),this.hiding&&(clearTimeout(this.hiding),this.hiding=null),this.shown=!0)},o.prototype.hide=function(){!1!==this.pane.autoHide&&this.shown&&(this.el.removeClass("antiscroll-scrollbar-shown"),this.shown=!1)},t(o.Horizontal=function(e){this.el=i('<div class="antiscroll-scrollbar antiscroll-scrollbar-horizontal">',e.el),o.call(this,e)},o),o.Horizontal.prototype.update=function(){var e=this.pane.el.width(),t=e-2*this.pane.padding,o=this.pane.inner.get(0);return this.el.css("width",t*e/o.scrollWidth).css("left",t*o.scrollLeft/o.scrollWidth),e<o.scrollWidth},o.Horizontal.prototype.mousemove=function(e){var t=this.pane.el.width()-2*this.pane.padding,o=e.pageX-this.startPageX,i=this.el.width(),n=this.pane.inner.get(0),a=Math.min(Math.max(o,0),t-i);n.scrollLeft=(n.scrollWidth-this.pane.el.width())*a/(t-i)},o.Horizontal.prototype.mousewheel=function(e,t,o,i){if(o<0&&0==this.pane.inner.get(0).scrollLeft||0<o&&this.innerEl.scrollLeft+Math.ceil(this.pane.el.width())==this.innerEl.scrollWidth)return e.preventDefault(),!1},t(o.Vertical=function(e){this.el=i('<div class="antiscroll-scrollbar antiscroll-scrollbar-vertical">',e.el),o.call(this,e)},o),o.Vertical.prototype.update=function(){var e=this.pane.el.height(),t=e-2*this.pane.padding,o=this.innerEl,i=(i=t*e/o.scrollHeight)<20?20:i,n=t*o.scrollTop/o.scrollHeight;return t<n+i&&(n=n-(n+i-t)-3),this.el.css("height",i).css("top",n),e<o.scrollHeight},o.Vertical.prototype.mousemove=function(e){var t=this.pane.el.height(),o=t-2*this.pane.padding,i=e.pageY-this.startPageY,n=this.el.height(),a=this.innerEl,s=Math.min(Math.max(i,0),o-n);a.scrollTop=(a.scrollHeight-t)*s/(o-n)},o.Vertical.prototype.mousewheel=function(e,t,o,i){if(0<i&&0==this.innerEl.scrollTop||i<0&&this.innerEl.scrollTop+Math.ceil(this.pane.el.height())==this.innerEl.scrollHeight)return e.preventDefault(),!1}}(jQuery),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(d){var c,u,e=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],t="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];if(d.event.fixHooks)for(var o=e.length;o;)d.event.fixHooks[e[--o]]=d.event.mouseHooks;function i(e){var t,o,i,n=e||window.event,a=[].slice.call(arguments,1),s=0,r=0,l=0;return(e=d.event.fix(n)).type="mousewheel",n.wheelDelta&&(s=n.wheelDelta),n.detail&&(s=-1*n.detail),n.deltaY&&(s=l=-1*n.deltaY),n.deltaX&&(s=-1*(r=n.deltaX)),void 0!==n.wheelDeltaY&&(l=n.wheelDeltaY),void 0!==n.wheelDeltaX&&(r=-1*n.wheelDeltaX),t=Math.abs(s),(!c||t<c)&&(c=t),o=Math.max(Math.abs(l),Math.abs(r)),(!u||o<u)&&(u=o),i=0<s?"floor":"ceil",s=Math[i](s/c),r=Math[i](r/u),l=Math[i](l/u),a.unshift(e,s,r,l),(d.event.dispatch||d.event.handle).apply(this,a)}d.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=t.length;e;)this.addEventListener(t[--e],i,!1);else this.onmousewheel=i},teardown:function(){if(this.removeEventListener)for(var e=t.length;e;)this.removeEventListener(t[--e],i,!1);else this.onmousewheel=null}},d.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),function(o){o.fn.delayedAction=function(e){var t=o.extend({},{delayedAction:function(){},cancelledAction:function(){},hoverTime:1e3},e);return this.each(function(){var e=o(this);e.hover(function(){e.data("timerId",setTimeout(function(){e.data("hover",!1),t.delayedAction(e)},t.hoverTime)),e.data("hover",!0)},function(){e.data("hover")&&(clearTimeout(e.data("timerId")),t.cancelledAction(e)),e.data("hover",!1)})})}}(jQuery),function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Clipboard=e()}(function(){return function a(s,r,l){function d(o,e){if(!r[o]){if(!s[o]){var t="function"==typeof require&&require;if(!e&&t)return t(o,!0);if(c)return c(o,!0);var i=new Error("Cannot find module '"+o+"'");throw i.code="MODULE_NOT_FOUND",i}var n=r[o]={exports:{}};s[o][0].call(n.exports,function(e){var t=s[o][1][e];return d(t||e)},n,n.exports,a,s,r,l)}return r[o].exports}for(var c="function"==typeof require&&require,e=0;e<l.length;e++)d(l[e]);return d}({1:[function(e,t,o){var n=e("matches-selector");t.exports=function(e,t,o){for(var i=o?e:e.parentNode;i&&i!==document;){if(n(i,t))return i;i=i.parentNode}}},{"matches-selector":5}],2:[function(e,t,o){var s=e("closest");t.exports=function(e,t,o,i,n){var a=function(t,o,e,i){return function(e){e.delegateTarget=s(e.target,o,!0),e.delegateTarget&&i.call(t,e)}}.apply(this,arguments);return e.addEventListener(o,a,n),{destroy:function(){e.removeEventListener(o,a,n)}}}},{closest:1}],3:[function(e,t,o){o.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},o.nodeList=function(e){var t=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===t||"[object HTMLCollection]"===t)&&"length"in e&&(0===e.length||o.node(e[0]))},o.string=function(e){return"string"==typeof e||e instanceof String},o.fn=function(e){return"[object Function]"===Object.prototype.toString.call(e)}},{}],4:[function(e,t,o){var f=e("./is"),h=e("delegate");t.exports=function(e,t,o){if(!e&&!t&&!o)throw new Error("Missing required arguments");if(!f.string(t))throw new TypeError("Second argument must be a String");if(!f.fn(o))throw new TypeError("Third argument must be a Function");if(f.node(e))return n=t,a=o,(i=e).addEventListener(n,a),{destroy:function(){i.removeEventListener(n,a)}};var i,n,a,s,r,l,d,c,u;if(f.nodeList(e))return s=e,r=t,l=o,Array.prototype.forEach.call(s,function(e){e.addEventListener(r,l)}),{destroy:function(){Array.prototype.forEach.call(s,function(e){e.removeEventListener(r,l)})}};if(f.string(e))return d=e,c=t,u=o,h(document.body,d,c,u);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}},{"./is":3,delegate:2}],5:[function(e,t,o){var i=Element.prototype,n=i.matchesSelector||i.webkitMatchesSelector||i.mozMatchesSelector||i.msMatchesSelector||i.oMatchesSelector;t.exports=function(e,t){if(n)return n.call(e,t);for(var o=e.parentNode.querySelectorAll(t),i=0;i<o.length;++i)if(o[i]==e)return!0;return!1}},{}],6:[function(e,t,o){t.exports=function(e){var t,o,i="INPUT"===e.nodeName||"TEXTAREA"===e.nodeName?(e.focus(),e.setSelectionRange(0,e.value.length),e.value):(e.hasAttribute("contenteditable")&&e.focus(),t=window.getSelection(),(o=document.createRange()).selectNodeContents(e),t.removeAllRanges(),t.addRange(o),t.toString());return i}},{}],7:[function(e,t,o){function i(){}i.prototype={on:function(e,t,o){var i=this.e||(this.e={});return(i[e]||(i[e]=[])).push({fn:t,ctx:o}),this},once:function(e,t,o){function i(){n.off(e,i),t.apply(o,arguments)}var n=this;return i._=t,this.on(e,i,o)},emit:function(e){for(var t=[].slice.call(arguments,1),o=((this.e||(this.e={}))[e]||[]).slice(),i=0,n=o.length;i<n;i++)o[i].fn.apply(o[i].ctx,t);return this},off:function(e,t){var o=this.e||(this.e={}),i=o[e],n=[];if(i&&t)for(var a=0,s=i.length;a<s;a++)i[a].fn!==t&&i[a].fn._!==t&&n.push(i[a]);return n.length?o[e]=n:delete o[e],this}},t.exports=i},{}],8:[function(e,t,o){"use strict";o.__esModule=!0;var i,n=function(e,t,o){return t&&d(e.prototype,t),o&&d(e,o),e},a=e("select"),s=(i=a)&&i.__esModule?i:{default:i},r=(l.prototype.resolveOptions=function(e){var t=arguments.length<=0||void 0===e?{}:e;this.action=t.action,this.emitter=t.emitter,this.target=t.target,this.text=t.text,this.trigger=t.trigger,this.selectedText=""},l.prototype.initSelection=function(){if(this.text&&this.target)throw new Error('Multiple attributes declared, use either "target" or "text"');if(this.text)this.selectFake();else{if(!this.target)throw new Error('Missing required attributes, use either "target" or "text"');this.selectTarget()}},l.prototype.selectFake=function(){var e=this,t="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandler=document.body.addEventListener("click",function(){return e.removeFake()}),this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[t?"right":"left"]="-9999px",this.fakeElem.style.top=(window.pageYOffset||document.documentElement.scrollTop)+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,document.body.appendChild(this.fakeElem),this.selectedText=s.default(this.fakeElem),this.copyText()},l.prototype.removeFake=function(){this.fakeHandler&&(document.body.removeEventListener("click"),this.fakeHandler=null),this.fakeElem&&(document.body.removeChild(this.fakeElem),this.fakeElem=null)},l.prototype.selectTarget=function(){this.selectedText=s.default(this.target),this.copyText()},l.prototype.copyText=function(){var t=void 0;try{t=document.execCommand(this.action)}catch(e){t=!1}this.handleResult(t)},l.prototype.handleResult=function(e){e?this.emitter.emit("success",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)}):this.emitter.emit("error",{action:this.action,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})},l.prototype.clearSelection=function(){this.target&&this.target.blur(),window.getSelection().removeAllRanges()},l.prototype.destroy=function(){this.removeFake()},n(l,[{key:"action",set:function(e){var t=arguments.length<=0||void 0===e?"copy":e;if(this._action=t,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(e){if(void 0!==e){if(!e||"object"!=typeof e||1!==e.nodeType)throw new Error('Invalid "target" value, use a valid Element');this._target=e}},get:function(){return this._target}}]),l);function l(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,l),this.resolveOptions(e),this.initSelection()}function d(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}o.default=r,t.exports=o.default},{select:6}],9:[function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){var o="data-clipboard-"+e;if(t.hasAttribute(o))return t.getAttribute(o)}o.__esModule=!0;var a,s=i(e("./clipboard-action")),r=i(e("tiny-emitter")),l=i(e("good-listener")),d=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,a=r.default),c.prototype.resolveOptions=function(e){var t=arguments.length<=0||void 0===e?{}:e;this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText},c.prototype.listenClick=function(e){var t=this;this.listener=l.default(e,"click",function(e){return t.onClick(e)})},c.prototype.onClick=function(e){var t=e.delegateTarget||e.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new s.default({action:this.action(t),target:this.target(t),text:this.text(t),trigger:t,emitter:this})},c.prototype.defaultAction=function(e){return n("action",e)},c.prototype.defaultTarget=function(e){var t=n("target",e);return t?document.querySelector(t):void 0},c.prototype.defaultText=function(e){return n("text",e)},c.prototype.destroy=function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)},c);function c(e,t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,c),a.call(this),this.resolveOptions(t),this.listenClick(e)}o.default=d,t.exports=o.default},{"./clipboard-action":8,"good-listener":4,"tiny-emitter":7}]},{},[9])(9)}),$(function(){$(window).on("resize",function(){CHV.fn.uploader.boxSizer(),"function"==typeof user_background_full_fix&&user_background_full_fix(),CHV.fn.bindSelectableItems(),CHV.fn.listingViewer.placeholderSizing()}),window.opener&&"/upload"==window.location.pathname&&""==window.location.search.substr(1)&&($(window).on("load",function(e){window.opener.postMessage({id:window.name,requestAction:"postSettings"},"*")}),$(window).on("message",function(e){var t=e.originalEvent.data;void 0!==t.id&&void 0!==t.settings&&window.name===t.id&&(CHV.obj.opener.uploadPlugin[t.id]=t.settings)}));var e,t,o,i,n,a=CHV.fn.uploader.selectors.root,s=CHV.fn.uploader.selectors.queue,r=$(a),l=$(s);function d(e){var t=!1;if((e=e.originalEvent).dataTransfer.types)for(var o=0;o<e.dataTransfer.types.length;o++)if("Files"==e.dataTransfer.types[o]){t=!0;break}return t}$(document).on("click","[data-action=top-bar-upload]",function(e){$("body").is("#upload")||1==$(this).data("link")||CHV.fn.uploader.toggle()}),$("[data-action=close-upload]",r).click(function(){r.is(":animated")||$("[data-action=top-bar-upload]","#top-bar").click()}),$("[data-action=reset-upload]",r).click(function(){CHV.fn.uploader.isUploading&&$("[data-action=cancel-upload-remaining], [data-action=cancel-upload]",r).trigger("click"),CHV.fn.uploader.reset()}),$("[data-action=cancel-upload-remaining], [data-action=cancel-upload]",r).click(function(){CHV.fn.uploader.isUploading=!1,$("[data-action=cancel]",l).click(),0<Object.size(CHV.fn.uploader.results.success)?CHV.fn.uploader.displayResults():CHV.fn.uploader.reset()}),$(CHV.fn.uploader.selectors.file+", "+CHV.fn.uploader.selectors.camera).on("change",function(e){$(CHV.fn.uploader.selectors.root).data("shown")?CHV.fn.uploader.add(e):CHV.fn.uploader.toggle({callback:function(e){CHV.fn.uploader.add(e)}},e)}).on("click",function(e){$(this).data("login-needed")&&PF.fn.is_user_logged()}),$(CHV.fn.uploader.selectors.root).exists()&&($("body").on({dragenter:function(e){if(e.preventDefault(),!d(e))return!1;$(CHV.fn.uploader.selectors.dropzone).exists()||$("body").append($('<div id="'+CHV.fn.uploader.selectors.dropzone.replace("#","")+'"/>').css({width:"100%",height:"100%",position:"fixed",zIndex:1e3,left:0,top:0}))}}),$(document).on({dragover:function(e){if(e.preventDefault(),!d(e))return!1;$(CHV.fn.uploader.selectors.root).data("shown")||CHV.fn.uploader.toggle({reset:!1})},dragleave:function(e){$(CHV.fn.uploader.selectors.dropzone).remove(),$.isEmptyObject(CHV.fn.uploader.files)&&CHV.fn.uploader.toggle()},drop:function(e){e.preventDefault(),CHV.fn.uploader.add(e),$(CHV.fn.uploader.selectors.dropzone).remove()}},CHV.fn.uploader.selectors.dropzone)),$(document).on("keyup change","[data-action=resize-combo-input]",function(e){var t=$(this).closest("[data-action=resize-combo-input]"),o=$("[name=form-width]",t),i=$("[name=form-height]",t),n=o.data("initial")/i.data("initial"),a={width:Math.round(o.prop("value")/n),height:Math.round(i.prop("value")*n)};$(e.target).is(o)?i.prop("value",Math.round(a.width)):o.prop("value",Math.round(a.height))}),$(document).on("click",s+" [data-action=edit]",function(){for(var e=$(this).closest("li"),o=(e.closest("ul"),e.data("id")),s=CHV.fn.uploader.files[o],r=PF.obj.modal.selectors.root,i=$.extend({},s.formValues||s.parsedMeta),t=["album_id","category_id"],n=0;n<t.length;n++){var a,l,d=t[n];void 0===i[d]&&(l=(a=$("[name=upload-"+d.replace("_","-")+"]",CHV.fn.uploader.selectors.root)).prop(a.is(":checkbox")?"checked":"value"),i[d]=a.is(":checkbox")?l?"1":null:l)}PF.fn.modal.call({type:"html",template:$("#anywhere-upload-edit-item").html(),callback:function(){var e,t;$.each(i,function(e,t){var o,i="[name=form-"+e.replace(/_/g,"-")+"]",n=$(i,r);if(!n.exists())return!0;n.is(":checkbox")?n.prop("checked",n.attr("value")==t):n.is("select")?((o=n.find('[value="'+t+'"]')).exists()||(o=n.find("option:first")),o.prop("selected",!0)):n.prop("value",t),"width"!=e&&"height"!=e||n.prop("max",s.parsedMeta[e]).data("initial",s.parsedMeta[e])}),"image/gif"!==s.parsedMeta.mimetype&&$("[ data-content=animated-gif-warning]",r).remove(),!$(".image-preview",r).length||-1===(e=$(".queue-item[data-id="+o+"] .preview .canvas")[0]).className.indexOf("icon")&&($(".image-preview",r).append($("<canvas/>",{class:"canvas"})),(t=$(".image-preview .canvas",r)[0]).width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0))},confirm:function(){if(PF.fn.form_modal_has_changed()){var a=!1;return($.each(["width","height"],function(e,t){var o=$("[name=form-"+t+"]",r),i=parseInt(o.val()),n=parseInt(o.attr("min"));if(parseInt(o.attr("max"))<i||i<n)return o.highlight(),a=!0}),a)?(PF.fn.growl.expirable(PF.fn._s("Check the errors in the form to continue.")),!1):(void 0===s.formValues&&(s.formValues={title:null,category_id:null,width:null,height:null,nsfw:null,expiration:null,description:null,album_id:null}),$(":input[name]",r).each(function(e,t){var o=$(this).attr("name").replace("form-","").replace(/-/g,"_");if(void 0===s.formValues[o])return!0;s.formValues[o]=!$(this).is(":checkbox")||$(this).is(":checked")?$(this).prop("value"):null}),CHV.fn.uploader.files[o].formValues=s.formValues,!0)}PF.fn.modal.close()}})}),$(document).on("click",s+" [data-action=cancel]",function(){var e,t,o=$(this).closest("li"),i=o.closest("ul"),n=o.data("id"),a=i.height(),s=!1;o.hasClass("completed")||o.hasClass("failed")||($("#tiptip_holder").hide(),o.tipTip("destroy").remove(),a!==i.height()&&CHV.fn.uploader.boxSizer(),$("li",l).exists()||$("[data-group=upload-queue-ready], [data-group=upload-queue], [data-group=upload-queue-ready]",r).css("display",""),CHV.fn.uploader.files[n]&&void 0!==CHV.fn.uploader.files[n].xhr&&(CHV.fn.uploader.files[n].xhr.abort(),s=!0),void 0!==CHV.fn.uploader.files[n]&&void 0!==CHV.fn.uploader.files[n].fromClipboard&&(e=CHV.fn.uploader.files[n].md5,-1<(t=CHV.fn.uploader.clipboardImages.indexOf(e))&&CHV.fn.uploader.clipboardImages.splice(t,1)),delete CHV.fn.uploader.files[n],CHV.fn.uploader.queueSize(),0==Object.size(CHV.fn.uploader.files)?"success"in CHV.fn.uploader&&"results"in CHV.fn.uploader&&(0!=Object.size(CHV.fn.uploader.results.success)||0!=Object.size(CHV.fn.uploader.results.error))||CHV.fn.uploader.reset():s&&0!==$("li.waiting",i).first().length&&CHV.fn.uploader.upload($("li.waiting",i).first()))}),$(document).on("click","[data-action=upload]",function(){$("[data-group=upload], [data-group=upload-queue-ready]",r).hide(),r.removeClass("queueReady").addClass("queueUploading").find("[data-group=uploading]").show(),CHV.fn.uploader.queueSize(),CHV.fn.uploader.canAdd=!1,$queue_items=$("li",l),$queue_items.addClass("uploading waiting"),CHV.fn.uploader.timestamp=(new Date).getTime(),CHV.fn.uploader.upload($queue_items.first("li"))}),$("body#user").exists()&&1<PF.obj.listing.query_string.page&&((e=History.getState()).data&&void 0!==e.data.scrollTop?$(window).scrollTop()!==e.data.scrollTop&&$(window).scrollTop(e.data.scrollTop):(t=$("#background-cover").height()-160,$("html, body").animate({scrollTop:t},0))),$("#top-bar-shade").exists()&&$("#top-bar-shade").css("opacity")&&$("#top-bar-shade").data("initial-opacity",Number($("#top-bar-shade").css("opacity"))),$(window).on("scroll resize",function(){var e,t,o=$(window).scrollTop();o<0||(e=$("#top-bar"),1<(t=Number(o/($("#background-cover, [data-content=follow-scroll-opacity]").height()-e.height())))&&(t=1),$("#top-bar-shade").data("initial-opacity")&&(t+=$("#top-bar-shade").data("initial-opacity")),$("#top-bar-shade").css({opacity:t}),$("#background-cover-src").css({transform:"translate(0, "+.8*o+"px)"}))}),CHV.fn.bindSelectableItems(),$("body#image").exists()&&(0<$(CHV.obj.image_viewer.selector+" [data-load=full]").length?($(document).on("click",CHV.obj.image_viewer.loader,function(e){CHV.fn.viewerLoadImage()}),$(CHV.obj.image_viewer.loader).data("size")>CHV.obj.config.image.load_max_filesize?$(CHV.obj.image_viewer.loader).css("display","block"):CHV.fn.viewerLoadImage(),$(document).bind("DOMSubtreeModified",function(){$("html").height()>$(window).innerHeight()&&!$("html").hasClass("scrollbar-y")&&($("html").addClass("scrollbar-y"),$(document).data({width:$(this).width(),height:$(this).height()}),clearTimeout(o),o=setTimeout(CHV.fn.image_viewer_full_fix,100))}),$(window).on("resize",function(){clearTimeout(o),o=setTimeout(CHV.fn.image_viewer_full_fix,100)})):CHV.fn.viewerImageZoomClass(),$(document).on("keyup",function(e){var t,o=$(e.target),i=e.charCode||e.keyCode;o.is(":input")||!CHV.obj.image_viewer.$navigation.exists()||37!=i&&39!=i&&65!=i&&68!=i||void 0!==(t=$("[data-action="+(37==i||65==i?"prev":"next")+"]",CHV.obj.image_viewer.$navigation).attr("href"))&&""!==t&&(window.location=$("[data-action="+(37==i||65==i?"prev":"next")+"]",CHV.obj.image_viewer.$navigation).attr("href"))})),$(document).on("click",CHV.obj.image_viewer.container,function(e){var t,o,i,n,a;($(this).hasClass("cursor-zoom-in")||$(this).hasClass("cursor-zoom-out"))&&(t=$(this).hasClass("cursor-zoom-in"),$(this).removeClass("cursor-zoom-in cursor-zoom-out"),t?(o=$(this)[0].getBoundingClientRect().width,i=$(this)[0].getBoundingClientRect().height,n=$("img",this).attr("width")/$("img",this).attr("height"),void 0===$(this).data("dimentions")&&$(this).data({dimentions:{width:o,height:i},ratio:n}),$("img",this).attr("width")>$(window).width()?($(this).css({width:"100%"}),a=$(this).width(),$(this).css({width:o})):a=$("img",this).attr("width"),$(this).addClass("cursor-zoom-out").css({width:a,height:a/n+"px"})):$(this).addClass("cursor-zoom-in").css($(this).data("dimentions")),e.preventDefault())}),$(document).on("contextmenu","html.device-mobile a.image-container",function(e){return e.preventDefault(),!1}),$(document).on("click","[data-action=openerPostMessage]",function(e){var t,o,i;window.opener&&(e.preventDefault(),t="data-action-target",i=(o=$($(this).is("["+t+"]")?$(this).attr(t):this))[o.is(":input")?"val":"html"](),window.opener.postMessage({id:window.name,message:i},"*"))}),$(document).on("click","[data-action=list-tools] [data-action]",function(e){var t=$(e.target).closest("[data-id]");t&&t.find("[data-action=select]").exists()&&(e.ctrlKey||e.metaKey)&&e.altKey&&(CHV.fn.list_editor.toggleSelectItem(t,!t.hasClass("selected")),e.preventDefault(),e.stopPropagation())}),PF.fn.listing.ajax.callback=function(e){200===e.status&&CHV.fn.list_editor.listMassActionSet("select")},$(document).on("click","[data-action=list-select-all]",function(){CHV.fn.list_editor.selectItem($(".list-item:visible:not(.selected)")),CHV.fn.list_editor.listMassActionSet("clear")}),$(document).on("click","[data-action=list-clear-all]",function(){PF.fn.close_pops(),CHV.fn.list_editor.clearSelection()}),$(document).on("click","[data-action=list-tools] [data-action]",function(e){if(e.isPropagationStopped())return!1;var t=$(this).closest(PF.obj.listing.selectors.list_item+", .viewer"),o=t.attr("data-id");if(void 0!==t.attr("data-type")){i=t.attr("data-type");var i,n=$("[data-type="+i+"][data-id="+o+"]").not(".viewer");switch($(this).data("action")){case"select":CHV.fn.list_editor.toggleSelectItem(t,!t.hasClass("selected"));break;case"codes":var a="[data-modal=form-embed-codes]",s=[];$("textarea",a).html(""),n.each(function(){s.push({image:$.parseJSON(decodeURIComponent($(this).data("object")))})}),CHV.fn.fillEmbedCodes(s,a,"html"),PF.fn.modal.call({type:"html",template:$(a).html(),buttons:!1});break;case"edit":var r="[data-modal=form-edit-single]";switch(i){case"image":$("[name=form-image-title]",r).attr("value",t.attr("data-title")),$("[name=form-image-description]",r).html(PF.fn.htmlEncode(t.attr("data-description"))),$("[name=form-album-id]",r).find("option").removeAttr("selected"),$("[name=form-album-id]",r).find('[value="'+t.attr("image"==i?"data-album-id":"data-id")+'"]').attr("selected",!0),$("[name=form-category-id]",r).find("option").removeAttr("selected"),$("[name=form-category-id]",r).find('[value="'+t.attr("data-category-id")+'"]').attr("selected",!0),$("[name=form-album-name]",r).attr("value",""),$("[name=form-album-description]",r).html(""),$("[name=form-privacy]",r).find("option").removeAttr("selected");break;case"album":$("[data-action=album-switch]",r).remove(),$("[name=form-album-name]",r).attr("value",t.attr("data-name")),$("[name=form-album-description]",r).html(PF.fn.htmlEncode(t.attr("data-description"))),$("[name=form-privacy]",r).find("option").removeAttr("selected"),$("[name=form-privacy]",r).find('[value="'+t.attr("data-privacy")+'"]').attr("selected",!0),"password"==t.attr("data-privacy")?($("[data-combo-value=password]").show(),$("[name=form-album-password]",r).attr("value",t.attr("data-password"))):($("[data-combo-value=password]").hide(),$("[name=form-album-password]",r).attr("value",""))}PF.fn.modal.call({type:"html",template:$(r).html(),ajax:{url:PF.obj.config.json_api,deferred:{success:function(e){CHV.fn.list_editor.updateItem("[data-type="+i+"][data-id="+o+"]",e.responseJSON[i],"edit")}}},confirm:function(){var e=$(PF.obj.modal.selectors.root);if(("image"==i||"album"==i)&&$("[data-content=form-new-album]",e).is(":visible")&&""==$("[name=form-album-name]",e).val())return PF.fn.growl.call(PF.fn._s("You must enter the album name.")),$("[name=form-album-name]",e).highlight(),!1;if(PF.fn.form_modal_has_changed()){switch(PF.obj.modal.form_data={action:"edit",edit:t.attr("data-type"),single:!0,owner:CHV.obj.resource.user.id,editing:{id:o,description:$("[name=form-"+i+"-description]",e).val()}},i){case"image":PF.obj.modal.form_data.editing.title=$("[name=form-image-title]",e).val(),PF.obj.modal.form_data.editing.category_id=$("[name=form-category-id]",e).val()||null,PF.obj.modal.form_data.editing.nsfw=$("[name=form-nsfw]",e).prop("checked")?1:0;break;case"album":PF.obj.modal.form_data.editing.name=$("[name=form-album-name]",e).val(),PF.obj.modal.form_data.editing.privacy=$("[name=form-privacy]",e).val(),"password"==PF.obj.modal.form_data.editing.privacy&&(PF.obj.modal.form_data.editing.password=$("[name=form-album-password]",e).val())}return PF.obj.modal.form_data.editing.new_album=$("[data-content=form-new-album]",e).is(":visible"),PF.obj.modal.form_data.editing.new_album?(PF.obj.modal.form_data.editing.album_name=$("[name=form-album-name]",e).val(),PF.obj.modal.form_data.editing.album_privacy=$("[name=form-privacy]",e).val(),"password"==PF.obj.modal.form_data.editing.album_privacy&&(PF.obj.modal.form_data.editing.album_password=$("[name=form-album-password]",e).val()),PF.obj.modal.form_data.editing.album_description=$("[name=form-album-description]",e).val()):PF.obj.modal.form_data.editing.album_id=$("[name=form-album-id]",e).val(),!0}PF.fn.modal.close()}});break;case"move":r="[data-modal=form-move-single]";$("[name=form-album-id]",r).find("option").removeAttr("selected"),$("[name=form-album-id]",r).find('[value="'+t.attr("image"==i?"data-album-id":"data-id")+'"]').attr("selected",!0),$("[name=form-album-name]",r).attr("value",""),$("[name=form-album-description]",r).html(""),$("[name=form-privacy]",r).find("option").removeAttr("selected"),PF.fn.modal.call({type:"html",template:$(r).html(),ajax:{url:PF.obj.config.json_api,deferred:{success:function(e){CHV.fn.list_editor.updateMoveItemLists(e.responseJSON,i,n)}}},load:function(){},confirm:function(){var e=$(PF.obj.modal.selectors.root);return $("[data-content=form-new-album]",e).is(":visible")&&""==$("[name=form-album-name]",e).val()?(PF.fn.growl.call(PF.fn._s("You must enter the album name.")),$("[name=form-album-name]",e).highlight(),!1):PF.fn.form_modal_has_changed()?(PF.obj.modal.form_data={action:"edit",edit:t.attr("data-type"),single:!0,owner:CHV.obj.resource.user.id,editing:{id:o}},PF.obj.modal.form_data.editing.new_album=$("[data-content=form-new-album]",e).is(":visible"),PF.obj.modal.form_data.editing.new_album?(PF.obj.modal.form_data.editing.album_name=$("[name=form-album-name]",e).val(),PF.obj.modal.form_data.editing.album_privacy=$("[name=form-privacy]",e).val(),"password"==PF.obj.modal.form_data.editing.album_privacy&&(PF.obj.modal.form_data.editing.album_password=$("[name=form-album-password]",e).val()),PF.obj.modal.form_data.editing.album_description=$("[name=form-album-description]",e).val()):PF.obj.modal.form_data.editing.album_id=$("[name=form-album-id]",e).val(),!0):void PF.fn.modal.close()}});break;case"delete":PF.fn.modal.call({type:"html",template:$("[data-modal=form-delete-single]").html(),button_submit:PF.fn._s("Confirm"),ajax:{url:PF.obj.config.json_api,deferred:{success:function(e){"album"==i&&($("[name=form-album-id]","[data-modal]").find('[value="'+o+'"]').remove(),CHV.fn.list_editor.updateUserCounters("image",e.responseJSON.success.affected,"-")),CHV.fn.list_editor.deleteFromList(t)}}},confirm:function(){return PF.obj.modal.form_data={action:"delete",single:!0,delete:t.attr("data-type"),deleting:{id:o}},!0}})}}else console.log("Error: data-type not defined")}),$(".pop-box-menu a","[data-content=list-selection]").click(function(e){var t=$(PF.obj.listing.selectors.content_listing_visible);if(void 0!==t.data("list")){dealing_with=t.data("list");var o=$(PF.obj.listing.selectors.list_item+".selected",t),i=$.map(o,function(e,t){return $(e).data("id")});switch($(this).closest(".pop-btn").click(),$(this).data("action")){case"get-embed-codes":var n="[data-modal=form-embed-codes]",a=[];$("textarea",n).html(""),o.each(function(){a.push({image:$.parseJSON(decodeURIComponent($(this).data("object")))})}),CHV.fn.fillEmbedCodes(a,n,"html"),PF.fn.modal.call({type:"html",template:$(n).html(),buttons:!1});break;case"clear":CHV.fn.list_editor.clearSelection(),e.stopPropagation();break;case"move":case"create-album":var s="[data-modal="+(n="move"==$(this).data("action")?"form-move-multiple":"form-create-album")+"]",r=/image/.test(dealing_with)?"album-id":"id";$("[name=form-album-id]",s).find("[value=null]").remove(),$("[name=form-album-id]",s).find("option").removeAttr("selected"),$("[name=form-album-name]",s).attr("value",""),$("[name=form-album-description]",s).html(""),$("[name=form-privacy]",s).find("option").removeAttr("selected");var l=o.first().data(r),d=!0;o.each(function(){if($(this).data(r)!==l)return d=!1}),d||$("[name=form-album-id]",s).prepend('<option value="null">'+PF.fn._s("Select existing album")+"</option>"),$("[name=form-album-id]",s).find('[value="'+(d?o.first().data(r):"null")+'"]').attr("selected",!0),PF.fn.modal.call({type:"html",template:$(s).html(),ajax:{url:PF.obj.config.json_api,deferred:{success:function(e){CHV.fn.list_editor.updateMoveItemLists(e.responseJSON,dealing_with,o)}}},load:function(){},confirm:function(){var e=$(PF.obj.modal.selectors.root),t=!1;if($("[data-content=form-new-album]",e).is(":visible")&&""==$("[name=form-album-name]",e).val())return PF.fn.growl.call(PF.fn._s("You must enter the album name.")),$("[name=form-album-name]",e).highlight(),!1;if($("[data-content=form-new-album]",e).is(":visible")&&(t=!0),PF.fn.form_modal_has_changed()){return PF.obj.modal.form_data={action:t?"create-album":"move",type:dealing_with,owner:CHV.obj.resource.user.id,multiple:!0,album:{ids:i,new:t}},t?(PF.obj.modal.form_data.album.name=$("[name=form-album-name]",e).val(),PF.obj.modal.form_data.album.privacy=$("[name=form-privacy]",e).val(),"password"==PF.obj.modal.form_data.album.privacy&&(PF.obj.modal.form_data.album.password=$("[name=form-album-password]",e).val()),PF.obj.modal.form_data.album.description=$("[name=form-album-description]",e).val()):PF.obj.modal.form_data.album.id=$("[name=form-album-id]",e).val(),!0}PF.fn.modal.close()}});break;case"delete":PF.fn.modal.call({template:$("[data-modal=form-delete-multiple]").html(),button_submit:PF.fn._s("Confirm"),ajax:{url:PF.obj.config.json_api,deferred:{success:function(e){"albums"==dealing_with&&(o.each(function(){$("[name=form-album-id]","[data-modal]").find('[value="'+$(this).data("id")+'"]').remove()}),CHV.fn.list_editor.updateUserCounters("image",e.responseJSON.success.affected,"-")),CHV.fn.list_editor.deleteFromList(o)}}},confirm:function(){return PF.obj.modal.form_data={action:"delete",from:"list",delete:dealing_with,multiple:!0,deleting:{ids:i}},!0}})}return!PF.fn.isDevice(["phone","phablet"])&&void 0}console.log("Error: data-list not defined")}),$("body#image").exists()&&$(window).scroll(function(){CHV.obj.topBar.transparencyScrollToggle()}),$(document).on("click","[data-action=disconnect]",function(){var e=$(this),o=e.data("connection");PF.fn.modal.confirm({message:e.data("confirm-message"),ajax:{data:{action:"disconnect",disconnect:o,user_id:CHV.obj.resource.user.id},deferred:{success:function(e){var t=e.responseJSON;$("[data-connection="+o+"]").fadeOut(function(){$($("[data-connect="+o+"]")).fadeIn(),$(this).remove(),0==$("[data-connection]").length&&$("[data-content=empty-message]").show(),PF.fn.growl.expirable(t.success.message)})},error:function(e){var t=e.responseJSON;PF.fn.growl.call(t.error.message)}}}})}),$(document).on("click","[data-action=delete-avatar]",function(){var t=$(".user-settings-avatar"),o=$(".loading-placeholder",t),i=$("#top-bar");o.removeClass("hidden"),PF.fn.loading.inline(o,{center:!0}),$.ajax({type:"POST",data:{action:"delete",delete:"avatar",owner:CHV.obj.resource.user.id}}).complete(function(e){o.addClass("hidden").empty(),200==e.status?(CHV.obj.logged_user.id==CHV.obj.resource.user.id&&($("img.user-image",i).hide(),$(".default-user-image",i).removeClass("hidden")),$(".default-user-image",t).removeClass("hidden").css({opacity:0}),$(".btn-alt",t).closest("div").hide(),$("img.user-image",t).fadeOut(function(){$(".default-user-image",t).animate({opacity:1})})):PF.fn.growl.expirable(PF.fn._s("An error occurred. Please try again later."))})}),$(document).on("change","[data-content=user-avatar-upload-input]",function(e){e.preventDefault(),e.stopPropagation();var t,o=$(this),i=$(".user-settings-avatar"),n=$(".loading-placeholder",".user-settings-avatar"),a=$("#top-bar"),s=$(this)[0].files[0];o.data("uploading")||(0!=/^image\/.*$/.test(s.type)?s.size>CHV.obj.config.user.avatar_max_filesize?PF.fn.growl.call(PF.fn._s("Please select a picture of at most %s size.",CHV.obj.config.user.avatar_max_filesize)):(n.removeClass("hidden"),PF.fn.loading.inline(n,{center:!0}),o.data("uploading",!0),(t=new FormData).append("source",s),t.append("action","upload"),t.append("type","file"),t.append("what","avatar"),t.append("owner",CHV.obj.resource.user.id),t.append("auth_token",PF.obj.config.auth_token),avatarXHR=new XMLHttpRequest,avatarXHR.open("POST",PF.obj.config.json_api,!0),avatarXHR.send(t),avatarXHR.onreadystatechange=function(){var t;4==this.readyState&&(t=("json"!==this.responseType?JSON.parse(this.response):this.response).success.image,n.addClass("hidden").empty(),200==this.status?(change_avatar=function(e){$("img.user-image",e).attr("src",t.url).removeClass("hidden").show()},hide_default=function(e){$(".default-user-image",e).addClass("hidden")},hide_default(i),$(".btn-alt",i).closest("div").show(),change_avatar(i),CHV.obj.logged_user.id==CHV.obj.resource.user.id&&(change_avatar(a),hide_default(a)),PF.fn.growl.expirable(PF.fn._s("Profile image updated."))):PF.fn.growl.expirable(PF.fn._s("An error occurred. Please try again later.")),o.data("uploading",!1))}):PF.fn.growl.call(PF.fn._s("Please select a valid image file type.")))}),$(document).on("change","[data-content=user-background-upload-input]",function(e){e.preventDefault(),e.stopPropagation();var t,o=$(this),i=$("[data-content=user-background-cover]"),n=$("[data-content=user-background-cover-src]"),a=$(".loading-placeholder",i),s=($("#top-bar"),$(this)[0].files[0]);o.data("uploading")||(0!=/^image\/.*$/.test(s.type)?s.size>CHV.obj.config.user.background_max_filesize?PF.fn.growl.call(PF.fn._s("Please select a picture of at most %s size.",CHV.obj.config.user.background_max_filesize)):(a.removeClass("hidden"),PF.fn.loading.inline(a,{center:!0,size:"big",color:"#FFF"}),o.data("uploading",!0),(t=new FormData).append("source",s),t.append("action","upload"),t.append("type","file"),t.append("what","background"),t.append("owner",CHV.obj.resource.user.id),t.append("auth_token",PF.obj.config.auth_token),avatarXHR=new XMLHttpRequest,avatarXHR.open("POST",PF.obj.config.json_api,!0),avatarXHR.send(t),avatarXHR.onreadystatechange=function(){var e,t;4==this.readyState&&(e=("json"!==this.responseType?JSON.parse(this.response):this.response).success.image,200==this.status?(t=$("<img/>")).attr("src",e.url).imagesLoaded(function(){a.addClass("hidden").empty(),n.css("background-image","url("+e.url+")").hide().fadeIn(),$("[data-content=user-change-background]",i).removeClass("hidden"),i.removeClass("no-background"),$("[data-content=user-upload-background]").hide(),$("[data-content=user-change-background]").show(),PF.fn.growl.expirable(PF.fn._s("Profile background image updated.")),t.remove(),"function"==typeof user_background_full_fix&&user_background_full_fix()}):(a.addClass("hidden").empty(),PF.fn.growl.expirable(PF.fn._s("An error occurred. Please try again later."))),o.data("uploading",!1))}):PF.fn.growl.call(PF.fn._s("Please select a valid image file type.")))}),CHV.fn.user_background={delete:{submit:function(){return PF.obj.modal.form_data={action:"delete",delete:"background",owner:CHV.obj.resource.user.id},!0},deferred:{success:{before:function(e){$("[data-content=user-background-cover-src]").css("background-image","none"),$("[data-content=user-background-cover]").addClass("no-background").height(""),$("[data-content=user-upload-background]").removeClass("hidden").show(),$("[data-content=user-change-background]").hide(),$("#top-bar-shade").remove()},done:function(e){PF.fn.modal.close(function(){PF.fn.growl.expirable(PF.fn._s("Profile background image deleted."))})}},error:function(e){PF.fn.growl.expirable(PF.fn._s("Error deleting profile background image."))}}}},CHV.str.mainform="[data-content=main-form]",CHV.obj.timezone={selector:"[data-content=timezone]",input:"#timezone-region"},$(document).on("keyup change",CHV.str.mainform+" :input",function(){$(this).is("[name=username]")&&$("[data-text=username]").text($(this).val())}),$(document).on("change",CHV.obj.timezone.input,function(){var e=$(this).val(),t=$("#timezone-combo-"+e);t.find("option:first").prop("selected",!0),$(CHV.obj.timezone.selector).val(t.val()).change()}),$(document).on("change","[id^=timezone-combo-]",function(){var e=$(this).val();$(CHV.obj.timezone.selector).val(e).change()}),$(document).on("keyup change blur","[name^=new-password]",function(){var e=$("[name=new-password]"),t=$("[name=new-password-confirm]"),o=e.val()==t.val(),i=t.closest(".input-password").find(".input-warning");0==i.exists()&&(i=$("[data-message=new-password-confirm]")),$(this).is(t)&&t.data("touched",!0),t.data("touched")&&i.text(o?"":i.data("text"))[o?"addClass":"removeClass"]("hidden-visibility")}),$(document).on("submit",CHV.obj.mainform,function(){switch($(this).data("type")){case"password":var e=$("[name=new-password]",this),t=$("[name=new-password-confirm]",this);if((""!==e.val()||""!==t.val())&&e.val()!==t.val())return e.highlight(),t.highlight(),PF.fn.growl.expirable(PF.fn._s("Passwords don't match")),!1}}),$("body#image").exists()&&0<window.scrollY&&$("#top-bar").removeClass("transparent"),$(CHV.fn.uploader.selectors.root).exists()&&(CHV.fn.uploader.$pasteCatcher=$("<div />",{contenteditable:"true",id:CHV.fn.uploader.selectors.paste.replace(/#/,"")}),$("body").append(CHV.fn.uploader.$pasteCatcher),$(document).keydown(function(e){var t=e.keyCode;!e.ctrlKey&&!e.metaKey||86!=t||$(e.target).is(":input")||CHV.fn.uploader.$pasteCatcher.focus(e)}),window.addEventListener("paste",CHV.fn.uploader.pasteImageHandler)),$(document).on("click","[data-action=like]",function(){var o,e,i,n,t,a,s,r;PF.fn.is_user_logged()?(o=$(this)).data("XHR")||(o.data("XHR",!0),e=$(this).is("[data-liked]")?$(this):$(this).closest("[data-liked]"),i=!e.closest("[data-list], .viewer").exists()&&void 0!==CHV.obj.resource,t=(n=e.is("[data-liked=1]"))?"dislike":"like",a={id:i?CHV.obj.resource.id:$(this).closest("[data-id]").attr("data-id"),type:i?CHV.obj.resource.type:$(this).closest("[data-type]").attr("data-type")},s=i?o:$("[data-type="+a.type+"][data-id="+a.id+"]"),(r={type:"POST",data:{action:t},cache:!1}).data[t]={object:a.type,id:a.id},$.ajax(r).complete(function(e){var t=e.responseJSON;o.data("XHR",!1),200===t.status_code?(i&&void 0!==t.content&&$("[data-text=likes-count]").html(t.content.likes),s.attr("data-liked",n?0:1)):PF.fn.growl.expirable(PF.fn._s("An error occurred. Please try again later."))})):window.location.href="https://imgbb.com/login"}),$(document).on("click","[data-action=follow]",function(){var n,a,s,r,e,t,o;PF.fn.is_user_logged()?(n=$(this)).data("XHR")||(n.data("XHR",!0),a=$(this).is("[data-followed]")?$(this):$(this).closest("[data-followed]"),s=void 0!==CHV.obj.resource,(o={type:"POST",data:{action:e=(r=a.is("[data-followed=1]"))?"unfollow":"follow"},cache:!(t={id:s?CHV.obj.resource.id:$(this).closest("[data-id]").data("id"),type:s?CHV.obj.resource.type:$(this).closest("[data-type]").data("type")})}).data[e]={object:t.type,id:t.id},$.ajax(o).complete(function(e){var t,o,i=e.responseJSON;n.data("XHR",!1),200===i.status_code?(s&&void 0!==i.user_followed&&(o={single:(t=$("[data-text=followers-label]")).data("label-single"),plural:t.data("label-plural")},$("[data-text=followers-count]").html(i.user_followed.followers),t.html(PF.fn._n(o.single,o.plural,i.user_followed.followers))),a.attr("data-followed",r?0:1)):PF.fn.growl.expirable(PF.fn._s("An error occurred. Please try again later."))})):PF.fn.modal.call({type:"login"})}),$(document).on("click","[data-action=top-bar-notifications]",function(e){var a=this,s=$(this),r=$(".top-bar-notifications-container",s),l=$(".top-bar-notifications-list",s),d=$("ul",l),c=$(".loading",r);s.data("XHR")||(c.removeClass("hidden"),PF.fn.loading.inline(c,{size:"small",message:PF.fn._s("loading")}),$.ajax({type:"POST",data:{action:"notifications"},cache:!1}).complete(function(e){var t,o,i,n=e.responseJSON;if(200!==n.status_code)return PF.fn.growl.expirable(PF.fn._s("An error occurred. Please try again later.")),s.data("XHR",!1),void c.addClass("hidden").html("");s.data("XHR",!0),c.remove(),n.html?(l.removeClass("hidden"),d.html(n.html),PF.fn.isDevice(["phone","phablet"])||((t=$(".top-bar-notifications-list ul",".top-bar:visible")).css("height",""),o=t.height(),t.data("height",o).css("height","auto"),o<t.height()&&(t.height(o),t.closest(".antiscroll-wrap").antiscroll())),(i=$("li.new",d)).addClass("transition"),setTimeout(function(){i.removeClass("new"),$("[data-content=notifications-counter]",a).removeClass("on").html("0"),setTimeout(function(){i.removeClass("transition")},150)},1500)):$(".empty",r).removeClass("hidden")}))}),void 0!==CHV.obj.config.mode&&"code"==CHV.obj.config.mode&&(i="",-1===window.name.indexOf("imgbb_")?i=window.name:"undefined"!=typeof localStorage&&(i=localStorage.getItem("code")),""!=i&&-1===i.indexOf("imgbb_")&&(n="[data-modal=form-embed-code]",$("textarea",n).html(decodeURIComponent(i)),PF.fn.modal.call({type:"html",template:$(n).html(),buttons:!1}))),$(document).on("click",".list-item [data-action=load-image]",function(e){!function(e){var t=e.closest(".list-item");{var o,i,n;void 0!==t.data("object")&&(e.addClass("list-item-play-gif--loading"),o=$(".image-container",t),i=$("img",o),i.attr("src"),n=$.parseJSON(decodeURIComponent(t.data("object"))),o.append(o.html()),$load=t.find(".image-container img").eq(1).attr("src",n.image.url).addClass("hidden"),$load.imagesLoaded(function(){e.remove(),i.remove(),$(this.elements).removeClass("hidden")}))}}($(this)),e.preventDefault(),e.stopPropagation()}),$(document).on("click","#album [data-tab=tab-codes]",function(){var t,o=$(".content-listing-loading","#tab-codes");o.exists()&&(t=$("#embed-codes"),$.ajax({type:"POST",data:{action:"get-album-contents",albumid:CHV.obj.resource.id},cache:!1}).always(function(e){PF.fn.loading.destroy(o),200==e.status_code&&(CHV.fn.fillEmbedCodes(e.contents,"#tab-codes"),t.removeClass("soft-hidden"))}))}),$("body").is("#upload")&&CHV.fn.uploader.toggle({show:!0}),$(document).on("keyup",function(e){var t;!$(PF.obj.modal.selectors.root).exists()&&$(".viewer").exists()&&e.which in CHV.fn.listingViewer.keys&&(t=CHV.fn.listingViewer.keys[e.which],-1==[88,27,37,39,65,68].indexOf(e.which)?$("[data-action="+t+"]",CHV.fn.listingViewer.selectors.root).click():t in CHV.fn.listingViewer&&CHV.fn.listingViewer[t]())}),$(document).on("click",CHV.fn.listingViewer.selectors.root+" [data-action^=viewer-]",function(){var e=$(this).data("action").substring("viewer-".length);e in CHV.fn.listingViewer&&CHV.fn.listingViewer[e]()}),$(document).on("click","a[data-href]:not([rel=popup-link]):not(.popup-link)",function(){var e=$(this).attr("data-href"),t=$(this).attr("href");(e||t)&&(location.href=t||e)}),void 0!==CHV.obj.config&&CHV.obj.config.listing.viewer&&$(document).on("click",PF.obj.listing.selectors.list_item+"[data-type=image] a.image-container",function(e){e.preventDefault(),e.stopPropagation();var t=$(this).closest(PF.obj.listing.selectors.list_item);t.exists()&&CHV.fn.listingViewer.open(t)}),$(document).on("contextmenu","html.device-mobile "+CHV.fn.listingViewer.selectors.src,function(e){return e.preventDefault(),!1});var c,u,f=PF.fn.deparam(window.location.search);f&&"viewer"in f&&("images"==(c=$(PF.obj.listing.selectors.content_listing_visible)).data("list")&&(u=$(PF.obj.listing.selectors.list_item,c)["next"==f.viewer?"first":"last"](),CHV.fn.listingViewer.open(u)))}),"undefined"==typeof CHV&&(CHV={obj:{},fn:{},str:{}}),window.opener&&"/upload"==window.location.pathname&&""==window.location.search.substr(1)&&(CHV.obj.opener={uploadPlugin:{}}),CHV.fn.listingViewer={selectors:{bodyShown:".--viewer-shown",template:"#viewer-template",root:".viewer",rootShow:".viewer--show",rootHide:".viewer--hide",rootZero:".viewer--zero",rootNavPrev:".viewer--nav-prev",rootNavNext:".viewer--nav-next",src:".viewer-src",tools:".viewer-tools",loader:".viewer-loader",owner:".viewer-owner",ownerGuest:".viewer-owner--guest",ownerUser:".viewer-owner--user",inputMap:".viewer-kb-input"},keys:{83:"select",76:"like",69:"edit",81:"move",46:"delete",88:"close",27:"close",67:"codes",37:"prev",65:"prev",39:"next",68:"next"},keymap:{select:["S",PF.fn._s("Toggle select")],like:["L",PF.fn._s("Like")],edit:["E",PF.fn._s("Edit")],move:["Q",PF.fn._s("Album")],delete:["Del",PF.fn._s("Delete")],close:["X",PF.fn._s("Close")],codes:["C",PF.fn._s("Embed codes")],prev:["",PF.fn._s("Previous")],next:["",PF.fn._s("Next")]},loading:null,idleTimer:0,$item:null,show:function(){this.getEl("root").removeClass(this.selectors.rootHide.substring(1)).addClass(this.selectors.rootShow.substring(1)),$("body").addClass(this.selectors.bodyShown.substring(1)),new Hammer($(CHV.fn.listingViewer.selectors.root).get(0),{direction:Hammer.DIRECTION_VERTICAL}).on("swipeleft swiperight",function(e){var t="left"==e.type.substring("swipe".length)?"next":"prev";CHV.fn.listingViewer[t]()})},getItem:function(){return this.$item},getEl:function(e){var t=!e.startsWith("template")&&!e.startsWith("root")&&this.selectors.root;return t?$(this.selectors[e],t):$(this.selectors[e])},getObject:function(e){var t;return!e&&void 0!==this.object||(t=decodeURIComponent(this.getItem().attr("data-object")),this.object=JSON&&JSON.parse(t)||$.parseJSON(t)),this.object},placeholderSizing:function(){var e,t;this.getEl("root").exists()&&(t=Math.max(document.documentElement.clientWidth,window.innerWidth||0)/Math.max(document.documentElement.clientHeight,window.innerHeight||0)<(e=this.getEl("src")[0]).getAttribute("width")/e.getAttribute("height"),e.classList.remove("--width-auto","--height-auto"),e.classList.add("--"+(t?"height":"width")+"-auto"))},filler:function(e){var t,n=this,a=this.getEl("root");e&&(t=$(this.getParsedTemplate()),a.html(t.html())),a[(this.getItem().hasClass("selected")?"add":"remove")+"Class"]("selected");$.each(["prev","next"],function(e,t){var o=n.selectors["rootNav"+(t.charAt(0).toUpperCase()+t.slice(1).toLowerCase())],i=0<$(PF.obj.listing.selectors.content_listing_pagination+":visible").length||n.getItem()[t]().exists()?"add":"remove";a[i+"Class"](o.substring(1))}),$.each(this.getItem().get(0).attributes,function(e,t){if(!t.name.startsWith("data-"))return!0;a.attr(t.name,t.value)});var o="owner"+((o=void 0===this.object.user?"user":"guest").charAt(0).toUpperCase()+o.slice(1).toLowerCase());this.getEl(o).remove(),void 0!==this.object.user&&$(this.object.user.avatar?".default-user-image":"img.user-image",this.getEl("ownerUser")).remove();var i=this.getItem().find(".list-item-image-tools");this.getEl("tools").append(i.html()),$.each(i.find("[data-action]"),function(e,t){var o=$(this).attr("data-action"),i=n.keymap[o];$('<div class="viewer-kb-key"><kbd>'+i[0]+"</kbd><span>"+i[1]+"</span></div>").appendTo(n.getEl("inputMap"))}),this.placeholderSizing(),this.trickyLoad()},toggleFullscreen:function(e){var t=e?this.getEl("root")[0]:document;(e?t.requestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullScreen||t.msRequestFullscreen:t.exitFullscreen||t.webkitExitFullscreen||t.mozCancelFullScreen||t.msExitFullscreen).call(t)},fullscreen:function(){this.toggleFullscreen(!0)},normalscreen:function(){this.toggleFullscreen(!1)},remove:function(){this.getEl("root").remove()},getParsedTemplate:function(){var n=this.getObject(!0),a=this.getEl("template").html(),e=a.match(/%(\S+)%/g);return e&&$.each(e,function(e,t){var o;t.slice(1,-1).split(".").map(function(e){var t=o||n;e in t&&(o=t[e])});var i=new RegExp(t,"g");a=a.replace(i,o)}),a},insertEl:function(){var e=this.getParsedTemplate();this.getEl("rootZero").remove(),$(e).appendTo("body")},toggleIdle:function(e,t){var o=this,t=void 0===t||t;$("html")[(e?"add":"remove")+"Class"]("--idle"),e||(clearTimeout(o.idleTimer),t&&(o.idleTimer=setTimeout(function(){var e=$(".fullscreen"),t=o.getEl("root");o.toggleIdle(0<t.length&&0==e.length)},5e3)))},open:function(e){this.setItem(e),this.insertEl(),this.filler(),this.show(),this.toggleIdle(!1);var t=this;this.getEl("root").on("mousemove mouseout",function(){t.toggleIdle(!1)})},setItem:function(e){this.$item=e},trickyLoad:function(){var e,t,o=this.getEl("loader");this.object.image.url!=this.object.display_url?(e=this.getEl("src").parent().html(),(t=$(e).attr("src",this.object.image.url)).insertBefore(this.getEl("src")),PF.fn.loading.inline(o,{color:"white",size:"small",center:!0,valign:!0}),o.hide().fadeIn("slow"),t.imagesLoaded(function(){t.next().remove(),PF.fn.loading.destroy(o)})):o.remove()},close:function(){var e=this;$(this.selectors.root).removeClass(this.selectors.rootShow.substring(1)).addClass(this.selectors.rootHide.substring(1)),$("body").removeClass(this.selectors.bodyShown.substring(1)),this.toggleIdle(!1,!1),setTimeout(function(){e.remove()},200)},browse:function(e){var t=this.getItem()[e]();if(t.exists()){this.setItem(t),this.filler(!0);var o=$(PF.obj.listing.selectors.content_listing_visible).find("[data-action=load-more]"),i=t[e+"All"]().length;0<o.length&&i<=5&&!PF.obj.listing.calling&&"next"==e&&$("[data-action=load-more]").click()}else{var n=$("[data-pagination="+e+"]",PF.obj.listing.selectors.content_listing_pagination+":visible").attr("href");if(!n)return;PF.fn.deparam(window.location.search);window.location.href=n+"&viewer="+e}},prev:function(){this.browse("prev")},next:function(){this.browse("next")}},CHV.obj.image_viewer={selector:"#image-viewer",container:"#image-viewer-container",navigation:".image-viewer-navigation",loading:"#image-viewer-loading",loader:"#image-viewer-loader"},CHV.obj.image_viewer.$container=$(CHV.obj.image_viewer.container),CHV.obj.image_viewer.$navigation=$(CHV.obj.image_viewer.navigation),CHV.obj.image_viewer.$loading=$(CHV.obj.image_viewer.loading),CHV.fn.bindSelectableItems=function(){var e="content-listing-wrapper",t="#"+e;$(t).exists()?$(t).hasClass("ui-selectable")&&$(t).selectable("destroy"):$("[data-content=list-selection]").closest(".content-width").wrap("<div id='"+e+"' />"),$("[data-content=list-selection]").exists()&&$("html.device-nonmobile "+t).selectable({delay:150,filter:PF.obj.listing.selectors.list_item,cancel:".content-empty, .header, #tab-sh, #tab-full-info, .viewer-title, .header-link, .top-bar, .content-listing-pagination *, #fullscreen-modal, #top-user, #background-cover, .list-item-desc, .list-item-image-tools, [data-action=load-image], #tab-codes",selecting:function(e,t){var o=$(t.selecting),i=o.hasClass("selected");CHV.fn.list_editor[(i?"unselect":"select")+"Item"](o)},unselecting:function(e,t){CHV.fn.list_editor.unselectItem($(t.unselecting))}})},CHV.fn.isCachedImage=function(e){var t=new Image;return t.src=e,t.complete||0<t.width+t.height},CHV.fn.viewerImageZoomClass=function(){CHV.obj.image_viewer.$container.hasClass("jscursor-zoom-in")&&CHV.obj.image_viewer.$container.addClass("cursor-zoom-in").removeClass("jscursor-zoom-in")},CHV.fn.viewerLoadImage=function(){CHV.obj.image_viewer.$loading.exists()&&(CHV.obj.image_viewer.$loading.removeClass("soft-hidden").css({zIndex:2}),PF.fn.loading.inline(CHV.obj.image_viewer.$loading,{color:"white",size:"small",center:!0,valign:!0}),CHV.obj.image_viewer.$loading.hide().fadeIn("slow")),$(CHV.obj.image_viewer.loader).remove(),CHV.obj.image_viewer.image.html=CHV.obj.image_viewer.$container.html(),CHV.obj.image_viewer.$container.prepend($(CHV.obj.image_viewer.image.html).css({top:0,zIndex:0})),CHV.obj.image_viewer.$container.find("img").eq(0).css("zIndex",1),CHV.obj.image_viewer.$container.find("img").eq(1).attr("src",CHV.obj.image_viewer.image.url).css({width:"100%",height:"auto"}),CHV.obj.image_viewer.$container.find("img").eq(1).imagesLoaded(function(){CHV.obj.image_viewer.$container.find("img").eq(1).css({width:"",height:""}),CHV.obj.image_viewer.$container.find("img").eq(0).remove(),PF.fn.loading.destroy(CHV.obj.image_viewer.$loading)})},CHV.obj.embed_tpl={},CHV.obj.topBar={transparencyScrollToggle:function(){var e=$(window).scrollTop();$("#top-bar")[(0<e?"remove":"add")+"Class"]("transparent")}},CHV.obj.uploaderReset={isUploading:!1,canAdd:!0,queueStatus:"ready",uploadThreads:0,uploadParsedIds:[],uploadProcessedIds:[],files:{},results:{success:{},error:{}},toggleWorking:0,filesAddId:0,clipboardImages:[]},CHV.fn.uploader={selectors:{root:"#anywhere-upload",show:".upload-box--show",queue:"#anywhere-upload-queue",queue_complete:".queue-complete",queue_item:".queue-item",close_cancel:"[data-button=close-cancel]",file:"#anywhere-upload-input",camera:"#anywhere-upload-input-camera",upload_item_template:"#anywhere-upload-item-template",item_progress_bar:"[data-content=progress-bar]",item_progress_percent:"[data-text=progress-percent]",failed_result:"[data-content=failed-upload-result]",fullscreen_mask:"#fullscreen-uploader-mask",dropzone:"#uploader-dropzone",paste:"#anywhere-upload-paste",input:"[data-action=anywhere-upload-input]"},toggle:function(e,t){this.queueSize();var o,i,n,a,s=$("[data-action=top-bar-upload]",".top-bar"),r=!$(CHV.fn.uploader.selectors.root).data("shown");void 0!==(e=$.extend({callback:null,reset:!0},e)).show&&e.show&&(r=!0),PF.fn.growl.close(!0),PF.fn.close_pops(),1==this.toggleWorking||$(CHV.fn.uploader.selectors.root).is(":animated")||CHV.fn.uploader.isUploading||s.data("login-needed")&&!PF.fn.is_user_logged()||(this.toggleWorking=1,o=500,i=function(){!r&&e.reset&&CHV.fn.uploader.reset(),PF.obj.follow_scroll.$node.exists()&&(PF.obj.follow_scroll.$node.removeClass("fixed"),PF.obj.follow_scroll.set()),PF.fn.topMenu.hide(),"function"==typeof e.callback&&e.callback(t),CHV.fn.uploader.boxSizer(),CHV.fn.uploader.toggleWorking=0},$(CHV.fn.uploader.selectors.root)[(r?"add":"remove")+"Class"](this.selectors.show.substring(1)),r?(!$("body").is("#upload")&&PF.fn.isDevice(["phone","phablet"])&&$("html").addClass("overflow-hidden"),$("html").data({"followed-scroll":$("html").hasClass("followed-scroll"),"top-bar-box-shadow-prevent":!0}).removeClass("followed-scroll"),$("#top-bar").data({stock_classes:$("#top-bar").attr("class")}),$(".current[data-nav]",".top-bar").each(function(){$(this).is("[data-action=top-bar-menu-full]")||$(this).removeClass("current").attr("data-current",1)}),PF.fn.isDevice("mobile")&&(n=$(".upload-box-heading",$(CHV.fn.uploader.selectors.root))).css({position:"relative",top:.5*($(window).height()-n.height())+"px"}),e.reset&&CHV.fn.uploader.reset(),CHV.fn.uploader.focus(function(){setTimeout(function(){i()},o)})):($("[data-nav][data-current=1]",".top-bar").each(function(){$(this).addClass("current")}),$(CHV.fn.uploader.selectors.fullscreen_mask).css({opacity:0}),setTimeout(function(){$(CHV.fn.uploader.selectors.fullscreen_mask).remove(),$("html").data("followed-scroll")&&$("html").addClass("followed-scroll")},250),a=$(CHV.fn.uploader.selectors.root).outerHeight()-parseInt($(CHV.fn.uploader.selectors.root).data("initial-height"))+"px",$(CHV.fn.uploader.selectors.root).css({transform:"translate(0,-"+a+")"}),setTimeout(function(){$("#top-bar").attr("class",$("#top-bar").data("stock_classes")),$("html").removeClass($(".follow-scroll-wrapper.position-fixed").exists()?"":"top-bar-box-shadow-none")},o/3),setTimeout(function(){$(CHV.fn.uploader.selectors.root).css({top:""}),$("body#image").exists()&&CHV.obj.topBar.transparencyScrollToggle(),i(),$("html,body").removeClass("overflow-hidden").data({"top-bar-box-shadow-prevent":!1})},o)),$(CHV.fn.uploader.selectors.root).data("shown",r),s.toggleClass("current").removeClass("opened"))},reset:function(){$.extend(this,$.extend(!0,{},CHV.obj.uploaderReset)),$("li",this.selectors.queue).remove(),$(this.selectors.root).height("").css({"overflow-y":"","overflow-x":""}),$(this.selectors.queue).addClass("queueEmpty").removeClass(this.selectors.queue_complete.substring(1)),$(this.selectors.input,this.selectors.root).each(function(){}),$("[data-group=upload-result] textarea",this.selectors.root).prop("value",""),$.each(["upload-queue-ready","uploading","upload-result","upload-queue-ready","upload-queue"],function(e,t){$("[data-group="+t+"]").hide()}),$("[data-group=upload]",this.selectors.root).show(),$("[name=upload-album-id]",this.selectors.root).prop("value",function(){var e=$("option[selected]",this);if(e.exists())return e.attr("value")}),$(this.selectors.root).removeClass("queueCompleted queueReady queueHasResults").addClass("queueEmpty").attr("data-queue-size",0),$("[name=upload-category-id]",this.selectors.root).prop("value",""),$("[name=upload-nsfw]",this.selectors.root).prop("checked",this.defaultChecked),this.boxSizer(!0)},focus:function(e){$(this.selectors.fullscreen_mask).exists()||($("body").is("#upload")||$("body").append($("<div/>",{id:this.selectors.fullscreen_mask.replace("#",""),class:"fullscreen soft-black"}).css({top:PF.fn.isDevice("phone")?0:$(CHV.fn.uploader.selectors.root).data("top")})),setTimeout(function(){$("body").is("#upload")||$(CHV.fn.uploader.selectors.fullscreen_mask).css({opacity:1}),setTimeout(function(){"function"==typeof e&&e()},PF.fn.isDevice(["phone","phablet"])?0:250)},1))},boxSizer:function(e){var t=$(this.selectors.root).is(this.selectors.show),o=t||e;t&&!$("body").is("#upload")&&$("html")[(PF.fn.isDevice(["phone","phablet"])?"add":"remove")+"Class"]("overflow-hidden"),o&&($(this.selectors.root).height(""),!$("body").is("#upload")&&$(this.selectors.root).height()>$(window).height()?($(this.selectors.root).height($(window).height()).css({"overflow-y":"scroll","overflow-x":"auto"}),$("body").addClass("overflow-hidden")):($(this.selectors.root).css("overflow-y",""),$("body").removeClass("overflow-hidden")))},pasteURL:function(){var e=$("[name=urls]","#fullscreen-modal").val();void 0!==e&&"undefined"!=e&&""!=e&&(CHV.fn.uploader.toggle({show:!0}),CHV.fn.uploader.add({},e))},pasteImageHandler:function(o){var e,t;if(!$(o.target).is(":input")&&(void 0!==o.clipboardData&&o.clipboardData.items?e=o.clipboardData.items:setTimeout(function(){return o.clipboardData={},o.clipboardData.items=[],$.each($("img",CHV.fn.uploader.$pasteCatcher),function(e,t){o.clipboardData.items.push(PF.fn.dataURItoBlob($(this).attr("src")))}),$(CHV.fn.uploader.selectors.paste).html(""),CHV.fn.uploader.pasteImageHandler(o)},1),e))if(0==e.length){void 0===window.clipboardData||!window.clipboardData.getData||void 0!==(t=window.clipboardData.getData("Text"))&&"undefined"!=t&&""!=t&&($(CHV.fn.uploader.selectors.root).data("shown")?CHV.fn.uploader.add({},t):CHV.fn.uploader.toggle({callback:function(){CHV.fn.uploader.add({},t)}}))}else{for(var i=!1,n=0;n<e.length;n++)-1!==e[n].type.indexOf("image")&&(i=!0);for(var a,s,n=0;n<e.length;n++){-1!==e[n].type.indexOf("image")?(a=e[n]instanceof Blob?e[n]:e[n].getAsFile(),(s=new FileReader).onload=function(e){var t=$(CHV.fn.uploader.selectors.root).data("shown");a.name=PF.fn._s("Clipboard image")+" "+PF.fn.getDateTime();var o={originalEvent:{dataTransfer:{files:[a]},preventDefault:function(){},stopPropagation:function(){},clipboard:!0,dataURL:e.target.result,name:a.name}};t?CHV.fn.uploader.add(o):CHV.fn.uploader.toggle({callback:function(){CHV.fn.uploader.add(o)}})},s.readAsDataURL(a)):"string"==e[n].kind&&-1!==e[n].type.indexOf("text")&&-1===e[n].type.indexOf("html")&&0==i&&e[n].getAsString(function(e){void 0!==e&&"undefined"!=e&&""!=e&&($(CHV.fn.uploader.selectors.root).data("shown")?CHV.fn.uploader.add({},e):CHV.fn.uploader.toggle({callback:function(){CHV.fn.uploader.add({},e)}}))})}}},add:function(e,_){var t;if(!this.canAdd)return(e=e.originalEvent).preventDefault(),e.stopPropagation(),!1;$fileinput=$(this.selectors.file),$fileinput.replaceWith($fileinput=$fileinput.clone(!0));var o=$(this.selectors.upload_item_template).html(),P=[];if(void 0===_){if((e=e.originalEvent).preventDefault(),e.stopPropagation(),P=e.dataTransfer||e.target,P=$.makeArray(P.files),e.clipboard){if(t=PF.fn.md5(e.dataURL),-1!=$.inArray(t,this.clipboardImages))return null;this.clipboardImages.push(t)}for(var F=[],i=0;i<P.length;i++){var n=P[i],a=void 0===n.type||""==n.type?n.name.substr(n.name.lastIndexOf(".")+1).toLowerCase():n.type.replace("image/","").replace("application/","");n.size>CHV.obj.config.image.max_filesize?F.push({uid:i,name:n.name.truncate_middle()+" - "+PF.fn._s("File too big.")}):-1!=CHV.obj.config.upload.image_types.indexOf(a)||0!=/android/i.test(navigator.userAgent)?(t&&(n.md5=t),n.fromClipboard=1==e.clipboard,n.uid=i):F.push({uid:i,name:n.name.truncate_middle()+" - "+PF.fn._s("Invalid or unsupported file format.")})}for(i=0;i<F.length;i++){var s=F[i];P.splice(s.id,1)}if(0<F.length&&0==P.length){for(var r="",i=0;i<F.length;i++)r+="<li>"+PF.fn.htmlEncode(F[i].name)+"</li>";return void PF.fn.modal.simple({title:PF.fn._s("Some files couldn't be added"),message:"<ul><li>"+r+"</ul>"})}if(0==P.length)return}else{var l=(_=_.replace(/(\[([^\]]+)\])/g,"")).match_image_urls();if(_=_.replace(/(<([^>]+)>)/g,""),l)for(index=0;index<l.length;++index)_=_.replace(l[index],""),_+="\n"+l[index];if(!(P=_.match_urls()))return;P=(P=P.array_unique()).filter(function(e){return-1!==e.indexOf("/")&&-1!==e.indexOf(".")}),P=$.map(P,function(e,t){return{uid:t,name:e,url:e}})}if($.isEmptyObject(this.files))for(i=0;i<P.length;i++)this.files[P[i].uid]=P[i],this.filesAddId++;else{var d=[];for(var c in this.files)void 0!==this.files[c]&&"function"!=typeof this.files[c]&&d.push(encodeURI(this.files[c].name));P=$.map(P,function(e,t){return"undefined"!==e.fromClipboard&&1==e.fromClipboard||-1==$.inArray(encodeURI(e.name),d)?(e.uid=CHV.fn.uploader.filesAddId,CHV.fn.uploader.filesAddId++,e):null});for(i=0;i<P.length;i++)this.files[P[i].uid]=P[i]}$(this.selectors.queue,this.selectors.root).append(o.repeat(P.length)),$(this.selectors.queue+" "+this.selectors.queue_item+":not([data-id])",this.selectors.root).hide();var x=F,F=[],j=0,u={canvas:!0,maxWidth:590},C=[];0<P.length&&(PF.fn.loading.fullscreen(),function v(e,w){var y;e in P?(y=P[e],$(CHV.fn.uploader.selectors.queue_item+":not([data-id]) .load-url",CHV.fn.uploader.selectors.queue)[void 0!==y.url?"show":"remove"](),loadImage.parseMetaData(y.url?y.url:y,function(b){$(CHV.fn.uploader.selectors.queue_item+":not([data-id]) .preview:empty",CHV.fn.uploader.selectors.queue).first().closest("li").attr("data-id",y.uid),loadImage(y.url?y.url:y,function(e){++j;var t=$(CHV.fn.uploader.selectors.queue_item+"[data-id="+y.uid+"]",CHV.fn.uploader.selectors.queue);if("error"===e.type){if(void 0===C[y.uid])if(void(C[y.uid]=0)!==y.url&&"undefined"!=y.url&&""!=y.url){var o=new XMLHttpRequest;o.open("GET",PF.obj.config.json_api+"?action=image&auth_token="+PF.obj.config.auth_token+"&url="+encodeURIComponent(y.url),!0),o.timeout=3e4,o.send(),o.onreadystatechange=function(){if(4==this.readyState){var e=!(C[y.uid]=1);if(200==o.status){var t="json"!==this.responseType?JSON.parse(this.response):this.response;if(void 0!==t&&void 0!==t.urls&&1==t.urls.length){if(_=t.urls[0],void 0===CHV.fn.uploader.files[y.uid])return void PF.fn.loading.destroy("fullscreen");P[y.uid]={uid:y.uid,name:y.url,url:_},CHV.fn.uploader.files[y.uid]=P[y.uid],e=!0}}e||F.push({uid:y.uid,name:y.name.truncate_middle()}),v(y.uid,!0)}}}else{var i=decodeURIComponent(PF.fn.ext(y.name));if("tif"==i||"tiff"==i||"webp"==i||"heic"==i||"heif"==i||"pdf"==i){$("[data-group=upload-queue]",CHV.fn.uploader.selectors.root).is(":visible")||$("[data-group=upload-queue]",CHV.fn.uploader.selectors.root).css("display","block");var n=null;if(void 0!==y.name&&(c=decodeURIComponent(PF.fn.baseName(y.name)),n=$.trim(c.substring(0,100).capitalizeFirstLetter())),void 0===CHV.fn.uploader.files[y.uid])return void PF.fn.loading.destroy("fullscreen");CHV.fn.uploader.files[y.uid].parsedMeta={title:n,width:1e4,height:1e4,mimetype:"image/jpeg"},t.show(),$(CHV.fn.uploader.selectors.root).addClass("queueReady").removeClass("queueEmpty"),$("[data-group=upload-queue-ready]",CHV.fn.uploader.selectors.root).show(),$("[data-group=upload]",CHV.fn.uploader.selectors.root).hide(),t.find(".load-url").remove(),t.find(".preview").removeClass("soft-hidden").show().append($("<span>",{class:"icon icon-eye-blocked canvas",style:"font-size:100px;width:100px;height:100px;color:#00a7da;display:block;text-decoration:none;margin-top:-50px;margin-left:-50px;"})),CHV.fn.uploader.boxSizer()}else C[y.uid]=1,F.push({uid:y.uid,name:y.name.truncate_middle()})}}else{$("[data-group=upload-queue]",CHV.fn.uploader.selectors.root).is(":visible")||$("[data-group=upload-queue]",CHV.fn.uploader.selectors.root).css("display","block");var a="image/jpeg";if(void 0!==b.buffer){for(var s=new Uint8Array(b.buffer).subarray(0,4),r="",l=0;l<s.length;l++)r+=s[l].toString(16);var d={"89504e47":"image/png",47494638:"image/gif",ffd8ffe0:"image/jpeg"};$.each(["ffd8ffe1","ffd8ffe2"],function(e,t){d[t]=d.ffd8ffe0}),void 0!==d[r]&&(a=d[r])}var c,n=null;if(void 0!==y.name&&(c=decodeURIComponent(PF.fn.baseName(y.name)),n=$.trim(c.substring(0,100).capitalizeFirstLetter())),void 0===CHV.fn.uploader.files[y.uid])return void PF.fn.loading.destroy("fullscreen");CHV.fn.uploader.files[y.uid].parsedMeta={title:n,width:e.originalWidth,height:e.originalHeight,mimetype:a},t.show(),$(CHV.fn.uploader.selectors.root).addClass("queueReady").removeClass("queueEmpty"),$("[data-group=upload-queue-ready]",CHV.fn.uploader.selectors.root).show(),$("[data-group=upload]",CHV.fn.uploader.selectors.root).hide(),t.find(".load-url").remove(),t.find(".preview").removeClass("soft-hidden").show().append(e),$img=t.find(".preview").find("img,canvas"),$img.attr("class","canvas"),queue_item_h=t.height(),queue_item_w=t.width();var u,f,h=parseInt($img.attr("width"))||$img.width(),p=parseInt($img.attr("height"))||$img.height(),m=h/p;$img.hide(),(p<h||h==p)&&(u=p<queue_item_h?p:queue_item_h,p<h&&$img.height(u).width(u*m)),(h<p||h==p)&&(f=h<queue_item_w?h:queue_item_w,h<p&&$img.width(f).height(f/m)),h==p&&$img.height(u).width(f),$img.css({marginTop:-$img.height()/2,marginLeft:-$img.width()/2}).show(),CHV.fn.uploader.boxSizer()}if(1==C.every(function(e){return 0<e})&&(j==P.length||1==w)){if(void 0!==x&&(F=F.concat(x)),PF.fn.loading.destroy("fullscreen"),0<F.length){for(var g="",l=0;l<F.length;l++)g+="<li>"+PF.fn.htmlEncode(F[l].name)+"</li>",delete CHV.fn.uploader.files[F[l].uid],$("li[data-id="+F[l].uid+"]",CHV.fn.uploader.selectors.queue).find("[data-action=cancel]").click();PF.fn.modal.simple({title:PF.fn._s("Some files couldn't be added"),message:"<ul>"+g+"</ul>"})}else CHV.fn.uploader.focus();CHV.fn.uploader.boxSizer()}},$.extend({},u,{orientation:b.exif?b.exif.get("Orientation"):1})),setTimeout(function(){v(e+1,!1)},25)})):PF.fn.loading.destroy("fullscreen")}(0,!1),this.queueSize())},queueSize:function(){$(this.selectors.root).attr("data-queue-size",Object.size(this.files)),$("[data-text=queue-objects]",this.selectors.root).text(PF.fn._n("image","images",Object.size(this.files))),$("[data-text=queue-size]",this.selectors.root).text(Object.size(this.files))},queueProgress:function(e,t){var o=Object.size(this.files);this.files[t].progress=e.loaded/e.total;for(var i=0,n=0;n<o;n++)void 0!==this.files[n]&&"progress"in this.files[n]&&(i+=this.files[n].progress);$("[data-text=queue-progress]",this.selectors.root).text(parseInt(100*i/o))},upload:function(s){var e,t,o,i,n,a,r,l=s.data("id"),d=!!s.next().exists()&&s.next().data("id");-1===$.inArray(l,this.uploadParsedIds)?((e=this).uploadParsedIds.push(l),void 0!==(t=this.files[l])&&(i=(o=void 0!==t.url)?t.url:t,n=void 0!==t.formValues,void 0!==t?(this.uploadThreads+=1,this.uploadThreads<2&&d&&this.upload(s.next()),this.isUploading=!0,a=new FormData,r={source:null,type:o?"url":"file",action:"upload",timestamp:this.timestamp,auth_token:PF.obj.config.auth_token,category_id:$("[name=upload-category-id]",this.selectors.root).val()||null,album_id:$("[name=upload-album-id]",this.selectors.root).val()||null,expiration:$("[name=upload-expiration]",this.selectors.root).val()||null},o?r.source=i:a.append("source",i,t.name),void 0!==CHV.obj.config.location&&(r.url=CHV.obj.config.location),void 0!==CHV.obj.config.mode&&(r.mode=CHV.obj.config.mode),n&&$.each(t.formValues,function(e,t){r[e.replace(/image_/g,"")]=t}),$.each(r,function(e,t){if(null===t)return!0;a.append(e,t)}),this.files[l].xhr=new XMLHttpRequest,s.removeClass("waiting"),$(".block.edit, .queue-item-button.edit",s).remove(),o?(this.queueSize(),this.queueProgress({loaded:1,total:1},l),this.itemLoading(s)):this.files[l].xhr.upload.onprogress=function(e){e.lengthComputable&&(CHV.fn.uploader.queueProgress(e,l),percentComplete=parseInt(e.loaded/e.total*100),$(CHV.fn.uploader.selectors.item_progress_percent,s).text(percentComplete),$(CHV.fn.uploader.selectors.item_progress_bar,s).width(100-percentComplete+"%"),100==percentComplete&&($(CHV.fn.uploader.selectors.item_progress_percent,s).text(""),CHV.fn.uploader.itemLoading(s)))},this.files[l].xhr.onreadystatechange=function(){var t,o=!1;if(4==this.readyState&&void 0!==CHV.fn.uploader.files[l].xhr&&0!==CHV.fn.uploader.files[l].xhr.status){e.uploadProcessedIds.push(l),--e.uploadThreads,$(".loading-indicator",s).remove(),s.removeClass("waiting uploading");try{var i="json"!==this.responseType?JSON.parse(this.response):this.response;void 0!==i&&200==this.status?($("[data-group=image-link]",s).attr("href",i.image.url_viewer),0<s.find(".preview").find(".icon-eye-blocked").length&&loadImage(i.image.display_url,function(e){var t,o,i,n,a;"error"!==e.type&&(s.find(".preview").append(e),$img=s.find(".preview").find("img,canvas"),$img.attr("class","canvas"),queue_item_h=s.height(),queue_item_w=s.width(),i=(t=parseInt($img.attr("width"))||$img.width())/(o=parseInt($img.attr("height"))||$img.height()),$img.hide(),(o<t||t==o)&&(n=o<queue_item_h?o:queue_item_h,o<t&&$img.height(n).width(n*i)),(t<o||t==o)&&(a=t<queue_item_w?t:queue_item_w,t<o&&$img.width(a).height(a/i)),t==o&&$img.height(n).width(a),$img.css({marginTop:-$img.height()/2,marginLeft:-$img.width()/2}).show(),s.find(".preview").find(".icon-eye-blocked").remove(),CHV.fn.uploader.boxSizer())})):("PDOException"==i.error.context&&(i.error.message="Database error"),i.error.message=CHV.fn.uploader.files[l].name.truncate_middle()+" - "+i.error.message),CHV.fn.uploader.results[200==this.status?"success":"error"][l]=i,200!==this.status&&(o=!0)}catch(e){o=!0,i={status_code:(t=void 0===i?{status:500,statusText:"Internal server error"}:{status:400,statusText:i.error.message}).status,error:{message:CHV.fn.uploader.files[l].name.truncate_middle()+" - Server error ("+t.statusText+")",code:t.status,context:"XMLHttpRequest"},status_txt:t.statusText};var n=Object.size(CHV.fn.uploader.results.error)+1;CHV.fn.uploader.results.error[n]=i}s.addClass(o?"failed":"completed"),void 0!==i.error&&void 0!==i.error.message&&(s.attr("rel","tooltip").data("tiptip","top").attr("title",i.error.message),PF.fn.bindtipTip(s)),e.uploadThreads<2&&d&&(CHV.fn.uploader.upload(s.next()),$(CHV.fn.uploader.selectors.root).addClass("queueHasResults")),e.uploadProcessedIds.length==Object.size(e.files)&&CHV.fn.uploader.displayResults(),$(".done",s).fadeOut()}},this.files[l].xhr.open("POST",PF.obj.config.json_api,!0),this.files[l].xhr.setRequestHeader("Accept","application/json"),this.files[l].xhr.send(a)):s.next().exists()&&this.upload(s.next()))):s.next().exists()&&this.upload(s.next())},itemLoading:function(e){PF.fn.loading.inline($(".progress",e),{color:"#FFF",size:"normal",center:!0,position:"absolute",shadow:!0}),$("[data-action=cancel], [data-action=edit]",e).hide()},displayResults:function(){CHV.fn.uploader.isUploading=!1;for(var e,t,o,i,n=["error","mixed","success"],a={},s=0;s<n.length;s++)a[n[s]]="[data-group=upload-result][data-result=%RESULT%]".replace("%RESULT%",n[s]);if(0<Object.size(this.results.error)){var r=[];for(var s in this.results.error)"object"==typeof this.results.error[s]&&(r[s]=this.results.error[s].error.message);0<r.length&&$(this.selectors.failed_result).html("<li>"+r.join("</li><li>")+"</li>")}else $(a.error,this.selectors.root).hide();if($("[data-text=queue-progress]",this.selectors.root).text(100),$("[data-group=uploading]",this.selectors.root).hide(),$(this.selectors.root).removeClass("queueUploading queueHasResults").addClass("queueCompleted"),$(this.selectors.queue).addClass(this.selectors.queue_complete.substring(1)),0<Object.size(this.results.success)&&$("[data-group=upload-result] textarea",this.selectors.root).exists()&&(CHV.fn.fillEmbedCodes(this.results.success,CHV.fn.uploader.selectors.root,"val"),void 0!==CHV.obj.config.location&&-1!==window.name.indexOf("imgbb_")&&0<(e=CHV.obj.config.hotlink?$("textarea[name=bbcode-embed-medium]",CHV.fn.uploader.selectors.root):$("textarea[name=bbcode-embed-thumbnail]",CHV.fn.uploader.selectors.root)).length&&""!=e.val()&&(t=5<(e.val().match(/ /g)||[]).length?encodeURIComponent("\n"+e.val().replace(new RegExp("\n","g")," ").replace(new RegExp("  ","g")," ").replace(new RegExp("`","g")," ")+"\n"):encodeURIComponent("\n"+e.val().replace(new RegExp(" ","g"),"\n").replace(new RegExp("\n","g"),"\n\n").replace(new RegExp("\n\n\n","g"),"\n\n").replace(new RegExp("`","g")," ")+"\n"),o=window.navigator.userAgent,i=CHV.obj.config.location+"#"+window.name,0<o.indexOf("MSIE ")||0<o.indexOf("Trident/")||0<o.indexOf("Edge/")?i=CHV.obj.config.location+"#"+t:window.name=t,"undefined"!=typeof localStorage&&localStorage.setItem("code",t),window.location.href=i)),0<Object.size(this.results.success)&&0<Object.size(this.results.error)?$(a.mixed+", "+a.success,this.selectors.root).show():0<Object.size(this.results.success)?$(a.success,this.selectors.root).show():0<Object.size(this.results.error)&&$(a.error,this.selectors.root).show(),$(a.success,this.selectors.root).is(":visible")&&($(a.success,this.selectors.root).find("[data-group^=user], [data-group=guest]").hide(),$(a.success,this.selectors.root).find("[data-group="+(PF.fn.is_user_logged()?"user":"guest")+"]").show(),0<Object.size(this.results.success))){var l=Object.keys(this.results.success)[0];if(void 0!==this.results.success[l].image.album){var d=[];for(var c in this.results.success){var u=this.results.success[c].image;u.album&&u.album.id_encoded&&-1==d.indexOf(u.album.id_encoded)&&d.push(u.album.id_encoded)}var f,h={link:null,text:null};d.length<=1?(h.link=this.results.success[l].image.album.url,h.text=this.results.success[l].image.album.name):(h.link=this.results.success[l].image.user.url_albums,h.text=PF.fn._s("%s's Albums",this.results.success[l].image.user.name_short_html)),$("[data-text=upload-target]",this.selectors.root).text(h.text),$("[data-link=upload-target]",this.selectors.root).attr("href",h.link),PF.fn.is_user_logged()&&(f=0<d.length?"album":"stream",$("[data-group=user-"+f+"]",this.selectors.root).show())}}if(this.boxSizer(),this.queueStatus="done",window.opener&&"/upload"==window.location.pathname&&""==window.location.search.substr(1)&&void 0!==CHV.obj.opener.uploadPlugin[window.name]){if($('[data-action="copy"]',this.selectors.root).remove(),CHV.obj.opener.uploadPlugin[window.name].hasOwnProperty("autoInsert")&&CHV.obj.opener.uploadPlugin[window.name].autoInsert){var p=$(':input[name="'+CHV.obj.opener.uploadPlugin[window.name].autoInsert+'"]',CHV.fn.uploader.selectors.root).val();if(p)return window.opener.postMessage({id:window.name,message:p},"*"),void window.close()}}else $('[data-action="openerPostMessage"]',this.selectors.root).remove()}},$.extend(CHV.fn.uploader,$.extend(!0,{},CHV.obj.uploaderReset)),CHV.fn.fillEmbedCodes=function(e,r,l){void 0===l&&(l="val");var t=getCookie("USER_SELECTED_EMBED");"undefined"!==t&&0<$('#form-embed-toggle-combo div[data-combo-value="'+t+'"]',r).length&&($("#form-embed-toggle",r).find("option").attr("selected",!1),$('#form-embed-toggle option[value="'+t+'"]',r).attr("selected","selected"),$("#form-embed-toggle-combo div[data-combo-value]",r).addClass("soft-hidden"),$('#form-embed-toggle-combo div[data-combo-value="'+t+'"]',r).removeClass("soft-hidden")),$.each(e,function(e,t){if(void 0!==t){var o="id_encoded"in t?t:t.image;if(!o.medium){o.medium={};for(var i=["filename","name","width","height","extension","size","size_formatted","url"],n=0;n<i.length;n++)o.medium[i[n]]=o[i[n]]}var s=Object.flatten(o);$.each(CHV.obj.embed_tpl,function(e,t){$.each(t.options,function(e,t){var o=t,i=$("textarea[name="+e+"]",r),n=o.template;for(var a in s)s.hasOwnProperty(a)&&(n=n.replace(new RegExp("%"+a.toUpperCase()+"%","g"),s[a]));i[l](i.val()+n+("thumb"==i.data("size")?" ":"\n"))})})}}),$.each(CHV.obj.embed_tpl,function(e,n){$.each(n.options,function(e,t){var o,i=$("textarea[name="+e+"]",r);void 0!==n.backlink?(o=n.backlink,void 0!==CHV.obj.config.location?-1!==window.name.indexOf("imgbb_")&&(o=o.replace(new RegExp(" ","g"),"`")):"thumb"==i.data("size")&&(o=""),i[l]($.trim(i.val())+o)):i[l]($.trim(i.val()))})})},CHV.fn.resource_privacy_toggle=function(e){e=e||"public",$("[data-content=privacy-private]").hide(),"public"!==e&&$("[data-content=privacy-private]").show()},CHV.fn.submit_create_album=function(){var e=$(PF.obj.modal.selectors.root);return""==$("[name=form-album-name]",e).val()?(PF.fn.growl.call(PF.fn._s("You must enter the album name.")),$("[name=form-album-name]",e).highlight(),!1):(PF.obj.modal.form_data={action:"create-album",type:"album",album:{name:$("[name=form-album-name]",e).val(),description:$("[name=form-album-description]",e).val(),privacy:$("[name=form-privacy]",e).val(),password:"password"==$("[name=form-privacy]",e).val()?$("[name=form-album-password]",e).val():null,new:!0}},!0)},CHV.fn.complete_create_album={success:function(e){var t=e.responseJSON.album;window.location=t.url},error:function(e){var t=e.responseJSON;PF.fn.growl.call(PF.fn._s(t.error.message))}},CHV.fn.submit_upload_edit=function(){var e=$(PF.obj.modal.selectors.root),t=!1;return $("[data-content=form-new-album]",e).is(":visible")&&""==$("[name=form-album-name]",e).val()?(PF.fn.growl.call(PF.fn._s("You must enter the album name.")),$("[name=form-album-name]",e).highlight(),!1):($("[data-content=form-new-album]",e).is(":visible")&&(t=!0),PF.obj.modal.form_data={action:t?"create-album":"move",type:"images",album:{ids:$.map(CHV.fn.uploader.results.success,function(e){return e.image.id_encoded}),new:t}},t?(PF.obj.modal.form_data.album.name=$("[name=form-album-name]",e).val(),PF.obj.modal.form_data.album.description=$("[name=form-album-description]",e).val(),PF.obj.modal.form_data.album.privacy=$("[name=form-privacy]",e).val(),"password"==PF.obj.modal.form_data.album.privacy&&(PF.obj.modal.form_data.album.password=$("[name=form-album-password]",e).val())):PF.obj.modal.form_data.album.id=$("[name=form-album-id]",e).val(),!0)},CHV.fn.complete_upload_edit={success:function(e){var t=e.responseJSON.album;window.location=t.url},error:function(e){var t=e.responseJSON;PF.fn.growl.call(PF.fn._s(t.error.message))}},CHV.fn.before_image_edit=function(){var e=$("[data-ajax-deferred='CHV.fn.complete_image_edit']");$("[data-content=form-new-album]",e).hide(),$("#move-existing-album",e).show()},CHV.fn.submit_image_edit=function(){var e=$(PF.obj.modal.selectors.root),t=!1;return $("[data-content=form-new-album]",e).is(":visible")&&""==$("[name=form-album-name]",e).val()?(PF.fn.growl.call(PF.fn._s("You must enter the album name.")),$("[name=form-album-name]",e).highlight(),!1):($("[data-content=form-new-album]",e).is(":visible")&&(t=!0),PF.obj.modal.form_data={action:"edit",edit:"image",editing:{id:CHV.obj.resource.id,category_id:$("[name=form-category-id]",e).val()||null,title:$("[name=form-image-title]",e).val()||null,description:$("[name=form-image-description]",e).val()||null,new_album:t}},t?(PF.obj.modal.form_data.editing.album_privacy=$("[name=form-privacy]",e).val(),"password"==PF.obj.modal.form_data.editing.album_privacy&&(PF.obj.modal.form_data.editing.album_password=$("[name=form-album-password]",e).val()),PF.obj.modal.form_data.editing.album_name=$("[name=form-album-name]",e).val(),PF.obj.modal.form_data.editing.album_description=$("[name=form-album-description]",e).val()):PF.obj.modal.form_data.editing.album_id=$("[name=form-album-id]",e).val(),!0)},CHV.fn.complete_image_edit={success:function(e){var t,i=e.responseJSON.image;i.album.id_encoded||(i.album.id_encoded=""),CHV.obj.image_viewer.album.id_encoded!==i.album.id_encoded&&(CHV.obj.image_viewer.album.id_encoded=i.album.id_encoded,t={html:i.album.slice&&i.album.slice.html?i.album.slice.html:null,prev:i.album.slice&&i.album.slice.prev?i.album.slice.prev:null,next:i.album.slice&&i.album.slice.next?i.album.slice.next:null},$("[data-content=album-slice]").html(t.html),$("[data-content=album-panel-title]")[t.html?"show":"hide"](),$("a[data-action=prev]").attr("href",t.prev),$("a[data-action=next]").attr("href",t.next),$("a[data-action]",".image-viewer-navigation").each(function(){$(this)[void 0===$(this).attr("href")?"addClass":"removeClass"]("hidden")})),CHV.fn.resource_privacy_toggle(i.album.privacy),$.each(["description","title"],function(e,t){var o=$("[data-text=image-"+t+"]");o.html(PF.fn.nl2br(PF.fn.htmlEncode(i[t]))),""!==o.html()&&o.show()}),CHV.fn.common.updateDoctitle(i.title),PF.fn.growl.expirable(PF.fn._s("Image edited successfully.")),CHV.fn.list_editor.addAlbumtoModals(i.album);var n=$("[data-submit-fn='CHV.fn.submit_image_edit']");$.each(["description","name","password"],function(e,t){var o=$("[name=form-album-"+t+"]",n);o.is("textarea")?o.val("").html(""):o.val("").attr("value","")}),$("[name=form-privacy] option",n).each(function(){$(this).removeAttr("selected")}),$("[data-combo-value=password]",n).hide(),$("[name=form-album-id]",n).find("option").removeAttr("selected"),$("[name=form-album-id]",n).find('[value="'+i.album.id_encoded+'"]').attr("selected",!0)}},CHV.fn.before_album_edit=function(e){$("[data-action=album-switch]","[data-before-fn='CHV.fn.before_album_edit']").remove()},CHV.fn.submit_album_edit=function(){var e=$(PF.obj.modal.selectors.root);return $("[name=form-album-name]",e).val()?(PF.obj.modal.form_data={action:"edit",edit:"album",editing:{id:CHV.obj.resource.id,name:$("[name=form-album-name]",e).val(),privacy:$("[name=form-privacy]",e).val(),description:$("[name=form-album-description]",e).val()}},"password"==PF.obj.modal.form_data.editing.privacy&&(PF.obj.modal.form_data.editing.password=$("[name=form-album-password]",e).val()),!0):(PF.fn.growl.call(PF.fn._s("You must enter the album name.")),$("[name=form-album-name]",e).highlight(),!1)},CHV.fn.complete_album_edit={success:function(e){var t=e.responseJSON.album;$("[data-text=album-name]").html(PF.fn.htmlEncode(t.name)),$("[data-text=album-description]").html(PF.fn.htmlEncode(t.description)),CHV.fn.resource_privacy_toggle(t.privacy);var o=CHV.obj.resource.type;CHV.obj.resource.type=null,CHV.fn.list_editor.updateItem($(".list-item"),e.responseJSON),CHV.obj.resource.type=o,$("[data-modal]").each(function(){$('option[value="'+t.id_encoded+'"]',this).text(t.name+("public"!==t.privacy?" ("+PF.fn._s("private")+")":""))}),CHV.fn.common.updateDoctitle(t.name),PF.fn.growl.expirable(PF.fn._s("Album edited successfully."))}},CHV.fn.common={validateForm:function(e){void 0===e&&(e=PF.obj.modal.selectors.root);var o=!0;return $.each($(":input:visible",e),function(e,t){""==$(this).val()&&$(this).attr("required")&&($(this).highlight(),o=!1)}),!!o||(PF.fn.growl.call(PF.fn._s("Please fill all the required fields.")),!1)},updateDoctitle:function(e){void 0!==CHV.obj.page_info&&(CHV.obj.page_info.pre_doctitle=e,CHV.obj.page_info.doctitle=CHV.obj.page_info.pre_doctitle+CHV.obj.page_info.pos_doctitle,document.title=CHV.obj.page_info.doctitle)}},CHV.fn.submit_resource_delete=function(){return PF.obj.modal.form_data={action:"delete",delete:CHV.obj.resource.type,from:"resource",owner:void 0!==CHV.obj.resource.user?CHV.obj.resource.user.id:null,deleting:CHV.obj.resource},!0},CHV.fn.complete_resource_delete={success:function(e){e.responseJSON;$("body").fadeOut("normal",function(){var e="album"==CHV.obj.resource.type||"image"==CHV.obj.resource.type?CHV.obj.resource.parent_url:CHV.obj.resource.user?CHV.obj.resource.user.url:CHV.obj.resource.url;void 0!==e&&(window.location=e+"?deleted")})}},CHV.fn.list_editor={selectionCount:function(){$(PF.obj.listing.selectors.content_listing).each(function(){var e=$("[data-content=pop-selection]","[data-content=list-selection][data-tab="+$(this).attr("id")+"]"),t=$(PF.obj.listing.selectors.list_item+".selected",this).length;all_count=$(PF.obj.listing.selectors.list_item,this).length,e[0<t?"removeClass":"addClass"]("disabled"),$("[data-text=selection-count]",e).text(0<t?t:""),$(this).is(":visible")&&CHV.fn.list_editor.listMassActionSet(all_count==t?"clear":"select")})},removeFromList:function(n,a){var s,r,e,l;void 0!==n&&(n=n instanceof jQuery==0?$(n):n,s=$(PF.obj.listing.selectors.content_listing_visible),r=n.length,n.fadeOut("fast"),e=n.first().data("type"),l=parseInt($("[data-text="+e+"-count]").text())-r,CHV.fn.list_editor.updateUserCounters(n.first().data("type"),r,"-"),n.promise().done(function(){$("body").removeClass(CHV.fn.listingViewer.selectors.bodyShown.substr(1));var t={};if(n.each(function(){$("[data-id="+$(this).data("id")+"]").each(function(){var e=$(this).closest(PF.obj.listing.selectors.content_listing).attr("id");t[e]||(t[e]=0),t[e]+=1})}),1==r?$("[data-id="+$(this).data("id")+"]").remove():n.each(function(){$("[data-id="+$(this).data("id")+"]").remove()}),PF.fn.listing.columnizerQueue(),PF.fn.listing.refresh(),CHV.fn.list_editor.selectionCount(),void 0!==a&&"string"==typeof a&&PF.fn.growl.expirable(a),$(PF.obj.listing.selectors.content_listing_pagination,s).exists()||0!=$(".list-item",s).length||(l=0),0==l)s.html(PF.obj.listing.template.empty),$(PF.obj.listing.selectors.content_listing+":not("+PF.obj.listing.selectors.content_listing_visible+")").data({empty:null,load:"ajax"}),$("[data-content=list-selection][data-tab="+s.attr("id")+"]").addClass("disabled");else if(0==$(PF.obj.listing.selectors.list_item,s).length){if($(PF.obj.listing.selectors.pad_content).height(0),$("[data-action=load-more]",s).exists())return $(PF.obj.listing.selectors.content_listing_visible).data("page",0),$("[data-action=load-more]",s).click(),void(PF.obj.listing.recolumnize=!0);var e=$("[data-pagination=next]",s);if(e.exists()){var o=e.attr("href"),i=PF.fn.deparam(o);return"page"in i&&1<i.page&&(o=o.changeURLParameterValue("page",i.page-1)),void(window.location=o)}}}))},deleteFromList:function(e){var t;void 0===t&&(t=!0);e=e instanceof jQuery==0?$(e):e;this.removeFromList(e,t?PF.fn._s("The content has been deleted."):null)},moveFromList:function(e,t){void 0===t&&(t=!0);e=e instanceof jQuery==0?$(e):e;this.removeFromList(e,t?PF.fn._s("The content has been moved."):null)},toggleSelectItem:function(e,t){"boolean"!=typeof t&&(t=!0);var o,i,n=$(".viewer").is(":visible")?$("[data-type=image][data-id="+e.attr("data-id")+"]"):e,a=$("[data-action=select] .btn-icon",n),s=t?(n.addClass("selected"),o=a.data("icon-selected"),i=a.data("icon-unselected"),PF.fn._s("Unselect")):(n.removeClass("selected"),o=a.data("icon-unselected"),i=a.data("icon-selected"),PF.fn._s("Select"));a.removeClass(i).addClass(o),$("[data-action=select] .label",n).text(s),CHV.fn.list_editor.selectionCount()},selectItem:function(e){this.toggleSelectItem(e,!0)},unselectItem:function(e){this.toggleSelectItem(e,!1)},clearSelection:function(e){var t=$(PF.obj.listing.selectors.list_item+".selected",PF.obj.listing.selectors[e?"content_listing":"content_listing_visible"]);this.unselectItem(t),this.listMassActionSet("select")},listMassActionSet:function(e){var t=$("[data-action=list-"+("select"==e?"clear":"select")+"-all]:visible"),o=t.data("text-"+e+"-all");t.text(o).attr("data-action","list-"+e+"-all")},updateItem:function(e,t,o,i){e instanceof jQuery==0&&(e=$(e));var n=e.data("type"),a="image"==n?t.album:t;if(this.addAlbumtoModals(a),$('option[value="'+a.id_encoded+'"]',"[name=form-album-id]").html(PF.fn.htmlEncode(a.name_with_privacy_readable_html)),void 0===o&&(o="edit"),"edit"==o||"move"==o){if("move"==o&&"album"==CHV.obj.resource.type)return void CHV.fn.list_editor.moveFromList(e,i);e.attr("data-description",t.description),"image"==n?(void 0!==t.title&&(e.attr("data-title",t.title),e.find("[title]").attr("title",t.title),$("[data-text=image-title]",e).html(PF.fn.htmlEncode(t.title))),void 0!==t.title_truncated&&$("[data-text=image-title-truncated]",e).html(PF.fn.htmlEncode(t.title_truncated)),void 0!==t.category_id&&e.attr("data-category-id",t.category_id),e.attr({"data-album-id":a.id_encoded}),$("[data-content=album-link]",e).attr("href",a.url)):e.attr({"data-privacy":a.privacy,"data-password":a.password,"data-name":a.name}),e.attr("data-privacy",a.privacy),$("[data-text=album-name]",e).html(PF.fn.htmlEncode(a.name)),PF.fn.growl.expirable("edit"==o?PF.fn._s("The content has been edited."):PF.fn._s("The content has been moved."))}},addAlbumtoModals:function(e){var t=!1;$("[name=form-album-id]","[data-modal]").each(function(){e.id_encoded&&!$('option[value="'+e.id_encoded+'"]',this).exists()&&($(this).append('<option value="'+e.id_encoded+'">'+e.name_with_privacy_readable_html+"</option>"),t=!0)}),t&&CHV.fn.list_editor.updateUserCounters("album",1,"+")},updateAlbum:function(e){$("[data-id="+e.id_encoded+"]").each(function(){""!==e.html&&($(this).after(e.html),$(this).remove())})},updateUserCounters:function(e,t,o){void 0===o&&(o="+");var i,n,a=$("[data-text="+e+"-count]"),s=$("[data-text="+e+"-label]"),t=parseInt(t),r=parseInt(a.html());switch(o){case"+":i=r+t;break;case"-":i=r-t;break;case"=":i=t}n=i-r;var l=$("[data-text=total-"+a.data("text")+"]"),d=$("[data-text="+l.data("text")+"-label]"),c=parseInt(l.html())+n;a.text(i),l.text(c),s.text(s.data(1==i?"label-single":"label-plural")),d.text(s.data(1==c?"label-single":"label-plural"))},updateMoveItemLists:function(o,e,t){if(CHV.fn.list_editor.clearSelection(),/image/.test(e))"image"==e?CHV.fn.list_editor.updateItem("[data-type=image][data-id="+t.data("id")+"]",o.image,"move"):(t.each(function(){CHV.fn.list_editor.updateItem("[data-type=image][data-id="+$(this).data("id")+"]",o,"move",!1)}),PF.fn.growl.expirable(PF.fn._s("The content has been moved.")));else{if("album"==CHV.obj.resource.type?CHV.fn.list_editor.moveFromList(t):PF.fn.growl.expirable(PF.fn._s("The content has been moved.")),void 0!==o.albums_old)for(var i=0;i<o.albums_old.length;i++)CHV.fn.list_editor.updateAlbum(o.albums_old[i]);else CHV.fn.list_editor.updateAlbum(o.old_album);var n;o.album&&((void 0!==o.albums_old?"true"==o.request.album.new:"true"==o.request.editing.new_album)?(CHV.fn.list_editor.addAlbumtoModals(o.album),n=parseInt($("[data-text=album-count]").text())-1,$(PF.obj.listing.selectors.pad_content).each(function(){var e,t=$(this).find(PF.obj.listing.selectors.list_item).length;0!=t&&("date_desc"!=(e=PF.fn.deparam($(this).closest(PF.obj.listing.selectors.content_listing).data("params"))).sort&&n!=t||$(this)["date_desc"==e.sort?"prepend":"append"](o.album.html))})):CHV.fn.list_editor.updateAlbum(o.album)),PF.fn.listing.columnizerQueue(),PF.fn.listing.refresh(0)}}};